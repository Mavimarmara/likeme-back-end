
> likeme-back-end@1.0.0 test
> jest

FAIL src/services/user/__tests__/userService.test.ts
  ‚óè Test suite failed to run

    [96msrc/services/user/__tests__/userService.test.ts[0m:[93m47[0m:[93m7[0m - [91merror[0m[90m TS2353: [0mObject literal may only specify known properties, and 'displayName' does not exist in type 'SocialPlusUser'.

    [7m47[0m       displayName: 'Test User',
    [7m  [0m [91m      ~~~~~~~~~~~[0m
    [96msrc/services/user/__tests__/userService.test.ts[0m:[93m116[0m:[93m7[0m - [91merror[0m[90m TS2353: [0mObject literal may only specify known properties, and 'displayName' does not exist in type 'SocialPlusUser'.

    [7m116[0m       displayName: 'Test User',
    [7m   [0m [91m      ~~~~~~~~~~~[0m
    [96msrc/services/user/__tests__/userService.test.ts[0m:[93m194[0m:[93m7[0m - [91merror[0m[90m TS2353: [0mObject literal may only specify known properties, and 'displayName' does not exist in type 'SocialPlusUser'.

    [7m194[0m       displayName: 'Test User',
    [7m   [0m [91m      ~~~~~~~~~~~[0m
    [96msrc/services/user/__tests__/userService.test.ts[0m:[93m407[0m:[93m9[0m - [91merror[0m[90m TS2353: [0mObject literal may only specify known properties, and 'displayName' does not exist in type 'SocialPlusUser'.

    [7m407[0m         displayName: 'New User',
    [7m   [0m [91m        ~~~~~~~~~~~[0m
    [96msrc/services/user/__tests__/userService.test.ts[0m:[93m444[0m:[93m9[0m - [91merror[0m[90m TS2353: [0mObject literal may only specify known properties, and 'displayName' does not exist in type 'SocialPlusUser'.

    [7m444[0m         displayName: 'Retry User',
    [7m   [0m [91m        ~~~~~~~~~~~[0m
    [96msrc/services/user/__tests__/userService.test.ts[0m:[93m501[0m:[93m9[0m - [91merror[0m[90m TS2353: [0mObject literal may only specify known properties, and 'displayName' does not exist in type 'SocialPlusUser'.

    [7m501[0m         displayName: 'Jos√© Mar√≠a √ëo√±o',
    [7m   [0m [91m        ~~~~~~~~~~~[0m

FAIL src/middleware/__tests__/auth.test.ts
  ‚óè Authentication Middleware ‚Ä∫ authenticateToken ‚Ä∫ üîí Edge Cases - Seguran√ßa ‚Ä∫ should handle database connection errors gracefully

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: 500
    Received: 401

    Number of calls: 1

      337 |         await authenticateToken(req as AuthenticatedRequest, res as Response, next);
      338 |
    > 339 |         expect(statusMock).toHaveBeenCalledWith(500);
          |                            ^
      340 |         expect(jsonMock).toHaveBeenCalledWith({
      341 |           success: false,
      342 |           message: 'Erro interno do servidor',

      at Object.<anonymous> (src/middleware/__tests__/auth.test.ts:339:28)

FAIL src/controllers/order/orderController.integration.test.ts
  ‚óè Test suite failed to run

    [96msrc/controllers/order/orderController.integration.test.ts[0m:[93m5[0m:[93m77[0m - [91merror[0m[90m TS2307: [0mCannot find module '@/tests/fixtures/testFixtures' or its corresponding type declarations.

    [7m5[0m import { createValidProduct, createValidCardData, createValidAddress } from '@/tests/fixtures/testFixtures';
    [7m [0m [91m                                                                            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m

FAIL src/utils/__tests__/auth0.test.ts
  ‚óè Test suite failed to run

    [96msrc/utils/__tests__/auth0.test.ts[0m:[93m207[0m:[93m10[0m - [91merror[0m[90m TS2352: [0mConversion of type 'typeof JwksRsa' to type 'Mock<any, any, any>' may be a mistake because neither type sufficiently overlaps with the other. If this was intentional, convert the expression to 'unknown' first.
      Type 'typeof JwksRsa' is missing the following properties from type 'Mock<any, any, any>': getMockName, mock, mockClear, mockReset, and 13 more.

    [7m207[0m         (jwksClient as jest.Mock).mockReturnValue(mockClient);
    [7m   [0m [91m         ~~~~~~~~~~~~~~~~~~~~~~~[0m
    [96msrc/utils/__tests__/auth0.test.ts[0m:[93m287[0m:[93m10[0m - [91merror[0m[90m TS2352: [0mConversion of type 'typeof JwksRsa' to type 'Mock<any, any, any>' may be a mistake because neither type sufficiently overlaps with the other. If this was intentional, convert the expression to 'unknown' first.
      Type 'typeof JwksRsa' is missing the following properties from type 'Mock<any, any, any>': getMockName, mock, mockClear, mockReset, and 13 more.

    [7m287[0m         (jwksClient as jest.Mock).mockReturnValue(mockClient);
    [7m   [0m [91m         ~~~~~~~~~~~~~~~~~~~~~~~[0m
    [96msrc/utils/__tests__/auth0.test.ts[0m:[93m293[0m:[93m44[0m - [91merror[0m[90m TS7006: [0mParameter 'err' implicitly has an 'any' type.

    [7m293[0m               getKey({} as jwt.JwtHeader, (err, key) => {
    [7m   [0m [91m                                           ~~~[0m
    [96msrc/utils/__tests__/auth0.test.ts[0m:[93m293[0m:[93m49[0m - [91merror[0m[90m TS7006: [0mParameter 'key' implicitly has an 'any' type.

    [7m293[0m               getKey({} as jwt.JwtHeader, (err, key) => {
    [7m   [0m [91m                                                ~~~[0m
    [96msrc/utils/__tests__/auth0.test.ts[0m:[93m311[0m:[93m10[0m - [91merror[0m[90m TS2352: [0mConversion of type 'typeof JwksRsa' to type 'Mock<any, any, any>' may be a mistake because neither type sufficiently overlaps with the other. If this was intentional, convert the expression to 'unknown' first.
      Type 'typeof JwksRsa' is missing the following properties from type 'Mock<any, any, any>': getMockName, mock, mockClear, mockReset, and 13 more.

    [7m311[0m         (jwksClient as jest.Mock).mockReturnValue(mockClient);
    [7m   [0m [91m         ~~~~~~~~~~~~~~~~~~~~~~~[0m
    [96msrc/utils/__tests__/auth0.test.ts[0m:[93m332[0m:[93m10[0m - [91merror[0m[90m TS2352: [0mConversion of type 'typeof JwksRsa' to type 'Mock<any, any, any>' may be a mistake because neither type sufficiently overlaps with the other. If this was intentional, convert the expression to 'unknown' first.
      Type 'typeof JwksRsa' is missing the following properties from type 'Mock<any, any, any>': getMockName, mock, mockClear, mockReset, and 13 more.

    [7m332[0m         (jwksClient as jest.Mock).mockReturnValue(mockClient);
    [7m   [0m [91m         ~~~~~~~~~~~~~~~~~~~~~~~[0m

PASS src/controllers/payment/recipientController.integration.test.ts (6.193 s)
  ‚óè Console

    console.log
      [Config] Social.plus config: {
        hasApiKey: true,
        apiKeyLength: 48,
        hasServerKey: true,
        serverKeyLength: 122,
        region: 'EU',
        baseUrl: 'https://apix.eu.amity.co/api'
      }

      at src/config/index.ts:80:15

    console.log
      [SocialPlus] Client initialized: {
        baseUrl: 'https://apix.eu.amity.co/api',
        region: 'EU',
        hasApiKey: true,
        apiKeyLength: 48,
        hasServerKey: true,
        serverKeyLength: 122,
        tokenTtlMs: 300000
      }

      at new SocialPlusClient (src/clients/socialPlus/socialPlusClient.ts:50:13)

    console.info
      Not all input has been taken into account at your final specification.

      at build (node_modules/swagger-jsdoc/src/specification.js:309:15)

    console.error
      Here's the report: 
      
      
       Error in /Users/weber/Projetos/likeme/likeme-back-end/src/controllers/anamnesis/anamnesisController.ts :
      YAMLSemanticError: Nested mappings are not allowed in compact mappings at line 54, column 22:
      
              description: Prefixo opcional para filtrar perguntas por key (ex: mind_‚Ä¶
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^‚Ä¶
      ,Error in /Users/weber/Projetos/likeme/likeme-back-end/src/controllers/auth/authController.docs.ts :
      YAMLSemanticError: Nested mappings are not allowed in compact mappings at line 4, column 18:
      
          description: Retorna o token JWT do backend para o usu√°rio autenticado. √öti‚Ä¶
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^‚Ä¶
      ,Error in /Users/weber/Projetos/likeme/likeme-back-end/src/controllers/auth/authController.docs.ts :
      YAMLSemanticError: Nested mappings are not allowed in compact mappings at line 4, column 18:
      
          description: Retorna o token JWT do backend para o usu√°rio autenticado. √öti‚Ä¶
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^‚Ä¶
      ,Error in /Users/weber/Projetos/likeme/likeme-back-end/src/controllers/auth/authController.docs.ts :
      YAMLSemanticError: Nested mappings are not allowed in compact mappings at line 4, column 18:
      
          description: Retorna o token JWT do backend para o usu√°rio autenticado. √öti‚Ä¶
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^‚Ä¶
      ,Error in /Users/weber/Projetos/likeme/likeme-back-end/src/controllers/auth/authController.docs.ts :
      YAMLSemanticError: Nested mappings are not allowed in compact mappings at line 4, column 18:
      
          description: Retorna o token JWT do backend para o usu√°rio autenticado. √öti‚Ä¶
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^‚Ä¶

      104 |   }
      105 |
    > 106 |   return swaggerJsdoc(swaggerOptions);
          |                      ^
      107 | };
      108 |
      109 | const swaggerSpec = getSwaggerSpec();

      at build (node_modules/swagger-jsdoc/src/specification.js:313:15)
      at Object.<anonymous>.module.exports (node_modules/swagger-jsdoc/src/lib.js:32:10)
      at getSwaggerSpec (src/server.ts:106:22)
      at Object.<anonymous> (src/server.ts:109:21)
      at Object.<anonymous> (src/controllers/payment/recipientController.integration.test.ts:24:1)

    console.warn
      
      ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
      ‚ö†Ô∏è  TESTES MANUAIS PULADOS
      
      Estes testes fazem chamadas REAIS √† API da Pagarme.
      
      Para executar:
        NODE_ENV=development RUN_MANUAL_TESTS=true npm test -- recipientController.integration.test.ts
      
      ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ

      35 |   beforeAll(() => {
      36 |     if (!shouldRunTests) {
    > 37 |       console.warn(`
         |               ^
      38 | ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
      39 | ‚ö†Ô∏è  TESTES MANUAIS PULADOS
      40 |

      at Object.<anonymous> (src/controllers/payment/recipientController.integration.test.ts:37:15)

FAIL src/services/order/__tests__/orderService.create.test.ts
  ‚óè Test suite failed to run

    [96msrc/services/order/__tests__/orderService.create.test.ts[0m:[93m4[0m:[93m77[0m - [91merror[0m[90m TS2307: [0mCannot find module '@/tests/fixtures/testFixtures' or its corresponding type declarations.

    [7m4[0m import { createValidProduct, createValidCardData, createValidAddress } from '@/tests/fixtures/testFixtures';
    [7m [0m [91m                                                                            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m

FAIL src/services/order/__tests__/orderService.payment.test.ts
  ‚óè Test suite failed to run

    [96msrc/services/order/__tests__/orderService.payment.test.ts[0m:[93m4[0m:[93m77[0m - [91merror[0m[90m TS2307: [0mCannot find module '@/tests/fixtures/testFixtures' or its corresponding type declarations.

    [7m4[0m import { createValidProduct, createValidCardData, createValidAddress } from '@/tests/fixtures/testFixtures';
    [7m [0m [91m                                                                            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m

FAIL src/services/order/__tests__/orderService.validation.test.ts
  ‚óè Test suite failed to run

    [96msrc/services/order/__tests__/orderService.validation.test.ts[0m:[93m4[0m:[93m36[0m - [91merror[0m[90m TS2307: [0mCannot find module '@/tests/fixtures/testFixtures' or its corresponding type declarations.

    [7m4[0m import { createValidProduct } from '@/tests/fixtures/testFixtures';
    [7m [0m [91m                                   ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m

FAIL src/services/order/__tests__/orderService.crud.test.ts
  ‚óè Test suite failed to run

    [96msrc/services/order/__tests__/orderService.crud.test.ts[0m:[93m4[0m:[93m36[0m - [91merror[0m[90m TS2307: [0mCannot find module '@/tests/fixtures/testFixtures' or its corresponding type declarations.

    [7m4[0m import { createValidProduct } from '@/tests/fixtures/testFixtures';
    [7m [0m [91m                                   ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
    [96msrc/services/order/__tests__/orderService.crud.test.ts[0m:[93m104[0m:[93m41[0m - [91merror[0m[90m TS2554: [0mExpected 3-4 arguments, but got 1.

    [7m104[0m       const orders = await orderService.findAll(testUser.id);
    [7m   [0m [91m                                        ~~~~~~~[0m

      [96msrc/services/order/orderService.ts[0m:[93m473[0m:[93m5[0m
        [7m473[0m     limit: number,
        [7m   [0m [96m    ~~~~~~~~~~~~~[0m
        An argument for 'limit' was not provided.
    [96msrc/services/order/__tests__/orderService.crud.test.ts[0m:[93m105[0m:[93m21[0m - [91merror[0m[90m TS2339: [0mProperty 'length' does not exist on type '{ orders: { id: string; createdAt: Date; updatedAt: Date; deletedAt: Date | null; userId: string; status: string; total: Decimal; subtotal: Decimal; shippingCost: Decimal; ... 7 more ...; trackingNumber: string | null; }[]; total: number; }'.

    [7m105[0m       expect(orders.length).toBeGreaterThan(0);
    [7m   [0m [91m                    ~~~~~~[0m
    [96msrc/services/order/__tests__/orderService.crud.test.ts[0m:[93m106[0m:[93m14[0m - [91merror[0m[90m TS7053: [0mElement implicitly has an 'any' type because expression of type '0' can't be used to index type '{ orders: { id: string; createdAt: Date; updatedAt: Date; deletedAt: Date | null; userId: string; status: string; total: Decimal; subtotal: Decimal; shippingCost: Decimal; ... 7 more ...; trackingNumber: string | null; }[]; total: number; }'.
      Property '0' does not exist on type '{ orders: { id: string; createdAt: Date; updatedAt: Date; deletedAt: Date | null; userId: string; status: string; total: Decimal; subtotal: Decimal; shippingCost: Decimal; ... 7 more ...; trackingNumber: string | null; }[]; total: number; }'.

    [7m106[0m       expect(orders[0].userId).toBe(testUser.id);
    [7m   [0m [91m             ~~~~~~~~~[0m
    [96msrc/services/order/__tests__/orderService.crud.test.ts[0m:[93m110[0m:[93m41[0m - [91merror[0m[90m TS2554: [0mExpected 3-4 arguments, but got 2.

    [7m110[0m       const orders = await orderService.findAll(testUser.id, 'pending');
    [7m   [0m [91m                                        ~~~~~~~[0m

      [96msrc/services/order/orderService.ts[0m:[93m474[0m:[93m5[0m
        [7m474[0m     filters: OrderQueryFilters,
        [7m   [0m [96m    ~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
        An argument for 'filters' was not provided.
    [96msrc/services/order/__tests__/orderService.crud.test.ts[0m:[93m111[0m:[93m21[0m - [91merror[0m[90m TS2339: [0mProperty 'length' does not exist on type '{ orders: { id: string; createdAt: Date; updatedAt: Date; deletedAt: Date | null; userId: string; status: string; total: Decimal; subtotal: Decimal; shippingCost: Decimal; ... 7 more ...; trackingNumber: string | null; }[]; total: number; }'.

    [7m111[0m       expect(orders.length).toBeGreaterThan(0);
    [7m   [0m [91m                    ~~~~~~[0m
    [96msrc/services/order/__tests__/orderService.crud.test.ts[0m:[93m112[0m:[93m14[0m - [91merror[0m[90m TS2339: [0mProperty 'forEach' does not exist on type '{ orders: { id: string; createdAt: Date; updatedAt: Date; deletedAt: Date | null; userId: string; status: string; total: Decimal; subtotal: Decimal; shippingCost: Decimal; ... 7 more ...; trackingNumber: string | null; }[]; total: number; }'.

    [7m112[0m       orders.forEach(order => expect(order.status).toBe('pending'));
    [7m   [0m [91m             ~~~~~~~[0m
    [96msrc/services/order/__tests__/orderService.crud.test.ts[0m:[93m112[0m:[93m22[0m - [91merror[0m[90m TS7006: [0mParameter 'order' implicitly has an 'any' type.

    [7m112[0m       orders.forEach(order => expect(order.status).toBe('pending'));
    [7m   [0m [91m                     ~~~~~[0m
    [96msrc/services/order/__tests__/orderService.crud.test.ts[0m:[93m118[0m:[93m76[0m - [91merror[0m[90m TS2345: [0mArgument of type '{ status: string; }' is not assignable to parameter of type 'string'.

    [7m118[0m       const updated = await orderService.update(testOrder.id, testUser.id, {
    [7m   [0m [91m                                                                           ~[0m
    [7m119[0m         status: 'completed',
    [7m   [0m [91m~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
    [7m120[0m       });
    [7m   [0m [91m~~~~~~~[0m
    [96msrc/services/order/__tests__/orderService.crud.test.ts[0m:[93m126[0m:[93m61[0m - [91merror[0m[90m TS2345: [0mArgument of type '{ status: string; }' is not assignable to parameter of type 'string'.

    [7m126[0m         orderService.update('non-existent-id', testUser.id, { status: 'completed' })
    [7m   [0m [91m                                                            ~~~~~~~~~~~~~~~~~~~~~~~[0m

FAIL src/utils/__tests__/auth.test.ts
  ‚óè Auth Utils ‚Ä∫ generateToken ‚Ä∫ should generate different tokens for same user at different times

    expect(received).not.toBe(expected) // Object.is equality

    Expected: not "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOiJ1c2VyLXNhbWUiLCJpYXQiOjE3Njg1MDQyNzksImV4cCI6MTc2ODUwNzg3OX0.HTzrfONfbjC2ObafcbO_pilvQNiaf4uFYQyY8R0VVyc"

      59 |
      60 |       // Tokens devem ser diferentes porque iat (issued at) √© diferente
    > 61 |       expect(token1).not.toBe(token2);
         |                          ^
      62 |     });
      63 |
      64 |     it('should create token that can be decoded', () => {

      at Object.<anonymous> (src/utils/__tests__/auth.test.ts:61:26)

::ffff:127.0.0.1 - - [15/Jan/2026:19:11:26 +0000] "POST /api/products HTTP/1.1" 201 486 "-" "-"
::ffff:127.0.0.1 - - [15/Jan/2026:19:11:27 +0000] "POST /api/products HTTP/1.1" 400 418 "-" "-"
::ffff:127.0.0.1 - - [15/Jan/2026:19:11:27 +0000] "POST /api/products HTTP/1.1" 401 57 "-" "-"
::ffff:127.0.0.1 - - [15/Jan/2026:19:11:28 +0000] "GET /api/amazon/product-by-url?externalUrl=https%3A%2F%2Fwww.amazon.com.br%2Fdp%2FB0BLJTJ38M HTTP/1.1" 200 511 "-" "-"
::ffff:127.0.0.1 - - [15/Jan/2026:19:11:29 +0000] "POST /api/persons HTTP/1.1" 200 691 "-" "-"
::ffff:127.0.0.1 - - [15/Jan/2026:19:11:29 +0000] "POST /api/advertisers HTTP/1.1" 201 - "-" "-"
::ffff:127.0.0.1 - - [15/Jan/2026:19:11:30 +0000] "GET /api/amazon/product-by-url HTTP/1.1" 400 102 "-" "-"
::ffff:127.0.0.1 - - [15/Jan/2026:19:11:30 +0000] "POST /api/persons HTTP/1.1" 400 341 "-" "-"
::ffff:127.0.0.1 - - [15/Jan/2026:19:11:30 +0000] "POST /api/advertisers HTTP/1.1" 400 166 "-" "-"
::ffff:127.0.0.1 - - [15/Jan/2026:19:11:31 +0000] "GET /api/amazon/product-by-url?externalUrl=https%3A%2F%2Fexample.com%2Fproduct HTTP/1.1" 400 48 "-" "-"
::ffff:127.0.0.1 - - [15/Jan/2026:19:11:31 +0000] "GET /api/amazon/product-by-url?externalUrl=https%3A%2F%2Fwww.amazon.com.br%2Fdp%2FB0BLJTJ38M HTTP/1.1" 401 57 "-" "-"
::ffff:127.0.0.1 - - [15/Jan/2026:19:11:32 +0000] "GET /api/amazon/product-by-url?externalUrl=https%3A%2F%2Fwww.amazon.com.br%2Fdp%2FB0BLJTJ38M HTTP/1.1" 500 164 "-" "-"
::ffff:127.0.0.1 - - [15/Jan/2026:19:11:33 +0000] "GET /api/products HTTP/1.1" 200 - "-" "-"
::ffff:127.0.0.1 - - [15/Jan/2026:19:11:33 +0000] "POST /api/payment/process HTTP/1.1" 400 50 "-" "-"
::ffff:127.0.0.1 - - [15/Jan/2026:19:11:33 +0000] "GET /api/amazon/product-by-url?externalUrl=https%3A%2F%2Fwww.amazon.com.br%2Fdp%2FB0BLJTJ38M HTTP/1.1" 500 222 "-" "-"
::ffff:127.0.0.1 - - [15/Jan/2026:19:11:33 +0000] "GET /api/anamnesis/questions?locale=pt-BR HTTP/1.1" 200 - "-" "-"
::ffff:127.0.0.1 - - [15/Jan/2026:19:11:34 +0000] "GET /api/anamnesis/questions HTTP/1.1" 400 58 "-" "-"
::ffff:127.0.0.1 - - [15/Jan/2026:19:11:34 +0000] "GET /api/persons HTTP/1.1" 200 - "-" "-"
::ffff:127.0.0.1 - - [15/Jan/2026:19:11:35 +0000] "GET /api/ads/2e1501c8-6514-4b47-8f5d-e89af08b4739 HTTP/1.1" 200 - "-" "-"
::ffff:127.0.0.1 - - [15/Jan/2026:19:11:36 +0000] "GET /api/anamnesis/questions?locale=pt-BR HTTP/1.1" 200 - "-" "-"
::ffff:127.0.0.1 - - [15/Jan/2026:19:11:37 +0000] "GET /api/amazon/product-by-ad/43cb1aec-ede1-4557-baf7-7588a1d8269c HTTP/1.1" 200 713 "-" "-"
::ffff:127.0.0.1 - - [15/Jan/2026:19:11:37 +0000] "GET /api/products?category=Electronics HTTP/1.1" 200 543 "-" "-"
::ffff:127.0.0.1 - - [15/Jan/2026:19:11:37 +0000] "GET /api/persons/ea692634-327e-4f8d-b5c7-f4ec8d1d16f0-system-test HTTP/1.1" 200 687 "-" "-"
::ffff:127.0.0.1 - - [15/Jan/2026:19:11:38 +0000] "POST /api/payment/process HTTP/1.1" 400 48 "-" "-"
::ffff:127.0.0.1 - - [15/Jan/2026:19:11:38 +0000] "GET /api/anamnesis/questions?locale=pt-BR HTTP/1.1" 200 - "-" "-"
::ffff:127.0.0.1 - - [15/Jan/2026:19:11:39 +0000] "GET /api/amazon/product-by-ad/non-existent-id HTTP/1.1" 404 42 "-" "-"
::ffff:127.0.0.1 - - [15/Jan/2026:19:11:39 +0000] "GET /api/persons/non-existent-id HTTP/1.1" 404 52 "-" "-"
::ffff:127.0.0.1 - - [15/Jan/2026:19:11:41 +0000] "GET /api/anamnesis/questions?locale=en-US HTTP/1.1" 200 - "-" "-"
::ffff:127.0.0.1 - - [15/Jan/2026:19:11:41 +0000] "POST /api/payment/process HTTP/1.1" 404 45 "-" "-"
::ffff:127.0.0.1 - - [15/Jan/2026:19:11:41 +0000] "GET /api/products/b3b2b7ce-e560-4e95-b7b8-65ff4643c66a-system-test HTTP/1.1" 200 478 "-" "-"
::ffff:127.0.0.1 - - [15/Jan/2026:19:11:41 +0000] "GET /api/advertisers HTTP/1.1" 200 - "-" "-"
::ffff:127.0.0.1 - - [15/Jan/2026:19:11:43 +0000] "GET /api/ads/5b057525-7fdc-4456-9584-375f2761f750 HTTP/1.1" 200 - "-" "-"
::ffff:127.0.0.1 - - [15/Jan/2026:19:11:43 +0000] "GET /api/anamnesis/questions/test-question-1768504282624-system-test?locale=pt-BR HTTP/1.1" 200 644 "-" "-"
::ffff:127.0.0.1 - - [15/Jan/2026:19:11:43 +0000] "PUT /api/persons/ea692634-327e-4f8d-b5c7-f4ec8d1d16f0-system-test HTTP/1.1" 200 705 "-" "-"
::ffff:127.0.0.1 - - [15/Jan/2026:19:11:43 +0000] "GET /api/products/non-existent-id HTTP/1.1" 404 47 "-" "-"
::ffff:127.0.0.1 - - [15/Jan/2026:19:11:44 +0000] "GET /api/anamnesis/questions/non-existent-key?locale=pt-BR HTTP/1.1" 404 48 "-" "-"
::ffff:127.0.0.1 - - [15/Jan/2026:19:11:44 +0000] "GET /api/anamnesis/questions/test-question-1768504282624-system-test HTTP/1.1" 400 58 "-" "-"
::ffff:127.0.0.1 - - [15/Jan/2026:19:11:45 +0000] "GET /api/amazon/product-by-ad/f879f6bc-656e-469e-9688-f0ff5e4729a4 HTTP/1.1" 400 70 "-" "-"
::ffff:127.0.0.1 - - [15/Jan/2026:19:11:46 +0000] "GET /api/advertisers?status=active HTTP/1.1" 200 - "-" "-"
::ffff:127.0.0.1 - - [15/Jan/2026:19:11:47 +0000] "DELETE /api/persons/9af19622-8ecd-4f8b-a873-7d782c89a582 HTTP/1.1" 200 68 "-" "-"
::ffff:127.0.0.1 - - [15/Jan/2026:19:11:47 +0000] "GET /api/anamnesis/complete?locale=pt-BR HTTP/1.1" 200 - "-" "-"
::ffff:127.0.0.1 - - [15/Jan/2026:19:11:47 +0000] "GET /api/anamnesis/complete HTTP/1.1" 400 58 "-" "-"
::ffff:127.0.0.1 - - [15/Jan/2026:19:11:50 +0000] "GET /api/anamnesis/complete?locale=pt-BR HTTP/1.1" 200 - "-" "-"
::ffff:127.0.0.1 - - [15/Jan/2026:19:11:51 +0000] "GET /api/ads/8a45b575-9ca7-4fa4-88ac-ac8bff114027 HTTP/1.1" 200 - "-" "-"
::ffff:127.0.0.1 - - [15/Jan/2026:19:11:51 +0000] "GET /api/advertisers/16e89a0f-ffe7-4782-b61e-e420c43df646 HTTP/1.1" 200 - "-" "-"
::ffff:127.0.0.1 - - [15/Jan/2026:19:11:51 +0000] "POST /api/payment/process HTTP/1.1" 403 78 "-" "-"
::ffff:127.0.0.1 - - [15/Jan/2026:19:11:51 +0000] "PUT /api/products/210601f6-a409-467e-bcf0-67c2e2ba8686-system-test HTTP/1.1" 200 440 "-" "-"
::ffff:127.0.0.1 - - [15/Jan/2026:19:11:53 +0000] "GET /api/amazon/product-by-ad/e814113e-a2fc-483b-8f54-23859cfd3f45 HTTP/1.1" 400 79 "-" "-"
::ffff:127.0.0.1 - - [15/Jan/2026:19:11:53 +0000] "POST /api/anamnesis/answers HTTP/1.1" 200 412 "-" "-"
::ffff:127.0.0.1 - - [15/Jan/2026:19:11:54 +0000] "PUT /api/products/non-existent-id HTTP/1.1" 404 47 "-" "-"
PASS src/controllers/amazon/amazonController.integration.test.ts (43.033 s)
  ‚óè Console

    console.log
      [Config] Social.plus config: {
        hasApiKey: true,
        apiKeyLength: 48,
        hasServerKey: true,
        serverKeyLength: 122,
        region: 'EU',
        baseUrl: 'https://apix.eu.amity.co/api'
      }

      at src/config/index.ts:80:15

    console.log
      [SocialPlus] Client initialized: {
        baseUrl: 'https://apix.eu.amity.co/api',
        region: 'EU',
        hasApiKey: true,
        apiKeyLength: 48,
        hasServerKey: true,
        serverKeyLength: 122,
        tokenTtlMs: 300000
      }

      at new SocialPlusClient (src/clients/socialPlus/socialPlusClient.ts:50:13)

    console.info
      Not all input has been taken into account at your final specification.

      at build (node_modules/swagger-jsdoc/src/specification.js:309:15)

    console.error
      Here's the report: 
      
      
       Error in /Users/weber/Projetos/likeme/likeme-back-end/src/controllers/anamnesis/anamnesisController.ts :
      YAMLSemanticError: Nested mappings are not allowed in compact mappings at line 54, column 22:
      
              description: Prefixo opcional para filtrar perguntas por key (ex: mind_‚Ä¶
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^‚Ä¶
      ,Error in /Users/weber/Projetos/likeme/likeme-back-end/src/controllers/auth/authController.docs.ts :
      YAMLSemanticError: Nested mappings are not allowed in compact mappings at line 4, column 18:
      
          description: Retorna o token JWT do backend para o usu√°rio autenticado. √öti‚Ä¶
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^‚Ä¶
      ,Error in /Users/weber/Projetos/likeme/likeme-back-end/src/controllers/auth/authController.docs.ts :
      YAMLSemanticError: Nested mappings are not allowed in compact mappings at line 4, column 18:
      
          description: Retorna o token JWT do backend para o usu√°rio autenticado. √öti‚Ä¶
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^‚Ä¶
      ,Error in /Users/weber/Projetos/likeme/likeme-back-end/src/controllers/auth/authController.docs.ts :
      YAMLSemanticError: Nested mappings are not allowed in compact mappings at line 4, column 18:
      
          description: Retorna o token JWT do backend para o usu√°rio autenticado. √öti‚Ä¶
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^‚Ä¶
      ,Error in /Users/weber/Projetos/likeme/likeme-back-end/src/controllers/auth/authController.docs.ts :
      YAMLSemanticError: Nested mappings are not allowed in compact mappings at line 4, column 18:
      
          description: Retorna o token JWT do backend para o usu√°rio autenticado. √öti‚Ä¶
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^‚Ä¶

      104 |   }
      105 |
    > 106 |   return swaggerJsdoc(swaggerOptions);
          |                      ^
      107 | };
      108 |
      109 | const swaggerSpec = getSwaggerSpec();

      at build (node_modules/swagger-jsdoc/src/specification.js:313:15)
      at Object.<anonymous>.module.exports (node_modules/swagger-jsdoc/src/lib.js:32:10)
      at getSwaggerSpec (src/server.ts:106:22)
      at Object.<anonymous> (src/server.ts:109:21)
      at Object.<anonymous> (src/controllers/amazon/amazonController.integration.test.ts:2:1)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: 91db3da3-8ea0-46d9-bcf6-bfc5f7529805 na tabela person

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/controllers/amazon/amazonController.integration.test.ts:49:21)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: 3bd54ebb-b6a5-4d99-ab5c-a8dccd962e84 na tabela user

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/controllers/amazon/amazonController.integration.test.ts:59:21)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: 3bad7d66-b5fb-452c-8ea5-26cd945614e7 na tabela person

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/controllers/amazon/amazonController.integration.test.ts:71:21)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: 4a662b9f-561e-4224-b25c-5332c9ea0e19 na tabela user

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/controllers/amazon/amazonController.integration.test.ts:82:21)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: efc35183-d890-4f2c-bcba-58254196ba1c na tabela advertiser

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/controllers/amazon/amazonController.integration.test.ts:91:21)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: 8a2f3325-30d2-4148-aa4f-a9666c478b7d na tabela product

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/controllers/amazon/amazonController.integration.test.ts:105:21)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: 43cb1aec-ede1-4557-baf7-7588a1d8269c na tabela ad

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/controllers/amazon/amazonController.integration.test.ts:115:21)

    console.error
      Error extracting Amazon product data: Error: Network error
          at Object.<anonymous> (/Users/weber/Projetos/likeme/likeme-back-end/src/controllers/amazon/amazonController.integration.test.ts:186:57)
          at Promise.then.completed (/Users/weber/Projetos/likeme/likeme-back-end/node_modules/jest-circus/build/utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (/Users/weber/Projetos/likeme/likeme-back-end/node_modules/jest-circus/build/utils.js:231:10)
          at _callCircusTest (/Users/weber/Projetos/likeme/likeme-back-end/node_modules/jest-circus/build/run.js:316:40)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)
          at _runTest (/Users/weber/Projetos/likeme/likeme-back-end/node_modules/jest-circus/build/run.js:252:3)
          at _runTestsForDescribeBlock (/Users/weber/Projetos/likeme/likeme-back-end/node_modules/jest-circus/build/run.js:126:9)
          at _runTestsForDescribeBlock (/Users/weber/Projetos/likeme/likeme-back-end/node_modules/jest-circus/build/run.js:121:9)
          at _runTestsForDescribeBlock (/Users/weber/Projetos/likeme/likeme-back-end/node_modules/jest-circus/build/run.js:121:9)
          at run (/Users/weber/Projetos/likeme/likeme-back-end/node_modules/jest-circus/build/run.js:71:3)
          at runAndTransformResultsToJestFormat (/Users/weber/Projetos/likeme/likeme-back-end/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
          at jestAdapter (/Users/weber/Projetos/likeme/likeme-back-end/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
          at runTestInternal (/Users/weber/Projetos/likeme/likeme-back-end/node_modules/jest-runner/build/runTest.js:367:16)
          at runTest (/Users/weber/Projetos/likeme/likeme-back-end/node_modules/jest-runner/build/runTest.js:444:34)
          at Object.worker (/Users/weber/Projetos/likeme/likeme-back-end/node_modules/jest-runner/build/testWorker.js:106:12)

      168 |     };
      169 |   } catch (error: any) {
    > 170 |     console.error('Error extracting Amazon product data:', error);
          |             ^
      171 |     throw new Error(`Failed to extract product data: ${error.message}`);
      172 |   }
      173 | };

      at extractAmazonProductData (src/utils/amazonScraper.ts:170:13)
      at getProductByUrl (src/controllers/amazon/amazonController.ts:26:25)

    console.error
      Get Amazon product by URL error: Error: Failed to extract product data: Network error
          at extractAmazonProductData (/Users/weber/Projetos/likeme/likeme-back-end/src/utils/amazonScraper.ts:171:11)
          at getProductByUrl (/Users/weber/Projetos/likeme/likeme-back-end/src/controllers/amazon/amazonController.ts:26:25)

      33 |     sendSuccess(res, productData, 'Amazon product data extracted successfully');
      34 |   } catch (error: any) {
    > 35 |     console.error('Get Amazon product by URL error:', error);
         |             ^
      36 |     sendError(res, `Error retrieving Amazon product: ${error.message}`, 500, error.message);
      37 |   }
      38 | };

      at getProductByUrl (src/controllers/amazon/amazonController.ts:35:13)

    console.error
      Error extracting Amazon product data: Error: Failed to fetch Amazon page: 404 Not Found
          at extractAmazonProductData (/Users/weber/Projetos/likeme/likeme-back-end/src/utils/amazonScraper.ts:20:13)
          at getProductByUrl (/Users/weber/Projetos/likeme/likeme-back-end/src/controllers/amazon/amazonController.ts:26:25)

      168 |     };
      169 |   } catch (error: any) {
    > 170 |     console.error('Error extracting Amazon product data:', error);
          |             ^
      171 |     throw new Error(`Failed to extract product data: ${error.message}`);
      172 |   }
      173 | };

      at extractAmazonProductData (src/utils/amazonScraper.ts:170:13)
      at getProductByUrl (src/controllers/amazon/amazonController.ts:26:25)

    console.error
      Get Amazon product by URL error: Error: Failed to extract product data: Failed to fetch Amazon page: 404 Not Found
          at extractAmazonProductData (/Users/weber/Projetos/likeme/likeme-back-end/src/utils/amazonScraper.ts:171:11)
          at getProductByUrl (/Users/weber/Projetos/likeme/likeme-back-end/src/controllers/amazon/amazonController.ts:26:25)

      33 |     sendSuccess(res, productData, 'Amazon product data extracted successfully');
      34 |   } catch (error: any) {
    > 35 |     console.error('Get Amazon product by URL error:', error);
         |             ^
      36 |     sendError(res, `Error retrieving Amazon product: ${error.message}`, 500, error.message);
      37 |   }
      38 | };

      at getProductByUrl (src/controllers/amazon/amazonController.ts:35:13)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: e5aa1f9d-cad1-4b0b-8c0e-1e0214e784d4 na tabela product

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/controllers/amazon/amazonController.integration.test.ts:327:23)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: f879f6bc-656e-469e-9688-f0ff5e4729a4 na tabela ad

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/controllers/amazon/amazonController.integration.test.ts:337:23)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: 12d4d0f2-de02-4480-a6a4-93f60fba7ab3 na tabela product

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/controllers/amazon/amazonController.integration.test.ts:363:23)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: e814113e-a2fc-483b-8f54-23859cfd3f45 na tabela ad

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/controllers/amazon/amazonController.integration.test.ts:372:23)

    console.log
      üßπ Limpando 0 IDs de teste...

      at safeTestCleanup (src/utils/test-helpers.ts:139:15)

    console.log
      ‚úÖ Limpeza de dados de teste conclu√≠da

      at safeTestCleanup (src/utils/test-helpers.ts:333:15)

::ffff:127.0.0.1 - - [15/Jan/2026:19:11:54 +0000] "GET /api/amazon/product-by-ad/43cb1aec-ede1-4557-baf7-7588a1d8269c HTTP/1.1" 401 57 "-" "-"
::ffff:127.0.0.1 - - [15/Jan/2026:19:11:54 +0000] "GET /api/advertisers/non-existent-id HTTP/1.1" 404 50 "-" "-"
FAIL src/services/product/productService.test.ts
  ‚óè Test suite failed to run

    [96msrc/services/product/productService.test.ts[0m:[93m5[0m:[93m59[0m - [91merror[0m[90m TS2307: [0mCannot find module '@/tests/fixtures/testFixtures' or its corresponding type declarations.

    [7m5[0m import { createValidProduct, createExternalProduct } from '@/tests/fixtures/testFixtures';
    [7m [0m [91m                                                          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m

::ffff:127.0.0.1 - - [15/Jan/2026:19:11:55 +0000] "POST /api/payment/process HTTP/1.1" 400 50 "-" "-"
::ffff:127.0.0.1 - - [15/Jan/2026:19:11:56 +0000] "POST /api/person-contacts HTTP/1.1" 201 579 "-" "-"
::ffff:127.0.0.1 - - [15/Jan/2026:19:11:57 +0000] "POST /api/person-contacts HTTP/1.1" 400 442 "-" "-"
::ffff:127.0.0.1 - - [15/Jan/2026:19:11:57 +0000] "POST /api/payment/process HTTP/1.1" 400 357 "-" "-"
::ffff:127.0.0.1 - - [15/Jan/2026:19:11:57 +0000] "POST /api/payment/process HTTP/1.1" 401 57 "-" "-"
::ffff:127.0.0.1 - - [15/Jan/2026:19:11:58 +0000] "POST /api/person-contacts HTTP/1.1" 400 267 "-" "-"
::ffff:127.0.0.1 - - [15/Jan/2026:19:11:58 +0000] "POST /api/anamnesis/answers HTTP/1.1" 200 390 "-" "-"
::ffff:127.0.0.1 - - [15/Jan/2026:19:11:58 +0000] "GET /api/advertisers/user/8d7988aa-2acc-480e-ae1a-6131c9249644-system-test HTTP/1.1" 200 - "-" "-"
::ffff:127.0.0.1 - - [15/Jan/2026:19:11:59 +0000] "PATCH /api/products/18238b31-24e2-45e3-acd6-53c91604e4f7-system-test/stock HTTP/1.1" 200 449 "-" "-"
::ffff:127.0.0.1 - - [15/Jan/2026:19:11:59 +0000] "GET /api/ads/b2aa74e1-bad1-4f91-8e20-7e65f8776890 HTTP/1.1" 404 42 "-" "-"
::ffff:127.0.0.1 - - [15/Jan/2026:19:11:59 +0000] "POST /api/person-contacts HTTP/1.1" 400 267 "-" "-"
::ffff:127.0.0.1 - - [15/Jan/2026:19:12:00 +0000] "GET /api/payment/status/trans_123456 HTTP/1.1" 200 176 "-" "-"
::ffff:127.0.0.1 - - [15/Jan/2026:19:12:00 +0000] "POST /api/person-contacts HTTP/1.1" 400 267 "-" "-"
::ffff:127.0.0.1 - - [15/Jan/2026:19:12:01 +0000] "GET /api/ads/non-existent-id HTTP/1.1" 404 42 "-" "-"
::ffff:127.0.0.1 - - [15/Jan/2026:19:12:01 +0000] "POST /api/person-contacts HTTP/1.1" 400 267 "-" "-"
::ffff:127.0.0.1 - - [15/Jan/2026:19:12:02 +0000] "GET /api/payment/status/non-existent-id HTTP/1.1" 404 74 "-" "-"
::ffff:127.0.0.1 - - [15/Jan/2026:19:12:02 +0000] "GET /api/payment/status/trans_123456 HTTP/1.1" 401 57 "-" "-"
::ffff:127.0.0.1 - - [15/Jan/2026:19:12:02 +0000] "POST /api/person-contacts HTTP/1.1" 400 267 "-" "-"
::ffff:127.0.0.1 - - [15/Jan/2026:19:12:03 +0000] "POST /api/payment/capture/trans_123456 HTTP/1.1" 200 103 "-" "-"
::ffff:127.0.0.1 - - [15/Jan/2026:19:12:03 +0000] "POST /api/activities HTTP/1.1" 201 569 "-" "-"
::ffff:127.0.0.1 - - [15/Jan/2026:19:12:03 +0000] "GET /api/ads/452ebf2f-9a78-421b-b281-3d760dd9b0d2 HTTP/1.1" 401 57 "-" "-"
::ffff:127.0.0.1 - - [15/Jan/2026:19:12:04 +0000] "GET /api/advertisers/user/8bb5d44f-8d2a-40ba-8036-570689e96b7a HTTP/1.1" 404 50 "-" "-"
::ffff:127.0.0.1 - - [15/Jan/2026:19:12:04 +0000] "PATCH /api/products/1de5ec79-dbbf-4989-8310-5d4eb815b472-system-test/stock HTTP/1.1" 200 457 "-" "-"
::ffff:127.0.0.1 - - [15/Jan/2026:19:12:04 +0000] "POST /api/payment/capture/trans_123456 HTTP/1.1" 200 103 "-" "-"
::ffff:127.0.0.1 - - [15/Jan/2026:19:12:05 +0000] "POST /api/payment/capture/trans_123456 HTTP/1.1" 400 85 "-" "-"
::ffff:127.0.0.1 - - [15/Jan/2026:19:12:05 +0000] "POST /api/payment/capture/trans_123456 HTTP/1.1" 401 57 "-" "-"
::ffff:127.0.0.1 - - [15/Jan/2026:19:12:05 +0000] "POST /api/person-contacts HTTP/1.1" 201 579 "-" "-"
::ffff:127.0.0.1 - - [15/Jan/2026:19:12:07 +0000] "POST /api/payment/refund/trans_123456 HTTP/1.1" 200 122 "-" "-"
::ffff:127.0.0.1 - - [15/Jan/2026:19:12:08 +0000] "GET /api/activities?page=1&limit=100 HTTP/1.1" 200 - "-" "-"
::ffff:127.0.0.1 - - [15/Jan/2026:19:12:08 +0000] "POST /api/person-contacts HTTP/1.1" 201 564 "-" "-"
::ffff:127.0.0.1 - - [15/Jan/2026:19:12:09 +0000] "PATCH /api/products/43d5c943-8e42-4293-b318-705118969052-system-test/stock HTTP/1.1" 200 453 "-" "-"
::ffff:127.0.0.1 - - [15/Jan/2026:19:12:09 +0000] "POST /api/payment/refund/trans_123456 HTTP/1.1" 200 122 "-" "-"
::ffff:127.0.0.1 - - [15/Jan/2026:19:12:09 +0000] "PUT /api/advertisers/16e89a0f-ffe7-4782-b61e-e420c43df646 HTTP/1.1" 200 - "-" "-"
::ffff:127.0.0.1 - - [15/Jan/2026:19:12:11 +0000] "PATCH /api/products/98a421d8-7796-431e-a5e2-71e842616953-system-test/stock HTTP/1.1" 400 186 "-" "-"
::ffff:127.0.0.1 - - [15/Jan/2026:19:12:11 +0000] "POST /api/person-contacts HTTP/1.1" 201 567 "-" "-"
::ffff:127.0.0.1 - - [15/Jan/2026:19:12:11 +0000] "POST /api/payment/refund/trans_123456 HTTP/1.1" 400 84 "-" "-"
::ffff:127.0.0.1 - - [15/Jan/2026:19:12:11 +0000] "PUT /api/advertisers/non-existent-id HTTP/1.1" 404 50 "-" "-"
::ffff:127.0.0.1 - - [15/Jan/2026:19:12:11 +0000] "POST /api/anamnesis/answers HTTP/1.1" 200 424 "-" "-"
::ffff:127.0.0.1 - - [15/Jan/2026:19:12:11 +0000] "POST /api/payment/refund/trans_123456 HTTP/1.1" 401 57 "-" "-"
::ffff:127.0.0.1 - - [15/Jan/2026:19:12:11 +0000] "POST /api/anamnesis/answers HTTP/1.1" 400 71 "-" "-"
::ffff:127.0.0.1 - - [15/Jan/2026:19:12:14 +0000] "POST /api/person-contacts HTTP/1.1" 201 564 "-" "-"
::ffff:127.0.0.1 - - [15/Jan/2026:19:12:15 +0000] "POST /api/anamnesis/answers HTTP/1.1" 400 76 "-" "-"
::ffff:127.0.0.1 - - [15/Jan/2026:19:12:16 +0000] "GET /api/ads?activeOnly=true HTTP/1.1" 200 - "-" "-"
::ffff:127.0.0.1 - - [15/Jan/2026:19:12:16 +0000] "GET /api/activities?page=1&limit=100 HTTP/1.1" 200 - "-" "-"
::ffff:127.0.0.1 - - [15/Jan/2026:19:12:16 +0000] "DELETE /api/products/67f05bc8-8468-45c4-9ae4-a418997552b5-system-test HTTP/1.1" 200 69 "-" "-"
::ffff:127.0.0.1 - - [15/Jan/2026:19:12:17 +0000] "DELETE /api/advertisers/26cdb2cc-e88d-41ca-aa77-9705095acdff HTTP/1.1" 200 72 "-" "-"
::ffff:127.0.0.1 - - [15/Jan/2026:19:12:18 +0000] "GET /api/person-contacts HTTP/1.1" 200 - "-" "-"
::ffff:127.0.0.1 - - [15/Jan/2026:19:12:18 +0000] "POST /api/activities HTTP/1.1" 201 539 "-" "-"
::ffff:127.0.0.1 - - [15/Jan/2026:19:12:20 +0000] "DELETE /api/products/non-existent-id HTTP/1.1" 404 47 "-" "-"
::ffff:127.0.0.1 - - [15/Jan/2026:19:12:20 +0000] "POST /api/payment/process HTTP/1.1" 400 50 "-" "-"
::ffff:127.0.0.1 - - [15/Jan/2026:19:12:21 +0000] "GET /api/person-contacts/24bc75aa-e5bb-4271-aae8-39b86fc17138 HTTP/1.1" 200 564 "-" "-"
::ffff:127.0.0.1 - - [15/Jan/2026:19:12:22 +0000] "DELETE /api/advertisers/non-existent-id HTTP/1.1" 404 50 "-" "-"
::ffff:127.0.0.1 - - [15/Jan/2026:19:12:24 +0000] "GET /api/activities?page=1&limit=100 HTTP/1.1" 200 - "-" "-"
PASS src/controllers/product/productController.integration.test.ts (68.18 s)
  ‚óè Console

    console.log
      [Config] Social.plus config: {
        hasApiKey: true,
        apiKeyLength: 48,
        hasServerKey: true,
        serverKeyLength: 122,
        region: 'EU',
        baseUrl: 'https://apix.eu.amity.co/api'
      }

      at src/config/index.ts:80:15

    console.log
      [SocialPlus] Client initialized: {
        baseUrl: 'https://apix.eu.amity.co/api',
        region: 'EU',
        hasApiKey: true,
        apiKeyLength: 48,
        hasServerKey: true,
        serverKeyLength: 122,
        tokenTtlMs: 300000
      }

      at new SocialPlusClient (src/clients/socialPlus/socialPlusClient.ts:50:13)

    console.info
      Not all input has been taken into account at your final specification.

      at build (node_modules/swagger-jsdoc/src/specification.js:309:15)

    console.error
      Here's the report: 
      
      
       Error in /Users/weber/Projetos/likeme/likeme-back-end/src/controllers/anamnesis/anamnesisController.ts :
      YAMLSemanticError: Nested mappings are not allowed in compact mappings at line 54, column 22:
      
              description: Prefixo opcional para filtrar perguntas por key (ex: mind_‚Ä¶
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^‚Ä¶
      ,Error in /Users/weber/Projetos/likeme/likeme-back-end/src/controllers/auth/authController.docs.ts :
      YAMLSemanticError: Nested mappings are not allowed in compact mappings at line 4, column 18:
      
          description: Retorna o token JWT do backend para o usu√°rio autenticado. √öti‚Ä¶
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^‚Ä¶
      ,Error in /Users/weber/Projetos/likeme/likeme-back-end/src/controllers/auth/authController.docs.ts :
      YAMLSemanticError: Nested mappings are not allowed in compact mappings at line 4, column 18:
      
          description: Retorna o token JWT do backend para o usu√°rio autenticado. √öti‚Ä¶
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^‚Ä¶
      ,Error in /Users/weber/Projetos/likeme/likeme-back-end/src/controllers/auth/authController.docs.ts :
      YAMLSemanticError: Nested mappings are not allowed in compact mappings at line 4, column 18:
      
          description: Retorna o token JWT do backend para o usu√°rio autenticado. √öti‚Ä¶
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^‚Ä¶
      ,Error in /Users/weber/Projetos/likeme/likeme-back-end/src/controllers/auth/authController.docs.ts :
      YAMLSemanticError: Nested mappings are not allowed in compact mappings at line 4, column 18:
      
          description: Retorna o token JWT do backend para o usu√°rio autenticado. √öti‚Ä¶
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^‚Ä¶

      104 |   }
      105 |
    > 106 |   return swaggerJsdoc(swaggerOptions);
          |                      ^
      107 | };
      108 |
      109 | const swaggerSpec = getSwaggerSpec();

      at build (node_modules/swagger-jsdoc/src/specification.js:313:15)
      at Object.<anonymous>.module.exports (node_modules/swagger-jsdoc/src/lib.js:32:10)
      at getSwaggerSpec (src/server.ts:106:22)
      at Object.<anonymous> (src/server.ts:109:21)
      at Object.<anonymous> (src/controllers/product/productController.integration.test.ts:2:1)

    console.warn
      [ProductService] Usu√°rio n√£o √© um advertiser, recipient n√£o ser√° criado

      148 |           await recipientService.ensureAdvertiserHasRecipient(advertiser.id);
      149 |         } else {
    > 150 |           console.warn('[ProductService] Usu√°rio n√£o √© um advertiser, recipient n√£o ser√° criado');
          |                   ^
      151 |         }
      152 |       } catch (error: any) {
      153 |         console.warn('[ProductService] Erro ao garantir recipient para advertiser:', error.message);

      at ProductService.create (src/services/product/productService.ts:150:19)
      at createProduct (src/controllers/product/productController.ts:10:21)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: eba8d766-00e0-423c-9e2b-8a28a64128a5 na tabela product

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/controllers/product/productController.integration.test.ts:49:25)

    console.error
      Validation error: [
        {
          message: '"name" is required',
          path: [ 'name' ],
          type: 'any.required',
          context: { label: 'name', key: 'name' }
        },
        {
          message: '"value" must contain at least one of [price, externalUrl]',
          path: [],
          type: 'object.missing',
          context: {
            peers: [Array],
            peersWithLabels: [Array],
            label: 'value',
            value: [Object]
          }
        }
      ]

      10 |     
      11 |     if (error) {
    > 12 |       console.error('Validation error:', error.details);
         |               ^
      13 |       console.error('Request body:', JSON.stringify(req.body, null, 2));
      14 |       
      15 |       const errorMessages = error.details.map(detail => detail.message);

      at src/middleware/validation.ts:12:15
      at Layer.handle [as handle_request] (node_modules/express/lib/router/layer.js:95:5)
      at next (node_modules/express/lib/router/route.js:149:13)
      at node_modules/express-rate-limit/dist/index.cjs:807:7
      at node_modules/express-rate-limit/dist/index.cjs:691:5

    console.error
      Request body: {
        "description": "Missing name and price"
      }

      11 |     if (error) {
      12 |       console.error('Validation error:', error.details);
    > 13 |       console.error('Request body:', JSON.stringify(req.body, null, 2));
         |               ^
      14 |       
      15 |       const errorMessages = error.details.map(detail => detail.message);
      16 |       const errorMessage = errorMessages.length === 1

      at src/middleware/validation.ts:13:15
      at Layer.handle [as handle_request] (node_modules/express/lib/router/layer.js:95:5)
      at next (node_modules/express/lib/router/route.js:149:13)
      at node_modules/express-rate-limit/dist/index.cjs:807:7
      at node_modules/express-rate-limit/dist/index.cjs:691:5

    console.warn
      Invalid title retrieved for product a3a2727a-efae-4aa1-adda-c6f3bcf2a018 from https://www.amazon.com.br/dp/B0BLJTJ38M

      308 |       // Verificar se o t√≠tulo √© v√°lido (n√£o √© o fallback "Produto Amazon")
      309 |       if (amazonData.title === 'Produto Amazon' || !amazonData.title || amazonData.title.trim() === '') {
    > 310 |         console.warn(`Invalid title retrieved for product ${product.id} from ${product.externalUrl}`);
          |                 ^
      311 |         return null;
      312 |       }
      313 |

      at ProductService.enrichProductWithExternalData (src/services/product/productService.ts:310:17)
      at src/services/product/productService.ts:107:18
          at async Promise.allSettled (index 0)
      at ProductService.findAll (src/services/product/productService.ts:104:37)
      at getAllProducts (src/controllers/product/productController.ts:63:33)

    console.warn
      Invalid title retrieved for product 8a2f3325-30d2-4148-aa4f-a9666c478b7d from https://www.amazon.com.br/dp/B0BLJTJ38M

      308 |       // Verificar se o t√≠tulo √© v√°lido (n√£o √© o fallback "Produto Amazon")
      309 |       if (amazonData.title === 'Produto Amazon' || !amazonData.title || amazonData.title.trim() === '') {
    > 310 |         console.warn(`Invalid title retrieved for product ${product.id} from ${product.externalUrl}`);
          |                 ^
      311 |         return null;
      312 |       }
      313 |

      at ProductService.enrichProductWithExternalData (src/services/product/productService.ts:310:17)
      at src/services/product/productService.ts:107:18
          at async Promise.allSettled (index 4)
      at ProductService.findAll (src/services/product/productService.ts:104:37)
      at getAllProducts (src/controllers/product/productController.ts:63:33)

    console.error
      Update product error: Error: Product not found
          at ProductService.update (/Users/weber/Projetos/likeme/likeme-back-end/src/services/product/productService.ts:181:13)
          at updateProduct (/Users/weber/Projetos/likeme/likeme-back-end/src/controllers/product/productController.ts:89:21)

      90 |     sendSuccess(res, product, 'Product updated successfully');
      91 |   } catch (error: any) {
    > 92 |     console.error('Update product error:', error);
         |             ^
      93 |     
      94 |     if (error.message === 'Product not found' || PrismaErrorHandler.isNotFoundError(error)) {
      95 |       sendError(res, 'Product not found', 404);

      at updateProduct (src/controllers/product/productController.ts:92:13)

    console.error
      Validation error: [
        {
          message: '"operation" is required',
          path: [ 'operation' ],
          type: 'any.required',
          context: { label: 'operation', key: 'operation' }
        }
      ]

      10 |     
      11 |     if (error) {
    > 12 |       console.error('Validation error:', error.details);
         |               ^
      13 |       console.error('Request body:', JSON.stringify(req.body, null, 2));
      14 |       
      15 |       const errorMessages = error.details.map(detail => detail.message);

      at src/middleware/validation.ts:12:15
      at Layer.handle [as handle_request] (node_modules/express/lib/router/layer.js:95:5)
      at next (node_modules/express/lib/router/route.js:149:13)
      at node_modules/express-rate-limit/dist/index.cjs:807:7
      at node_modules/express-rate-limit/dist/index.cjs:691:5

    console.error
      Request body: {
        "quantity": 5
      }

      11 |     if (error) {
      12 |       console.error('Validation error:', error.details);
    > 13 |       console.error('Request body:', JSON.stringify(req.body, null, 2));
         |               ^
      14 |       
      15 |       const errorMessages = error.details.map(detail => detail.message);
      16 |       const errorMessage = errorMessages.length === 1

      at src/middleware/validation.ts:13:15
      at Layer.handle [as handle_request] (node_modules/express/lib/router/layer.js:95:5)
      at next (node_modules/express/lib/router/route.js:149:13)
      at node_modules/express-rate-limit/dist/index.cjs:807:7
      at node_modules/express-rate-limit/dist/index.cjs:691:5

    console.error
      Delete product error: Error: Product not found
          at ProductService.delete (/Users/weber/Projetos/likeme/likeme-back-end/src/services/product/productService.ts:226:13)
          at deleteProduct (/Users/weber/Projetos/likeme/likeme-back-end/src/controllers/product/productController.ts:111:5)

      112 |     sendSuccess(res, null, 'Product deleted successfully');
      113 |   } catch (error: any) {
    > 114 |     console.error('Delete product error:', error);
          |             ^
      115 |     
      116 |     if (error.message === 'Product not found' || PrismaErrorHandler.isNotFoundError(error)) {
      117 |       sendError(res, 'Product not found', 404);

      at deleteProduct (src/controllers/product/productController.ts:114:13)

    console.log
      üßπ Limpando 12 IDs de teste...

      at safeTestCleanup (src/utils/test-helpers.ts:139:15)

    console.log
      ‚úÖ Limpeza de dados de teste conclu√≠da

      at safeTestCleanup (src/utils/test-helpers.ts:333:15)

PASS src/controllers/advertiser/advertiserController.integration.test.ts (68.91 s)
  ‚óè Console

    console.log
      [Config] Social.plus config: {
        hasApiKey: true,
        apiKeyLength: 48,
        hasServerKey: true,
        serverKeyLength: 122,
        region: 'EU',
        baseUrl: 'https://apix.eu.amity.co/api'
      }

      at src/config/index.ts:80:15

    console.log
      [SocialPlus] Client initialized: {
        baseUrl: 'https://apix.eu.amity.co/api',
        region: 'EU',
        hasApiKey: true,
        apiKeyLength: 48,
        hasServerKey: true,
        serverKeyLength: 122,
        tokenTtlMs: 300000
      }

      at new SocialPlusClient (src/clients/socialPlus/socialPlusClient.ts:50:13)

    console.info
      Not all input has been taken into account at your final specification.

      at build (node_modules/swagger-jsdoc/src/specification.js:309:15)

    console.error
      Here's the report: 
      
      
       Error in /Users/weber/Projetos/likeme/likeme-back-end/src/controllers/anamnesis/anamnesisController.ts :
      YAMLSemanticError: Nested mappings are not allowed in compact mappings at line 54, column 22:
      
              description: Prefixo opcional para filtrar perguntas por key (ex: mind_‚Ä¶
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^‚Ä¶
      ,Error in /Users/weber/Projetos/likeme/likeme-back-end/src/controllers/auth/authController.docs.ts :
      YAMLSemanticError: Nested mappings are not allowed in compact mappings at line 4, column 18:
      
          description: Retorna o token JWT do backend para o usu√°rio autenticado. √öti‚Ä¶
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^‚Ä¶
      ,Error in /Users/weber/Projetos/likeme/likeme-back-end/src/controllers/auth/authController.docs.ts :
      YAMLSemanticError: Nested mappings are not allowed in compact mappings at line 4, column 18:
      
          description: Retorna o token JWT do backend para o usu√°rio autenticado. √öti‚Ä¶
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^‚Ä¶
      ,Error in /Users/weber/Projetos/likeme/likeme-back-end/src/controllers/auth/authController.docs.ts :
      YAMLSemanticError: Nested mappings are not allowed in compact mappings at line 4, column 18:
      
          description: Retorna o token JWT do backend para o usu√°rio autenticado. √öti‚Ä¶
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^‚Ä¶
      ,Error in /Users/weber/Projetos/likeme/likeme-back-end/src/controllers/auth/authController.docs.ts :
      YAMLSemanticError: Nested mappings are not allowed in compact mappings at line 4, column 18:
      
          description: Retorna o token JWT do backend para o usu√°rio autenticado. √öti‚Ä¶
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^‚Ä¶

      104 |   }
      105 |
    > 106 |   return swaggerJsdoc(swaggerOptions);
          |                      ^
      107 | };
      108 |
      109 | const swaggerSpec = getSwaggerSpec();

      at build (node_modules/swagger-jsdoc/src/specification.js:313:15)
      at Object.<anonymous>.module.exports (node_modules/swagger-jsdoc/src/lib.js:32:10)
      at getSwaggerSpec (src/server.ts:106:22)
      at Object.<anonymous> (src/server.ts:109:21)
      at Object.<anonymous> (src/controllers/advertiser/advertiserController.integration.test.ts:2:1)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: 16e89a0f-ffe7-4782-b61e-e420c43df646 na tabela advertiser

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/controllers/advertiser/advertiserController.integration.test.ts:74:25)

    console.error
      Validation error: [
        {
          message: '"name" is required',
          path: [ 'name' ],
          type: 'any.required',
          context: { label: 'name', key: 'name' }
        }
      ]

      10 |     
      11 |     if (error) {
    > 12 |       console.error('Validation error:', error.details);
         |               ^
      13 |       console.error('Request body:', JSON.stringify(req.body, null, 2));
      14 |       
      15 |       const errorMessages = error.details.map(detail => detail.message);

      at src/middleware/validation.ts:12:15
      at Layer.handle [as handle_request] (node_modules/express/lib/router/layer.js:95:5)
      at next (node_modules/express/lib/router/route.js:149:13)
      at node_modules/express-rate-limit/dist/index.cjs:807:7
      at node_modules/express-rate-limit/dist/index.cjs:691:5

    console.error
      Request body: {
        "description": "Missing name"
      }

      11 |     if (error) {
      12 |       console.error('Validation error:', error.details);
    > 13 |       console.error('Request body:', JSON.stringify(req.body, null, 2));
         |               ^
      14 |       
      15 |       const errorMessages = error.details.map(detail => detail.message);
      16 |       const errorMessage = errorMessages.length === 1

      at src/middleware/validation.ts:13:15
      at Layer.handle [as handle_request] (node_modules/express/lib/router/layer.js:95:5)
      at next (node_modules/express/lib/router/route.js:149:13)
      at node_modules/express-rate-limit/dist/index.cjs:807:7
      at node_modules/express-rate-limit/dist/index.cjs:691:5

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: 5fe3bb59-76c7-4d37-8ff9-bb2f168449f7 na tabela person

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/controllers/advertiser/advertiserController.integration.test.ts:99:23)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: c7b831d6-63a9-41e1-96fc-ad9182839242 na tabela user

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/controllers/advertiser/advertiserController.integration.test.ts:110:23)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: b3564738-fc6c-47bc-a933-ed7f7890c505 na tabela person

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/controllers/advertiser/advertiserController.integration.test.ts:115:23)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: de40c393-cce5-48a3-877b-87fd1bafc901 na tabela user

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/controllers/advertiser/advertiserController.integration.test.ts:126:23)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: 229348f5-2df1-4c9f-8295-cb8736a2301f na tabela advertiser

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at src/controllers/advertiser/advertiserController.integration.test.ts:148:48
          at Array.forEach (<anonymous>)
      at Object.<anonymous> (src/controllers/advertiser/advertiserController.integration.test.ts:148:19)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: c8b12145-8f1b-452e-941b-d263e7037536 na tabela advertiser

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at src/controllers/advertiser/advertiserController.integration.test.ts:148:48
          at Array.forEach (<anonymous>)
      at Object.<anonymous> (src/controllers/advertiser/advertiserController.integration.test.ts:148:19)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: 1457d67c-04f8-4bce-bde6-a0347794d405 na tabela person

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/controllers/advertiser/advertiserController.integration.test.ts:244:23)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: 8bb5d44f-8d2a-40ba-8036-570689e96b7a na tabela user

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/controllers/advertiser/advertiserController.integration.test.ts:255:23)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: e6773b5b-fdce-4a7a-baf4-5ad96150627d na tabela person

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/controllers/advertiser/advertiserController.integration.test.ts:314:23)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: 34d1c328-7bd4-4b0b-bbe7-aaadd07bf463 na tabela user

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/controllers/advertiser/advertiserController.integration.test.ts:325:23)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: 26cdb2cc-e88d-41ca-aa77-9705095acdff na tabela advertiser

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/controllers/advertiser/advertiserController.integration.test.ts:334:23)

    console.log
      üßπ Limpando 2 IDs de teste...

      at safeTestCleanup (src/utils/test-helpers.ts:139:15)

    console.log
      ‚úÖ Limpeza de dados de teste conclu√≠da

      at safeTestCleanup (src/utils/test-helpers.ts:333:15)

::ffff:127.0.0.1 - - [15/Jan/2026:19:12:25 +0000] "GET /api/anamnesis/answers/user/b6feed95-8762-4552-8d7e-a8ed94ce7263-system-test HTTP/1.1" 200 - "-" "-"
::ffff:127.0.0.1 - - [15/Jan/2026:19:12:25 +0000] "GET /api/ads?category=amazon%20product HTTP/1.1" 200 - "-" "-"
::ffff:127.0.0.1 - - [15/Jan/2026:19:12:27 +0000] "PUT /api/person-contacts/e5621c58-da34-4d6f-ae1e-b549aa9e7274 HTTP/1.1" 200 568 "-" "-"
PASS src/controllers/activity/activityController.integration.test.ts (33.495 s)
  ‚óè Console

    console.log
      [Config] Social.plus config: {
        hasApiKey: true,
        apiKeyLength: 48,
        hasServerKey: true,
        serverKeyLength: 122,
        region: 'EU',
        baseUrl: 'https://apix.eu.amity.co/api'
      }

      at src/config/index.ts:80:15

    console.log
      [SocialPlus] Client initialized: {
        baseUrl: 'https://apix.eu.amity.co/api',
        region: 'EU',
        hasApiKey: true,
        apiKeyLength: 48,
        hasServerKey: true,
        serverKeyLength: 122,
        tokenTtlMs: 300000
      }

      at new SocialPlusClient (src/clients/socialPlus/socialPlusClient.ts:50:13)

    console.info
      Not all input has been taken into account at your final specification.

      at build (node_modules/swagger-jsdoc/src/specification.js:309:15)

    console.error
      Here's the report: 
      
      
       Error in /Users/weber/Projetos/likeme/likeme-back-end/src/controllers/anamnesis/anamnesisController.ts :
      YAMLSemanticError: Nested mappings are not allowed in compact mappings at line 54, column 22:
      
              description: Prefixo opcional para filtrar perguntas por key (ex: mind_‚Ä¶
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^‚Ä¶
      ,Error in /Users/weber/Projetos/likeme/likeme-back-end/src/controllers/auth/authController.docs.ts :
      YAMLSemanticError: Nested mappings are not allowed in compact mappings at line 4, column 18:
      
          description: Retorna o token JWT do backend para o usu√°rio autenticado. √öti‚Ä¶
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^‚Ä¶
      ,Error in /Users/weber/Projetos/likeme/likeme-back-end/src/controllers/auth/authController.docs.ts :
      YAMLSemanticError: Nested mappings are not allowed in compact mappings at line 4, column 18:
      
          description: Retorna o token JWT do backend para o usu√°rio autenticado. √öti‚Ä¶
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^‚Ä¶
      ,Error in /Users/weber/Projetos/likeme/likeme-back-end/src/controllers/auth/authController.docs.ts :
      YAMLSemanticError: Nested mappings are not allowed in compact mappings at line 4, column 18:
      
          description: Retorna o token JWT do backend para o usu√°rio autenticado. √öti‚Ä¶
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^‚Ä¶
      ,Error in /Users/weber/Projetos/likeme/likeme-back-end/src/controllers/auth/authController.docs.ts :
      YAMLSemanticError: Nested mappings are not allowed in compact mappings at line 4, column 18:
      
          description: Retorna o token JWT do backend para o usu√°rio autenticado. √öti‚Ä¶
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^‚Ä¶

      104 |   }
      105 |
    > 106 |   return swaggerJsdoc(swaggerOptions);
          |                      ^
      107 | };
      108 |
      109 | const swaggerSpec = getSwaggerSpec();

      at build (node_modules/swagger-jsdoc/src/specification.js:313:15)
      at Object.<anonymous>.module.exports (node_modules/swagger-jsdoc/src/lib.js:32:10)
      at getSwaggerSpec (src/server.ts:106:22)
      at Object.<anonymous> (src/server.ts:109:21)
      at Object.<anonymous> (src/controllers/activity/activityController.integration.test.ts:14:1)

    console.log
      üßπ Limpando 8 IDs de teste...

      at safeTestCleanup (src/utils/test-helpers.ts:139:15)

    console.log
      ‚úÖ Limpeza de dados de teste conclu√≠da

      at safeTestCleanup (src/utils/test-helpers.ts:333:15)

::ffff:127.0.0.1 - - [15/Jan/2026:19:12:29 +0000] "GET /api/anamnesis/answers/user/b6feed95-8762-4552-8d7e-a8ed94ce7263-system-test?locale=pt-BR HTTP/1.1" 200 - "-" "-"
PASS src/services/activity/activityService.test.ts (78.664 s)
  ‚óè Console

    console.log
      [Config] Social.plus config: {
        hasApiKey: true,
        apiKeyLength: 48,
        hasServerKey: true,
        serverKeyLength: 122,
        region: 'EU',
        baseUrl: 'https://apix.eu.amity.co/api'
      }

      at src/config/index.ts:80:15

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: 879d5167-bcc5-48fe-9fe4-41e71c31966a na tabela person

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/services/activity/activityService.test.ts:22:21)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: 675f6afe-afe7-407c-b9eb-9c3f294813a2 na tabela user

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/services/activity/activityService.test.ts:32:21)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ba30b244-6018-49ec-880c-67cb0ab308fb na tabela person

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/services/activity/activityService.test.ts:22:21)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: cd55a9d2-3db2-44ab-be7a-dc6952df4904 na tabela user

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/services/activity/activityService.test.ts:32:21)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: 37a8b6b6-3684-4529-bf59-19a4571f43ba na tabela person

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/services/activity/activityService.test.ts:22:21)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: f972e08d-d5dd-4d25-85b0-a6bb199da045 na tabela user

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/services/activity/activityService.test.ts:32:21)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: 4a3b5ec8-8a78-48ee-a1f4-b9e511494f4e na tabela person

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/services/activity/activityService.test.ts:22:21)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: 83244083-09a1-4409-ba12-527fee44acbd na tabela user

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/services/activity/activityService.test.ts:32:21)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: 6b32be36-8b4f-474e-836b-00f8e9f59f00 na tabela person

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/services/activity/activityService.test.ts:22:21)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: 982203bd-c721-4568-bfbe-b1e918f9fb85 na tabela user

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/services/activity/activityService.test.ts:32:21)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ca5cccec-558b-4169-8712-fb5004445eff na tabela person

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/services/activity/activityService.test.ts:22:21)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: d2fd224d-eaaf-4ad5-87ae-68e1a49b8168 na tabela user

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/services/activity/activityService.test.ts:32:21)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: 355312d8-3b49-415e-924f-7eee040c8c70 na tabela person

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/services/activity/activityService.test.ts:22:21)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: fdb8fcbc-2383-40d3-b475-c1865e2d1aeb na tabela user

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/services/activity/activityService.test.ts:32:21)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: 44910cfa-3919-483e-accc-7a68a7e70986 na tabela person

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/services/activity/activityService.test.ts:22:21)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: 3ce0c805-51f6-4902-9c06-94a16af0ea59 na tabela user

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/services/activity/activityService.test.ts:32:21)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: c8a33713-2566-4c43-87b2-64fb0798e6d4 na tabela person

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/services/activity/activityService.test.ts:22:21)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: 90faf174-14e3-4654-a0eb-ebc41e08e6a8 na tabela user

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/services/activity/activityService.test.ts:32:21)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: 77739f8c-454d-4410-b49c-01b0530e719c na tabela person

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/services/activity/activityService.test.ts:22:21)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: 327ea8b9-967d-4751-a303-4468830c1967 na tabela user

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/services/activity/activityService.test.ts:32:21)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: 4d626c7b-1dd0-495f-944d-e8addec45484 na tabela person

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/services/activity/activityService.test.ts:22:21)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: 8105ec40-a7f0-4058-b3f2-a12e0ec740ea na tabela user

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/services/activity/activityService.test.ts:32:21)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: 61d1fffd-f6fe-4bfe-a134-7bd8a9972a86 na tabela person

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/services/activity/activityService.test.ts:22:21)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: 66045f2e-53de-4385-8705-357472e74e9d na tabela user

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/services/activity/activityService.test.ts:32:21)

    console.log
      üßπ Limpando 14 IDs de teste...

      at safeTestCleanup (src/utils/test-helpers.ts:139:15)

    console.log
      ‚úÖ Limpeza de dados de teste conclu√≠da

      at safeTestCleanup (src/utils/test-helpers.ts:333:15)

::ffff:127.0.0.1 - - [15/Jan/2026:19:12:30 +0000] "GET /api/tips HTTP/1.1" 200 - "-" "-"
::ffff:127.0.0.1 - - [15/Jan/2026:19:12:31 +0000] "GET /api/tips HTTP/1.1" 200 - "-" "-"
::ffff:127.0.0.1 - - [15/Jan/2026:19:12:31 +0000] "DELETE /api/person-contacts/a49b5cea-1f4d-4224-a34a-2f8bc70908f9 HTTP/1.1" 200 69 "-" "-"
::ffff:127.0.0.1 - - [15/Jan/2026:19:12:31 +0000] "POST /api/payment/process HTTP/1.1" 400 50 "-" "-"
PASS src/services/payment/paymentSplitService.test.ts
  ‚óè Console

    console.log
      [Config] Social.plus config: {
        hasApiKey: true,
        apiKeyLength: 48,
        hasServerKey: true,
        serverKeyLength: 122,
        region: 'EU',
        baseUrl: 'https://apix.eu.amity.co/api'
      }

      at src/config/index.ts:80:15

    console.log
      [PaymentSplitService] Verificando split. Habilitado: false

      at PaymentSplitService.calculateSplit (src/services/payment/paymentSplitService.ts:10:13)

    console.log
      [PaymentSplitService] Split desabilitado via PAGARME_SPLIT_ENABLED

      at PaymentSplitService.calculateSplit (src/services/payment/paymentSplitService.ts:13:15)

    console.log
      [PaymentSplitService] Verificando split. Habilitado: true

      at PaymentSplitService.calculateSplit (src/services/payment/paymentSplitService.ts:10:13)

    console.log
      [PaymentSplitService] Split desabilitado ou n√£o configurado. Recipient ID n√£o encontrado.

      at PaymentSplitService.calculateSplit (src/services/payment/paymentSplitService.ts:20:15)

    console.log
      [PaymentSplitService] Verificando split. Habilitado: true

      at PaymentSplitService.calculateSplit (src/services/payment/paymentSplitService.ts:10:13)

    console.warn
      [PaymentSplitService] Percentual de split inv√°lido: 0

      77 |     
      78 |     if (percentage <= 0 || percentage > 100) {
    > 79 |       console.warn('[PaymentSplitService] Percentual de split inv√°lido:', percentage);
         |               ^
      80 |       return null;
      81 |     }
      82 |

      at PaymentSplitService.getSplitConfig (src/services/payment/paymentSplitService.ts:79:15)
      at PaymentSplitService.calculateSplit (src/services/payment/paymentSplitService.ts:17:36)
      at Object.<anonymous> (src/services/payment/paymentSplitService.test.ts:55:48)

    console.log
      [PaymentSplitService] Split desabilitado ou n√£o configurado. Recipient ID n√£o encontrado.

      at PaymentSplitService.calculateSplit (src/services/payment/paymentSplitService.ts:20:15)

    console.log
      [PaymentSplitService] Verificando split. Habilitado: true

      at PaymentSplitService.calculateSplit (src/services/payment/paymentSplitService.ts:10:13)

    console.log
      [PaymentSplitService] Configura√ß√£o de split encontrada: { recipientId: 'rp_abc123...', percentage: 50 }

      at PaymentSplitService.calculateSplit (src/services/payment/paymentSplitService.ts:24:13)

    console.log
      [PaymentSplitService] Split calculado: {
        splitsCount: 1,
        totalPercentage: 50,
        recipientIds: [ 'rp_abc123...' ]
      }

      at PaymentSplitService.calculateSplit (src/services/payment/paymentSplitService.ts:36:13)

    console.log
      [PaymentSplitService] Verificando split. Habilitado: true

      at PaymentSplitService.calculateSplit (src/services/payment/paymentSplitService.ts:10:13)

    console.log
      [PaymentSplitService] Configura√ß√£o de split encontrada: { recipientId: 'rp_123...', percentage: 50 }

      at PaymentSplitService.calculateSplit (src/services/payment/paymentSplitService.ts:24:13)

    console.log
      [PaymentSplitService] Split calculado: { splitsCount: 1, totalPercentage: 50, recipientIds: [ 'rp_123...' ] }

      at PaymentSplitService.calculateSplit (src/services/payment/paymentSplitService.ts:36:13)

    console.log
      [PaymentSplitService] Verificando split. Habilitado: true

      at PaymentSplitService.calculateSplit (src/services/payment/paymentSplitService.ts:10:13)

    console.log
      [PaymentSplitService] Configura√ß√£o de split encontrada: { recipientId: 'rp_123...', percentage: 30 }

      at PaymentSplitService.calculateSplit (src/services/payment/paymentSplitService.ts:24:13)

    console.log
      [PaymentSplitService] Split calculado: { splitsCount: 1, totalPercentage: 30, recipientIds: [ 'rp_123...' ] }

      at PaymentSplitService.calculateSplit (src/services/payment/paymentSplitService.ts:36:13)

    console.log
      [PaymentSplitService] Verificando split. Habilitado: true

      at PaymentSplitService.calculateSplit (src/services/payment/paymentSplitService.ts:10:13)

    console.log
      [PaymentSplitService] Configura√ß√£o de split encontrada: { recipientId: 'rp_123...', percentage: 30 }

      at PaymentSplitService.calculateSplit (src/services/payment/paymentSplitService.ts:24:13)

    console.log
      [PaymentSplitService] Split calculado: { splitsCount: 1, totalPercentage: 30, recipientIds: [ 'rp_123...' ] }

      at PaymentSplitService.calculateSplit (src/services/payment/paymentSplitService.ts:36:13)

    console.log
      [PaymentSplitService] Verificando split. Habilitado: true

      at PaymentSplitService.calculateSplit (src/services/payment/paymentSplitService.ts:10:13)

    console.log
      [PaymentSplitService] Configura√ß√£o de split encontrada: { recipientId: 'rp_123...', percentage: 50 }

      at PaymentSplitService.calculateSplit (src/services/payment/paymentSplitService.ts:24:13)

    console.log
      [PaymentSplitService] Split calculado: { splitsCount: 1, totalPercentage: 50, recipientIds: [ 'rp_123...' ] }

      at PaymentSplitService.calculateSplit (src/services/payment/paymentSplitService.ts:36:13)

    console.log
      [PaymentSplitService] Verificando split. Habilitado: true

      at PaymentSplitService.calculateSplit (src/services/payment/paymentSplitService.ts:10:13)

    console.log
      [PaymentSplitService] Configura√ß√£o de split encontrada: { recipientId: 'rp_123...', percentage: 50 }

      at PaymentSplitService.calculateSplit (src/services/payment/paymentSplitService.ts:24:13)

    console.log
      [PaymentSplitService] Split calculado: { splitsCount: 1, totalPercentage: 50, recipientIds: [ 'rp_123...' ] }

      at PaymentSplitService.calculateSplit (src/services/payment/paymentSplitService.ts:36:13)

    console.log
      [PaymentSplitService] Verificando split. Habilitado: true

      at PaymentSplitService.calculateSplit (src/services/payment/paymentSplitService.ts:10:13)

    console.log
      [PaymentSplitService] Configura√ß√£o de split encontrada: { recipientId: 'rp_123...', percentage: 50 }

      at PaymentSplitService.calculateSplit (src/services/payment/paymentSplitService.ts:24:13)

    console.log
      [PaymentSplitService] Split calculado: { splitsCount: 1, totalPercentage: 50, recipientIds: [ 'rp_123...' ] }

      at PaymentSplitService.calculateSplit (src/services/payment/paymentSplitService.ts:36:13)

    console.log
      [PaymentSplitService] Verificando split. Habilitado: true

      at PaymentSplitService.calculateSplit (src/services/payment/paymentSplitService.ts:10:13)

    console.log
      [PaymentSplitService] Configura√ß√£o de split encontrada: { recipientId: 'rp_123...', percentage: 50 }

      at PaymentSplitService.calculateSplit (src/services/payment/paymentSplitService.ts:24:13)

    console.log
      [PaymentSplitService] Split calculado: { splitsCount: 1, totalPercentage: 50, recipientIds: [ 'rp_123...' ] }

      at PaymentSplitService.calculateSplit (src/services/payment/paymentSplitService.ts:36:13)

    console.log
      [PaymentSplitService] Verificando split. Habilitado: false

      at PaymentSplitService.calculateSplit (src/services/payment/paymentSplitService.ts:10:13)

    console.log
      [PaymentSplitService] Split desabilitado via PAGARME_SPLIT_ENABLED

      at PaymentSplitService.calculateSplit (src/services/payment/paymentSplitService.ts:13:15)

PASS src/clients/pagarme/pagarmeClient.test.ts
PASS src/controllers/payment/recipientController.test.ts
::ffff:127.0.0.1 - - [15/Jan/2026:19:12:32 +0000] "GET /api/anamnesis/answers/user/5074464c-bc26-4a90-a800-25c3df6522cd-system-test HTTP/1.1" 200 74 "-" "-"
::ffff:127.0.0.1 - - [15/Jan/2026:19:12:32 +0000] "POST /api/activities HTTP/1.1" 201 488 "-" "-"
::ffff:127.0.0.1 - - [15/Jan/2026:19:12:32 +0000] "POST /api/ads HTTP/1.1" 201 - "-" "-"
::ffff:127.0.0.1 - - [15/Jan/2026:19:12:33 +0000] "POST /api/tips HTTP/1.1" 201 301 "-" "-"
PASS src/controllers/person/person/personController.integration.test.ts (77.94 s)
  ‚óè Console

    console.log
      [Config] Social.plus config: {
        hasApiKey: true,
        apiKeyLength: 48,
        hasServerKey: true,
        serverKeyLength: 122,
        region: 'EU',
        baseUrl: 'https://apix.eu.amity.co/api'
      }

      at src/config/index.ts:80:15

    console.log
      [SocialPlus] Client initialized: {
        baseUrl: 'https://apix.eu.amity.co/api',
        region: 'EU',
        hasApiKey: true,
        apiKeyLength: 48,
        hasServerKey: true,
        serverKeyLength: 122,
        tokenTtlMs: 300000
      }

      at new SocialPlusClient (src/clients/socialPlus/socialPlusClient.ts:50:13)

    console.info
      Not all input has been taken into account at your final specification.

      at build (node_modules/swagger-jsdoc/src/specification.js:309:15)

    console.error
      Here's the report: 
      
      
       Error in /Users/weber/Projetos/likeme/likeme-back-end/src/controllers/anamnesis/anamnesisController.ts :
      YAMLSemanticError: Nested mappings are not allowed in compact mappings at line 54, column 22:
      
              description: Prefixo opcional para filtrar perguntas por key (ex: mind_‚Ä¶
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^‚Ä¶
      ,Error in /Users/weber/Projetos/likeme/likeme-back-end/src/controllers/auth/authController.docs.ts :
      YAMLSemanticError: Nested mappings are not allowed in compact mappings at line 4, column 18:
      
          description: Retorna o token JWT do backend para o usu√°rio autenticado. √öti‚Ä¶
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^‚Ä¶
      ,Error in /Users/weber/Projetos/likeme/likeme-back-end/src/controllers/auth/authController.docs.ts :
      YAMLSemanticError: Nested mappings are not allowed in compact mappings at line 4, column 18:
      
          description: Retorna o token JWT do backend para o usu√°rio autenticado. √öti‚Ä¶
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^‚Ä¶
      ,Error in /Users/weber/Projetos/likeme/likeme-back-end/src/controllers/auth/authController.docs.ts :
      YAMLSemanticError: Nested mappings are not allowed in compact mappings at line 4, column 18:
      
          description: Retorna o token JWT do backend para o usu√°rio autenticado. √öti‚Ä¶
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^‚Ä¶
      ,Error in /Users/weber/Projetos/likeme/likeme-back-end/src/controllers/auth/authController.docs.ts :
      YAMLSemanticError: Nested mappings are not allowed in compact mappings at line 4, column 18:
      
          description: Retorna o token JWT do backend para o usu√°rio autenticado. √öti‚Ä¶
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^‚Ä¶

      104 |   }
      105 |
    > 106 |   return swaggerJsdoc(swaggerOptions);
          |                      ^
      107 | };
      108 |
      109 | const swaggerSpec = getSwaggerSpec();

      at build (node_modules/swagger-jsdoc/src/specification.js:313:15)
      at Object.<anonymous>.module.exports (node_modules/swagger-jsdoc/src/lib.js:32:10)
      at getSwaggerSpec (src/server.ts:106:22)
      at Object.<anonymous> (src/server.ts:109:21)
      at Object.<anonymous> (src/controllers/person/person/personController.integration.test.ts:2:1)

    console.error
      Validation error: [
        {
          message: '"firstName" is required',
          path: [ 'firstName' ],
          type: 'any.required',
          context: { label: 'firstName', key: 'firstName' }
        },
        {
          message: '"lastName" is required',
          path: [ 'lastName' ],
          type: 'any.required',
          context: { label: 'lastName', key: 'lastName' }
        }
      ]

      10 |     
      11 |     if (error) {
    > 12 |       console.error('Validation error:', error.details);
         |               ^
      13 |       console.error('Request body:', JSON.stringify(req.body, null, 2));
      14 |       
      15 |       const errorMessages = error.details.map(detail => detail.message);

      at src/middleware/validation.ts:12:15
      at Layer.handle [as handle_request] (node_modules/express/lib/router/layer.js:95:5)
      at next (node_modules/express/lib/router/route.js:149:13)
      at node_modules/express-rate-limit/dist/index.cjs:807:7
      at node_modules/express-rate-limit/dist/index.cjs:691:5

    console.error
      Request body: {}

      11 |     if (error) {
      12 |       console.error('Validation error:', error.details);
    > 13 |       console.error('Request body:', JSON.stringify(req.body, null, 2));
         |               ^
      14 |       
      15 |       const errorMessages = error.details.map(detail => detail.message);
      16 |       const errorMessage = errorMessages.length === 1

      at src/middleware/validation.ts:13:15
      at Layer.handle [as handle_request] (node_modules/express/lib/router/layer.js:95:5)
      at next (node_modules/express/lib/router/route.js:149:13)
      at node_modules/express-rate-limit/dist/index.cjs:807:7
      at node_modules/express-rate-limit/dist/index.cjs:691:5

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: 9af19622-8ecd-4f8b-a873-7d782c89a582 na tabela person

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/controllers/person/person/personController.integration.test.ts:125:23)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: f0d4c928-0fe2-4251-8460-381b9cfc3140 na tabela personContact

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/controllers/person/person/personController.integration.test.ts:178:25)

    console.error
      Validation error: [
        {
          message: '"personId" is required',
          path: [ 'personId' ],
          type: 'any.required',
          context: { label: 'personId', key: 'personId' }
        },
        {
          message: '"type" is required',
          path: [ 'type' ],
          type: 'any.required',
          context: { label: 'type', key: 'type' }
        },
        {
          message: '"value" is required',
          path: [ 'value' ],
          type: 'any.required',
          context: { label: 'value', key: 'value' }
        }
      ]

      10 |     
      11 |     if (error) {
    > 12 |       console.error('Validation error:', error.details);
         |               ^
      13 |       console.error('Request body:', JSON.stringify(req.body, null, 2));
      14 |       
      15 |       const errorMessages = error.details.map(detail => detail.message);

      at src/middleware/validation.ts:12:15
      at Layer.handle [as handle_request] (node_modules/express/lib/router/layer.js:95:5)
      at next (node_modules/express/lib/router/route.js:149:13)
      at node_modules/express-rate-limit/dist/index.cjs:807:7
      at node_modules/express-rate-limit/dist/index.cjs:691:5

    console.error
      Request body: {}

      11 |     if (error) {
      12 |       console.error('Validation error:', error.details);
    > 13 |       console.error('Request body:', JSON.stringify(req.body, null, 2));
         |               ^
      14 |       
      15 |       const errorMessages = error.details.map(detail => detail.message);
      16 |       const errorMessage = errorMessages.length === 1

      at src/middleware/validation.ts:13:15
      at Layer.handle [as handle_request] (node_modules/express/lib/router/layer.js:95:5)
      at next (node_modules/express/lib/router/route.js:149:13)
      at node_modules/express-rate-limit/dist/index.cjs:807:7
      at node_modules/express-rate-limit/dist/index.cjs:691:5

    console.error
      Validation error: [
        {
          message: '"type" must be one of [email, phone, whatsapp, other]',
          path: [ 'type' ],
          type: 'any.only',
          context: { valids: [Array], label: 'type', value: 'cpf', key: 'type' }
        }
      ]

      10 |     
      11 |     if (error) {
    > 12 |       console.error('Validation error:', error.details);
         |               ^
      13 |       console.error('Request body:', JSON.stringify(req.body, null, 2));
      14 |       
      15 |       const errorMessages = error.details.map(detail => detail.message);

      at src/middleware/validation.ts:12:15
      at Layer.handle [as handle_request] (node_modules/express/lib/router/layer.js:95:5)
      at next (node_modules/express/lib/router/route.js:149:13)
      at node_modules/express-rate-limit/dist/index.cjs:807:7
      at node_modules/express-rate-limit/dist/index.cjs:691:5

    console.error
      Request body: {
        "personId": "4c935180-6818-49d3-98e0-02d84dd9a6b2-system-test",
        "type": "cpf",
        "value": "test-value"
      }

      11 |     if (error) {
      12 |       console.error('Validation error:', error.details);
    > 13 |       console.error('Request body:', JSON.stringify(req.body, null, 2));
         |               ^
      14 |       
      15 |       const errorMessages = error.details.map(detail => detail.message);
      16 |       const errorMessage = errorMessages.length === 1

      at src/middleware/validation.ts:13:15
      at Layer.handle [as handle_request] (node_modules/express/lib/router/layer.js:95:5)
      at next (node_modules/express/lib/router/route.js:149:13)
      at node_modules/express-rate-limit/dist/index.cjs:807:7
      at node_modules/express-rate-limit/dist/index.cjs:691:5

    console.error
      Validation error: [
        {
          message: '"type" must be one of [email, phone, whatsapp, other]',
          path: [ 'type' ],
          type: 'any.only',
          context: { valids: [Array], label: 'type', value: 'cnpj', key: 'type' }
        }
      ]

      10 |     
      11 |     if (error) {
    > 12 |       console.error('Validation error:', error.details);
         |               ^
      13 |       console.error('Request body:', JSON.stringify(req.body, null, 2));
      14 |       
      15 |       const errorMessages = error.details.map(detail => detail.message);

      at src/middleware/validation.ts:12:15
      at Layer.handle [as handle_request] (node_modules/express/lib/router/layer.js:95:5)
      at next (node_modules/express/lib/router/route.js:149:13)
      at node_modules/express-rate-limit/dist/index.cjs:807:7
      at node_modules/express-rate-limit/dist/index.cjs:691:5

    console.error
      Request body: {
        "personId": "4c935180-6818-49d3-98e0-02d84dd9a6b2-system-test",
        "type": "cnpj",
        "value": "test-value"
      }

      11 |     if (error) {
      12 |       console.error('Validation error:', error.details);
    > 13 |       console.error('Request body:', JSON.stringify(req.body, null, 2));
         |               ^
      14 |       
      15 |       const errorMessages = error.details.map(detail => detail.message);
      16 |       const errorMessage = errorMessages.length === 1

      at src/middleware/validation.ts:13:15
      at Layer.handle [as handle_request] (node_modules/express/lib/router/layer.js:95:5)
      at next (node_modules/express/lib/router/route.js:149:13)
      at node_modules/express-rate-limit/dist/index.cjs:807:7
      at node_modules/express-rate-limit/dist/index.cjs:691:5

    console.error
      Validation error: [
        {
          message: '"type" must be one of [email, phone, whatsapp, other]',
          path: [ 'type' ],
          type: 'any.only',
          context: { valids: [Array], label: 'type', value: 'invalid', key: 'type' }
        }
      ]

      10 |     
      11 |     if (error) {
    > 12 |       console.error('Validation error:', error.details);
         |               ^
      13 |       console.error('Request body:', JSON.stringify(req.body, null, 2));
      14 |       
      15 |       const errorMessages = error.details.map(detail => detail.message);

      at src/middleware/validation.ts:12:15
      at Layer.handle [as handle_request] (node_modules/express/lib/router/layer.js:95:5)
      at next (node_modules/express/lib/router/route.js:149:13)
      at node_modules/express-rate-limit/dist/index.cjs:807:7
      at node_modules/express-rate-limit/dist/index.cjs:691:5

    console.error
      Request body: {
        "personId": "4c935180-6818-49d3-98e0-02d84dd9a6b2-system-test",
        "type": "invalid",
        "value": "test-value"
      }

      11 |     if (error) {
      12 |       console.error('Validation error:', error.details);
    > 13 |       console.error('Request body:', JSON.stringify(req.body, null, 2));
         |               ^
      14 |       
      15 |       const errorMessages = error.details.map(detail => detail.message);
      16 |       const errorMessage = errorMessages.length === 1

      at src/middleware/validation.ts:13:15
      at Layer.handle [as handle_request] (node_modules/express/lib/router/layer.js:95:5)
      at next (node_modules/express/lib/router/route.js:149:13)
      at node_modules/express-rate-limit/dist/index.cjs:807:7
      at node_modules/express-rate-limit/dist/index.cjs:691:5

    console.error
      Validation error: [
        {
          message: '"type" must be one of [email, phone, whatsapp, other]',
          path: [ 'type' ],
          type: 'any.only',
          context: { valids: [Array], label: 'type', value: 'address', key: 'type' }
        }
      ]

      10 |     
      11 |     if (error) {
    > 12 |       console.error('Validation error:', error.details);
         |               ^
      13 |       console.error('Request body:', JSON.stringify(req.body, null, 2));
      14 |       
      15 |       const errorMessages = error.details.map(detail => detail.message);

      at src/middleware/validation.ts:12:15
      at Layer.handle [as handle_request] (node_modules/express/lib/router/layer.js:95:5)
      at next (node_modules/express/lib/router/route.js:149:13)
      at node_modules/express-rate-limit/dist/index.cjs:807:7
      at node_modules/express-rate-limit/dist/index.cjs:691:5

    console.error
      Request body: {
        "personId": "4c935180-6818-49d3-98e0-02d84dd9a6b2-system-test",
        "type": "address",
        "value": "test-value"
      }

      11 |     if (error) {
      12 |       console.error('Validation error:', error.details);
    > 13 |       console.error('Request body:', JSON.stringify(req.body, null, 2));
         |               ^
      14 |       
      15 |       const errorMessages = error.details.map(detail => detail.message);
      16 |       const errorMessage = errorMessages.length === 1

      at src/middleware/validation.ts:13:15
      at Layer.handle [as handle_request] (node_modules/express/lib/router/layer.js:95:5)
      at next (node_modules/express/lib/router/route.js:149:13)
      at node_modules/express-rate-limit/dist/index.cjs:807:7
      at node_modules/express-rate-limit/dist/index.cjs:691:5

    console.error
      Validation error: [
        {
          message: '"type" must be one of [email, phone, whatsapp, other]',
          path: [ 'type' ],
          type: 'any.only',
          context: { valids: [Array], label: 'type', value: 'document', key: 'type' }
        }
      ]

      10 |     
      11 |     if (error) {
    > 12 |       console.error('Validation error:', error.details);
         |               ^
      13 |       console.error('Request body:', JSON.stringify(req.body, null, 2));
      14 |       
      15 |       const errorMessages = error.details.map(detail => detail.message);

      at src/middleware/validation.ts:12:15
      at Layer.handle [as handle_request] (node_modules/express/lib/router/layer.js:95:5)
      at next (node_modules/express/lib/router/route.js:149:13)
      at node_modules/express-rate-limit/dist/index.cjs:807:7
      at node_modules/express-rate-limit/dist/index.cjs:691:5

    console.error
      Request body: {
        "personId": "4c935180-6818-49d3-98e0-02d84dd9a6b2-system-test",
        "type": "document",
        "value": "test-value"
      }

      11 |     if (error) {
      12 |       console.error('Validation error:', error.details);
    > 13 |       console.error('Request body:', JSON.stringify(req.body, null, 2));
         |               ^
      14 |       
      15 |       const errorMessages = error.details.map(detail => detail.message);
      16 |       const errorMessage = errorMessages.length === 1

      at src/middleware/validation.ts:13:15
      at Layer.handle [as handle_request] (node_modules/express/lib/router/layer.js:95:5)
      at next (node_modules/express/lib/router/route.js:149:13)
      at node_modules/express-rate-limit/dist/index.cjs:807:7
      at node_modules/express-rate-limit/dist/index.cjs:691:5

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: b025e1cd-a3e4-4020-b07d-f58341544415 na tabela personContact

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/controllers/person/person/personController.integration.test.ts:232:27)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: bcdea7c7-5be5-48d3-8293-eac1f981c8da na tabela personContact

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/controllers/person/person/personController.integration.test.ts:232:27)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: b5c03ba5-3520-40c3-ad3a-852710631a3f na tabela personContact

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/controllers/person/person/personController.integration.test.ts:232:27)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: 63bbba29-9437-417f-a4f8-fd51acd9cbee na tabela personContact

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/controllers/person/person/personController.integration.test.ts:232:27)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: 24bc75aa-e5bb-4271-aae8-39b86fc17138 na tabela personContact

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/controllers/person/person/personController.integration.test.ts:259:23)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: e5621c58-da34-4d6f-ae1e-b549aa9e7274 na tabela personContact

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/controllers/person/person/personController.integration.test.ts:280:23)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: a49b5cea-1f4d-4224-a34a-2f8bc70908f9 na tabela personContact

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/controllers/person/person/personController.integration.test.ts:306:23)

    console.log
      üßπ Limpando 4 IDs de teste...

      at safeTestCleanup (src/utils/test-helpers.ts:139:15)

    console.log
      ‚úÖ Limpeza de dados de teste conclu√≠da

      at safeTestCleanup (src/utils/test-helpers.ts:333:15)

::ffff:127.0.0.1 - - [15/Jan/2026:19:12:34 +0000] "POST /api/tips HTTP/1.1" 400 313 "-" "-"
::ffff:127.0.0.1 - - [15/Jan/2026:19:12:34 +0000] "POST /api/tips HTTP/1.1" 401 57 "-" "-"
::ffff:127.0.0.1 - - [15/Jan/2026:19:12:34 +0000] "POST /api/activities HTTP/1.1" 201 537 "-" "-"
::ffff:127.0.0.1 - - [15/Jan/2026:19:12:35 +0000] "POST /api/activities HTTP/1.1" 400 325 "-" "-"
::ffff:127.0.0.1 - - [15/Jan/2026:19:12:35 +0000] "POST /api/activities HTTP/1.1" 401 57 "-" "-"
::ffff:127.0.0.1 - - [15/Jan/2026:19:12:37 +0000] "DELETE /api/tips/1cfb7038-c173-4385-b30d-e8e4cd1e3a8d HTTP/1.1" 200 306 "-" "-"
::ffff:127.0.0.1 - - [15/Jan/2026:19:12:38 +0000] "POST /api/auth/register HTTP/1.1" 201 - "-" "-"
::ffff:127.0.0.1 - - [15/Jan/2026:19:12:40 +0000] "GET /api/anamnesis/answers/user/b6feed95-8762-4552-8d7e-a8ed94ce7263-system-test/question/bfae0b07-062f-4151-b389-afd76c09be40-system-test HTTP/1.1" 200 418 "-" "-"
::ffff:127.0.0.1 - - [15/Jan/2026:19:12:40 +0000] "GET /api/activities HTTP/1.1" 200 - "-" "-"
::ffff:127.0.0.1 - - [15/Jan/2026:19:12:40 +0000] "DELETE /api/tips/non-existent-id HTTP/1.1" 404 50 "-" "-"
::ffff:127.0.0.1 - - [15/Jan/2026:19:12:40 +0000] "DELETE /api/tips/some-id HTTP/1.1" 401 57 "-" "-"
::ffff:127.0.0.1 - - [15/Jan/2026:19:12:41 +0000] "POST /api/payment/process HTTP/1.1" 400 50 "-" "-"
::ffff:127.0.0.1 - - [15/Jan/2026:19:12:41 +0000] "POST /api/ads HTTP/1.1" 201 - "-" "-"
PASS src/controllers/tip/tipController.test.ts (18.228 s)
  ‚óè Console

    console.log
      [Config] Social.plus config: {
        hasApiKey: true,
        apiKeyLength: 48,
        hasServerKey: true,
        serverKeyLength: 122,
        region: 'EU',
        baseUrl: 'https://apix.eu.amity.co/api'
      }

      at src/config/index.ts:80:15

    console.log
      [SocialPlus] Client initialized: {
        baseUrl: 'https://apix.eu.amity.co/api',
        region: 'EU',
        hasApiKey: true,
        apiKeyLength: 48,
        hasServerKey: true,
        serverKeyLength: 122,
        tokenTtlMs: 300000
      }

      at new SocialPlusClient (src/clients/socialPlus/socialPlusClient.ts:50:13)

    console.info
      Not all input has been taken into account at your final specification.

      at build (node_modules/swagger-jsdoc/src/specification.js:309:15)

    console.error
      Here's the report: 
      
      
       Error in /Users/weber/Projetos/likeme/likeme-back-end/src/controllers/anamnesis/anamnesisController.ts :
      YAMLSemanticError: Nested mappings are not allowed in compact mappings at line 54, column 22:
      
              description: Prefixo opcional para filtrar perguntas por key (ex: mind_‚Ä¶
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^‚Ä¶
      ,Error in /Users/weber/Projetos/likeme/likeme-back-end/src/controllers/auth/authController.docs.ts :
      YAMLSemanticError: Nested mappings are not allowed in compact mappings at line 4, column 18:
      
          description: Retorna o token JWT do backend para o usu√°rio autenticado. √öti‚Ä¶
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^‚Ä¶
      ,Error in /Users/weber/Projetos/likeme/likeme-back-end/src/controllers/auth/authController.docs.ts :
      YAMLSemanticError: Nested mappings are not allowed in compact mappings at line 4, column 18:
      
          description: Retorna o token JWT do backend para o usu√°rio autenticado. √öti‚Ä¶
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^‚Ä¶
      ,Error in /Users/weber/Projetos/likeme/likeme-back-end/src/controllers/auth/authController.docs.ts :
      YAMLSemanticError: Nested mappings are not allowed in compact mappings at line 4, column 18:
      
          description: Retorna o token JWT do backend para o usu√°rio autenticado. √öti‚Ä¶
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^‚Ä¶
      ,Error in /Users/weber/Projetos/likeme/likeme-back-end/src/controllers/auth/authController.docs.ts :
      YAMLSemanticError: Nested mappings are not allowed in compact mappings at line 4, column 18:
      
          description: Retorna o token JWT do backend para o usu√°rio autenticado. √öti‚Ä¶
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^‚Ä¶

      104 |   }
      105 |
    > 106 |   return swaggerJsdoc(swaggerOptions);
          |                      ^
      107 | };
      108 |
      109 | const swaggerSpec = getSwaggerSpec();

      at build (node_modules/swagger-jsdoc/src/specification.js:313:15)
      at Object.<anonymous>.module.exports (node_modules/swagger-jsdoc/src/lib.js:32:10)
      at getSwaggerSpec (src/server.ts:106:22)
      at Object.<anonymous> (src/server.ts:109:21)
      at Object.<anonymous> (src/controllers/tip/tipController.test.ts:2:1)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: 2329983c-ee79-4f55-9b7f-2cb93a74e467 na tabela tip

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/controllers/tip/tipController.test.ts:82:27)

    console.error
      Validation error: [
        {
          message: '"title" is required',
          path: [ 'title' ],
          type: 'any.required',
          context: { label: 'title', key: 'title' }
        },
        {
          message: '"image" is required',
          path: [ 'image' ],
          type: 'any.required',
          context: { label: 'image', key: 'image' }
        }
      ]

      10 |     
      11 |     if (error) {
    > 12 |       console.error('Validation error:', error.details);
         |               ^
      13 |       console.error('Request body:', JSON.stringify(req.body, null, 2));
      14 |       
      15 |       const errorMessages = error.details.map(detail => detail.message);

      at src/middleware/validation.ts:12:15
      at Layer.handle [as handle_request] (node_modules/express/lib/router/layer.js:95:5)
      at next (node_modules/express/lib/router/route.js:149:13)
      at node_modules/express-rate-limit/dist/index.cjs:807:7
      at node_modules/express-rate-limit/dist/index.cjs:691:5

    console.error
      Request body: {
        "description": "Missing title and image"
      }

      11 |     if (error) {
      12 |       console.error('Validation error:', error.details);
    > 13 |       console.error('Request body:', JSON.stringify(req.body, null, 2));
         |               ^
      14 |       
      15 |       const errorMessages = error.details.map(detail => detail.message);
      16 |       const errorMessage = errorMessages.length === 1

      at src/middleware/validation.ts:13:15
      at Layer.handle [as handle_request] (node_modules/express/lib/router/layer.js:95:5)
      at next (node_modules/express/lib/router/route.js:149:13)
      at node_modules/express-rate-limit/dist/index.cjs:807:7
      at node_modules/express-rate-limit/dist/index.cjs:691:5

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: 1cfb7038-c173-4385-b30d-e8e4cd1e3a8d na tabela tip

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/controllers/tip/tipController.test.ts:123:25)

    console.log
      prisma:error 
      Invalid `prisma.tip.delete()` invocation in
      /Users/weber/Projetos/likeme/likeme-back-end/src/controllers/tip/tipController.ts:88:47
      
        85 const { id } = req.params;
        86 
        87 try {
      ‚Üí 88   const deletedTip = await prisma.tip.delete(
      An operation failed because it depends on one or more records that were required but not found. No record was found for a delete.

      at Object.zc (node_modules/@prisma/internals/src/logger.ts:13:11)

    console.error
      Erro ao remover dica: PrismaClientKnownRequestError: 
      Invalid `prisma.tip.delete()` invocation in
      /Users/weber/Projetos/likeme/likeme-back-end/src/controllers/tip/tipController.ts:88:47
      
        85 const { id } = req.params;
        86 
        87 try {
      ‚Üí 88   const deletedTip = await prisma.tip.delete(
      An operation failed because it depends on one or more records that were required but not found. No record was found for a delete.
          at ei.handleRequestError (/Users/weber/Projetos/likeme/likeme-back-end/node_modules/@prisma/client/src/runtime/RequestHandler.ts:228:13)
          at ei.handleAndLogRequestError (/Users/weber/Projetos/likeme/likeme-back-end/node_modules/@prisma/client/src/runtime/RequestHandler.ts:174:12)
          at ei.request (/Users/weber/Projetos/likeme/likeme-back-end/node_modules/@prisma/client/src/runtime/RequestHandler.ts:143:12)
          at a (/Users/weber/Projetos/likeme/likeme-back-end/node_modules/@prisma/client/src/runtime/getPrismaClient.ts:833:24)
          at deleteTip (/Users/weber/Projetos/likeme/likeme-back-end/src/controllers/tip/tipController.ts:88:24) {
        code: 'P2025',
        meta: { modelName: 'Tip', cause: 'No record was found for a delete.' },
        clientVersion: '6.18.0'
      }

      92 |     sendSuccess(res, deletedTip, 'Dica removida com sucesso');
      93 |   } catch (error) {
    > 94 |     console.error('Erro ao remover dica:', error);
         |             ^
      95 |
      96 |     if (error instanceof Prisma.PrismaClientKnownRequestError && error.code === 'P2025') {
      97 |       sendError(res, 'Dica n√£o encontrada', 404);

      at deleteTip (src/controllers/tip/tipController.ts:94:13)

    console.log
      üßπ Limpando 2 IDs de teste...

      at safeTestCleanup (src/utils/test-helpers.ts:139:15)

    console.log
      ‚úÖ Limpeza de dados de teste conclu√≠da

      at safeTestCleanup (src/utils/test-helpers.ts:333:15)

FAIL src/controllers/payment/paymentController.integration.test.ts (92.707 s)
  ‚óè Console

    console.log
      [Config] Social.plus config: {
        hasApiKey: true,
        apiKeyLength: 48,
        hasServerKey: true,
        serverKeyLength: 122,
        region: 'EU',
        baseUrl: 'https://apix.eu.amity.co/api'
      }

      at src/config/index.ts:80:15

    console.log
      [SocialPlus] Client initialized: {
        baseUrl: 'https://apix.eu.amity.co/api',
        region: 'EU',
        hasApiKey: true,
        apiKeyLength: 48,
        hasServerKey: true,
        serverKeyLength: 122,
        tokenTtlMs: 300000
      }

      at new SocialPlusClient (src/clients/socialPlus/socialPlusClient.ts:50:13)

    console.info
      Not all input has been taken into account at your final specification.

      at build (node_modules/swagger-jsdoc/src/specification.js:309:15)

    console.error
      Here's the report: 
      
      
       Error in /Users/weber/Projetos/likeme/likeme-back-end/src/controllers/anamnesis/anamnesisController.ts :
      YAMLSemanticError: Nested mappings are not allowed in compact mappings at line 54, column 22:
      
              description: Prefixo opcional para filtrar perguntas por key (ex: mind_‚Ä¶
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^‚Ä¶
      ,Error in /Users/weber/Projetos/likeme/likeme-back-end/src/controllers/auth/authController.docs.ts :
      YAMLSemanticError: Nested mappings are not allowed in compact mappings at line 4, column 18:
      
          description: Retorna o token JWT do backend para o usu√°rio autenticado. √öti‚Ä¶
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^‚Ä¶
      ,Error in /Users/weber/Projetos/likeme/likeme-back-end/src/controllers/auth/authController.docs.ts :
      YAMLSemanticError: Nested mappings are not allowed in compact mappings at line 4, column 18:
      
          description: Retorna o token JWT do backend para o usu√°rio autenticado. √öti‚Ä¶
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^‚Ä¶
      ,Error in /Users/weber/Projetos/likeme/likeme-back-end/src/controllers/auth/authController.docs.ts :
      YAMLSemanticError: Nested mappings are not allowed in compact mappings at line 4, column 18:
      
          description: Retorna o token JWT do backend para o usu√°rio autenticado. √öti‚Ä¶
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^‚Ä¶
      ,Error in /Users/weber/Projetos/likeme/likeme-back-end/src/controllers/auth/authController.docs.ts :
      YAMLSemanticError: Nested mappings are not allowed in compact mappings at line 4, column 18:
      
          description: Retorna o token JWT do backend para o usu√°rio autenticado. √öti‚Ä¶
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^‚Ä¶

      104 |   }
      105 |
    > 106 |   return swaggerJsdoc(swaggerOptions);
          |                      ^
      107 | };
      108 |
      109 | const swaggerSpec = getSwaggerSpec();

      at build (node_modules/swagger-jsdoc/src/specification.js:313:15)
      at Object.<anonymous>.module.exports (node_modules/swagger-jsdoc/src/lib.js:32:10)
      at getSwaggerSpec (src/server.ts:106:22)
      at Object.<anonymous> (src/server.ts:109:21)
      at Object.<anonymous> (src/controllers/payment/paymentController.integration.test.ts:2:1)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: 943b4fdf-e999-4ddf-8758-2a09d36e3bf7 na tabela product

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/controllers/payment/paymentController.integration.test.ts:80:21)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: a1d9a9d7-5ebd-493d-8762-dd99925d4ba6 na tabela order

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/controllers/payment/paymentController.integration.test.ts:110:21)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: c0320f10-d8e2-4383-a001-622c9a460de2 na tabela orderItem

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at src/controllers/payment/paymentController.integration.test.ts:111:60
          at Array.forEach (<anonymous>)
      at Object.<anonymous> (src/controllers/payment/paymentController.integration.test.ts:111:21)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: 52a1c00c-a9dd-4147-8bbd-112112f43f59 na tabela order

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/controllers/payment/paymentController.integration.test.ts:253:23)

    console.error
      Validation error: [
        {
          message: '"orderId" is required',
          path: [ 'orderId' ],
          type: 'any.required',
          context: { label: 'orderId', key: 'orderId' }
        },
        {
          message: '"billingAddress" is required',
          path: [ 'billingAddress' ],
          type: 'any.required',
          context: { label: 'billingAddress', key: 'billingAddress' }
        }
      ]

      10 |     
      11 |     if (error) {
    > 12 |       console.error('Validation error:', error.details);
         |               ^
      13 |       console.error('Request body:', JSON.stringify(req.body, null, 2));
      14 |       
      15 |       const errorMessages = error.details.map(detail => detail.message);

      at src/middleware/validation.ts:12:15
      at Layer.handle [as handle_request] (node_modules/express/lib/router/layer.js:95:5)
      at next (node_modules/express/lib/router/route.js:149:13)
      at authenticateToken (src/middleware/auth.ts:59:12)

    console.error
      Request body: {
        "cardData": {
          "cardNumber": "4111111111111111",
          "cardHolderName": "Test User",
          "cardExpirationDate": "1225",
          "cardCvv": "123"
        }
      }

      11 |     if (error) {
      12 |       console.error('Validation error:', error.details);
    > 13 |       console.error('Request body:', JSON.stringify(req.body, null, 2));
         |               ^
      14 |       
      15 |       const errorMessages = error.details.map(detail => detail.message);
      16 |       const errorMessage = errorMessages.length === 1

      at src/middleware/validation.ts:13:15
      at Layer.handle [as handle_request] (node_modules/express/lib/router/layer.js:95:5)
      at next (node_modules/express/lib/router/route.js:149:13)
      at authenticateToken (src/middleware/auth.ts:59:12)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: 4daab604-2062-4b26-9794-e98a6be0ab6d na tabela product

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/controllers/payment/paymentController.integration.test.ts:542:23)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: 065c45ff-0574-4313-b554-6a6efb9ff553 na tabela order

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/controllers/payment/paymentController.integration.test.ts:563:23)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: fbd146ff-9ddc-4e82-99ee-1d162a1febb7 na tabela product

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/controllers/payment/paymentController.integration.test.ts:624:23)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: a6a11d5e-fc3d-41c0-9489-afa6aac38305 na tabela order

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/controllers/payment/paymentController.integration.test.ts:645:23)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: 2343c97e-5f6f-4ea1-9a19-8ba0ffd38ada na tabela product

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/controllers/payment/paymentController.integration.test.ts:699:23)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: 675a26a6-57a9-4526-aef9-9b23953a9bec na tabela order

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/controllers/payment/paymentController.integration.test.ts:720:23)

    console.log
      üßπ Limpando 4 IDs de teste...

      at safeTestCleanup (src/utils/test-helpers.ts:139:15)

    console.log
      ‚úÖ Limpeza de dados de teste conclu√≠da

      at safeTestCleanup (src/utils/test-helpers.ts:333:15)

  ‚óè Payment Endpoints ‚Ä∫ POST /api/payment/process ‚Ä∫ should process payment successfully

    expect(received).toBe(expected) // Object.is equality

    Expected: 200
    Received: 400

      151 |         .set('Authorization', `Bearer ${authToken}`);
      152 |
    > 153 |       expect(response.status).toBe(200);
          |                               ^
      154 |       expect(response.body.success).toBe(true);
      155 |       expect(response.body.data.order).toBeDefined();
      156 |       expect(response.body.data.transaction).toBeDefined();

      at Object.<anonymous> (src/controllers/payment/paymentController.integration.test.ts:153:31)

  ‚óè Payment Endpoints ‚Ä∫ POST /api/payment/process ‚Ä∫ should handle Pagarme transaction error

    expect(received).toBe(expected) // Object.is equality

    Expected: "failed"
    Received: "pending"

      317 |         where: { id: testOrder.id },
      318 |       });
    > 319 |       expect(updatedOrder?.paymentStatus).toBe('failed');
          |                                           ^
      320 |     });
      321 |
      322 |     it('should validate required fields', async () => {

      at Object.<anonymous> (src/controllers/payment/paymentController.integration.test.ts:319:43)

  ‚óè Payment Endpoints ‚Ä∫ CPF handling ‚Ä∫ should use CPF from cardData when provided

    expect(received).toBe(expected) // Object.is equality

    Expected: 200
    Received: 400

      585 |         });
      586 |
    > 587 |       expect(response.status).toBe(200);
          |                               ^
      588 |       expect(createCreditCardTransaction).toHaveBeenCalled();
      589 |       const callArgs = createCreditCardTransaction.mock.calls[0][0];
      590 |       expect(callArgs.customer.documents).toBeDefined();

      at Object.<anonymous> (src/controllers/payment/paymentController.integration.test.ts:587:31)

  ‚óè Payment Endpoints ‚Ä∫ CPF handling ‚Ä∫ should fallback to nationalRegistration when CPF not in cardData

    expect(received).toBe(expected) // Object.is equality

    Expected: 200
    Received: 400

      667 |         });
      668 |
    > 669 |       expect(response.status).toBe(200);
          |                               ^
      670 |       expect(createCreditCardTransaction).toHaveBeenCalled();
      671 |       const callArgs = createCreditCardTransaction.mock.calls[0][0];
      672 |       expect(callArgs.customer.documents).toBeDefined();

      at Object.<anonymous> (src/controllers/payment/paymentController.integration.test.ts:669:31)

  ‚óè Payment Endpoints ‚Ä∫ CPF handling ‚Ä∫ should return error when CPF is not available in nationalRegistration or cardData

    expect(received).toContain(expected) // indexOf

    Expected substring: "CPF do cliente √© obrigat√≥rio"
    Received string:    "User email not found"

      744 |       expect(response.status).toBe(400);
      745 |       expect(response.body.success).toBe(false);
    > 746 |       expect(response.body.message).toContain('CPF do cliente √© obrigat√≥rio');
          |                                     ^
      747 |     });
      748 |   });
      749 | });

      at Object.<anonymous> (src/controllers/payment/paymentController.integration.test.ts:746:37)

::ffff:127.0.0.1 - - [15/Jan/2026:19:12:44 +0000] "GET /api/anamnesis/answers/user/b6feed95-8762-4552-8d7e-a8ed94ce7263-system-test/question/b82d24e3-1417-4658-a0e1-992ca4631b2d-system-test HTTP/1.1" 404 46 "-" "-"
::ffff:127.0.0.1 - - [15/Jan/2026:19:12:45 +0000] "POST /api/auth/register HTTP/1.1" 201 - "-" "-"
::ffff:127.0.0.1 - - [15/Jan/2026:19:12:45 +0000] "POST /api/ads HTTP/1.1" 400 279 "-" "-"
::ffff:127.0.0.1 - - [15/Jan/2026:19:12:46 +0000] "GET /api/activities?type=event HTTP/1.1" 200 - "-" "-"
PASS src/controllers/auth/authController.test.ts (17.722 s)
  ‚óè Console

    console.log
      [Config] Social.plus config: {
        hasApiKey: true,
        apiKeyLength: 48,
        hasServerKey: true,
        serverKeyLength: 122,
        region: 'EU',
        baseUrl: 'https://apix.eu.amity.co/api'
      }

      at src/config/index.ts:80:15

    console.log
      [SocialPlus] Client initialized: {
        baseUrl: 'https://apix.eu.amity.co/api',
        region: 'EU',
        hasApiKey: true,
        apiKeyLength: 48,
        hasServerKey: true,
        serverKeyLength: 122,
        tokenTtlMs: 300000
      }

      at new SocialPlusClient (src/clients/socialPlus/socialPlusClient.ts:50:13)

    console.info
      Not all input has been taken into account at your final specification.

      at build (node_modules/swagger-jsdoc/src/specification.js:309:15)

    console.error
      Here's the report: 
      
      
       Error in /Users/weber/Projetos/likeme/likeme-back-end/src/controllers/anamnesis/anamnesisController.ts :
      YAMLSemanticError: Nested mappings are not allowed in compact mappings at line 54, column 22:
      
              description: Prefixo opcional para filtrar perguntas por key (ex: mind_‚Ä¶
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^‚Ä¶
      ,Error in /Users/weber/Projetos/likeme/likeme-back-end/src/controllers/auth/authController.docs.ts :
      YAMLSemanticError: Nested mappings are not allowed in compact mappings at line 4, column 18:
      
          description: Retorna o token JWT do backend para o usu√°rio autenticado. √öti‚Ä¶
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^‚Ä¶
      ,Error in /Users/weber/Projetos/likeme/likeme-back-end/src/controllers/auth/authController.docs.ts :
      YAMLSemanticError: Nested mappings are not allowed in compact mappings at line 4, column 18:
      
          description: Retorna o token JWT do backend para o usu√°rio autenticado. √öti‚Ä¶
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^‚Ä¶
      ,Error in /Users/weber/Projetos/likeme/likeme-back-end/src/controllers/auth/authController.docs.ts :
      YAMLSemanticError: Nested mappings are not allowed in compact mappings at line 4, column 18:
      
          description: Retorna o token JWT do backend para o usu√°rio autenticado. √öti‚Ä¶
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^‚Ä¶
      ,Error in /Users/weber/Projetos/likeme/likeme-back-end/src/controllers/auth/authController.docs.ts :
      YAMLSemanticError: Nested mappings are not allowed in compact mappings at line 4, column 18:
      
          description: Retorna o token JWT do backend para o usu√°rio autenticado. √öti‚Ä¶
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^‚Ä¶

      104 |   }
      105 |
    > 106 |   return swaggerJsdoc(swaggerOptions);
          |                      ^
      107 | };
      108 |
      109 | const swaggerSpec = getSwaggerSpec();

      at build (node_modules/swagger-jsdoc/src/specification.js:313:15)
      at Object.<anonymous>.module.exports (node_modules/swagger-jsdoc/src/lib.js:32:10)
      at getSwaggerSpec (src/server.ts:106:22)
      at Object.<anonymous> (src/server.ts:109:21)
      at Object.<anonymous> (src/controllers/auth/authController.test.ts:2:1)

    console.log
      [SocialPlus] Using API Key (first 10 chars): b0e5e95e6b...

      at SocialPlusClient.makeRequest (src/clients/socialPlus/socialPlusClient.ts:106:17)

    console.log
      [SocialPlus] Making request: {
        method: 'POST',
        url: 'https://apix.eu.amity.co/api/v1/users',
        headers: {
          'Content-Type': 'application/json',
          'X-Region': 'EU',
          'X-API-Key': 'b0e5e95e6bdaf0361f31881c565b158fd35cdeeabe30692f'
        },
        hasBody: true
      }

      at SocialPlusClient.makeRequest (src/clients/socialPlus/socialPlusClient.ts:122:15)

    console.log
      [SocialPlus] Response: {
        status: 404,
        statusText: 'Not Found',
        contentType: 'application/json; charset=utf-8',
        dataPreview: '{"status":"error","message":"Not found","code":500000,"data":{}}'
      }

      at SocialPlusClient.makeRequest (src/clients/socialPlus/socialPlusClient.ts:133:15)

    console.error
      [SocialPlus] Request failed: {
        status: 404,
        statusText: 'Not Found',
        error: 'Not found',
        url: 'https://apix.eu.amity.co/api/v1/users',
        method: 'POST',
        fullData: { status: 'error', message: 'Not found', code: 500000, data: {} }
      }

      156 |         }
      157 |         
    > 158 |         console.error('[SocialPlus] Request failed:', {
          |                 ^
      159 |           status: response.status,
      160 |           statusText: response.statusText,
      161 |           error: errorMessage,

      at SocialPlusClient.makeRequest (src/clients/socialPlus/socialPlusClient.ts:158:17)
      at UserService.createUser (src/services/user/userService.ts:8:22)
      at UserService.createUserAndSyncToDatabase (src/services/user/userService.ts:21:28)
      at register (src/controllers/auth/authController.ts:96:24)

    console.error
      Erro ao criar usu√°rio na social.plus: Error: Not found
          at UserService.createUser (/Users/weber/Projetos/likeme/likeme-back-end/src/services/user/userService.ts:11:13)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)
          at UserService.createUserAndSyncToDatabase (/Users/weber/Projetos/likeme/likeme-back-end/src/services/user/userService.ts:21:28)
          at register (/Users/weber/Projetos/likeme/likeme-back-end/src/controllers/auth/authController.ts:96:24)

      105 |       }
      106 |     } catch (error) {
    > 107 |       console.error('Erro ao criar usu√°rio na social.plus:', error);
          |               ^
      108 |     }
      109 |
      110 |     const token = generateToken(user.id);

      at register (src/controllers/auth/authController.ts:107:15)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: 16dcaaf6-4ae3-4715-b435-df8555178246 na tabela user

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/controllers/auth/authController.test.ts:52:27)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: 0019f016-32b3-40b4-a2d7-ebf9ed92bf90 na tabela person

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/controllers/auth/authController.test.ts:55:27)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: 8d4721de-2834-476b-b405-83843bb8a715 na tabela personContact

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at src/controllers/auth/authController.test.ts:59:45
          at Array.forEach (<anonymous>)
      at Object.<anonymous> (src/controllers/auth/authController.test.ts:58:51)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: fd26d72d-1fc7-4fbb-bebb-74cc61fb581c na tabela personContact

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at src/controllers/auth/authController.test.ts:59:45
          at Array.forEach (<anonymous>)
      at Object.<anonymous> (src/controllers/auth/authController.test.ts:58:51)

    console.log
      [SocialPlus] Using API Key (first 10 chars): b0e5e95e6b...

      at SocialPlusClient.makeRequest (src/clients/socialPlus/socialPlusClient.ts:106:17)

    console.log
      [SocialPlus] Making request: {
        method: 'POST',
        url: 'https://apix.eu.amity.co/api/v1/users',
        headers: {
          'Content-Type': 'application/json',
          'X-Region': 'EU',
          'X-API-Key': 'b0e5e95e6bdaf0361f31881c565b158fd35cdeeabe30692f'
        },
        hasBody: true
      }

      at SocialPlusClient.makeRequest (src/clients/socialPlus/socialPlusClient.ts:122:15)

    console.log
      [SocialPlus] Response: {
        status: 404,
        statusText: 'Not Found',
        contentType: 'application/json; charset=utf-8',
        dataPreview: '{"status":"error","message":"Not found","code":500000,"data":{}}'
      }

      at SocialPlusClient.makeRequest (src/clients/socialPlus/socialPlusClient.ts:133:15)

    console.error
      [SocialPlus] Request failed: {
        status: 404,
        statusText: 'Not Found',
        error: 'Not found',
        url: 'https://apix.eu.amity.co/api/v1/users',
        method: 'POST',
        fullData: { status: 'error', message: 'Not found', code: 500000, data: {} }
      }

      156 |         }
      157 |         
    > 158 |         console.error('[SocialPlus] Request failed:', {
          |                 ^
      159 |           status: response.status,
      160 |           statusText: response.statusText,
      161 |           error: errorMessage,

      at SocialPlusClient.makeRequest (src/clients/socialPlus/socialPlusClient.ts:158:17)
      at UserService.createUser (src/services/user/userService.ts:8:22)
      at UserService.createUserAndSyncToDatabase (src/services/user/userService.ts:21:28)
      at register (src/controllers/auth/authController.ts:96:24)

    console.error
      Erro ao criar usu√°rio na social.plus: Error: Not found
          at UserService.createUser (/Users/weber/Projetos/likeme/likeme-back-end/src/services/user/userService.ts:11:13)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)
          at UserService.createUserAndSyncToDatabase (/Users/weber/Projetos/likeme/likeme-back-end/src/services/user/userService.ts:21:28)
          at register (/Users/weber/Projetos/likeme/likeme-back-end/src/controllers/auth/authController.ts:96:24)

      105 |       }
      106 |     } catch (error) {
    > 107 |       console.error('Erro ao criar usu√°rio na social.plus:', error);
          |               ^
      108 |     }
      109 |
      110 |     const token = generateToken(user.id);

      at register (src/controllers/auth/authController.ts:107:15)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: 99725a08-c362-43fd-ae8e-fca473e0a2c2 na tabela user

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/controllers/auth/authController.test.ts:92:27)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: 66ac640e-de1f-4561-88e3-d1a25c47fb9f na tabela person

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/controllers/auth/authController.test.ts:95:27)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: b28791c9-245d-4b8d-9aa8-504f5276ea24 na tabela personContact

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at src/controllers/auth/authController.test.ts:99:45
          at Array.forEach (<anonymous>)
      at Object.<anonymous> (src/controllers/auth/authController.test.ts:98:52)

    console.error
      Validation error: [
        {
          message: '"email" is required',
          path: [ 'email' ],
          type: 'any.required',
          context: { label: 'email', key: 'email' }
        },
        {
          message: '"password" is required',
          path: [ 'password' ],
          type: 'any.required',
          context: { label: 'password', key: 'password' }
        },
        {
          message: '"lastName" is required',
          path: [ 'lastName' ],
          type: 'any.required',
          context: { label: 'lastName', key: 'lastName' }
        }
      ]

      10 |     
      11 |     if (error) {
    > 12 |       console.error('Validation error:', error.details);
         |               ^
      13 |       console.error('Request body:', JSON.stringify(req.body, null, 2));
      14 |       
      15 |       const errorMessages = error.details.map(detail => detail.message);

      at src/middleware/validation.ts:12:15
      at Layer.handle [as handle_request] (node_modules/express/lib/router/layer.js:95:5)
      at next (node_modules/express/lib/router/route.js:149:13)
      at node_modules/express-rate-limit/dist/index.cjs:807:7
      at node_modules/express-rate-limit/dist/index.cjs:691:5

    console.error
      Request body: {
        "firstName": "Test"
      }

      11 |     if (error) {
      12 |       console.error('Validation error:', error.details);
    > 13 |       console.error('Request body:', JSON.stringify(req.body, null, 2));
         |               ^
      14 |       
      15 |       const errorMessages = error.details.map(detail => detail.message);
      16 |       const errorMessage = errorMessages.length === 1

      at src/middleware/validation.ts:13:15
      at Layer.handle [as handle_request] (node_modules/express/lib/router/layer.js:95:5)
      at next (node_modules/express/lib/router/route.js:149:13)
      at node_modules/express-rate-limit/dist/index.cjs:807:7
      at node_modules/express-rate-limit/dist/index.cjs:691:5

    console.log
      Validating Auth0 token, length: 16

      at login (src/controllers/auth/authController.ts:150:15)

    console.log
      Token preview: mock-auth0-token...

      at login (src/controllers/auth/authController.ts:151:15)

    console.error
      JWT verification error: jwt malformed

      45 |       (err, decoded) => {
      46 |         if (err) {
    > 47 |           console.error('JWT verification error:', err.message);
         |                   ^
      48 |           console.error('Token issuer expected:', config.auth0.issuer);
      49 |           if (decoded && typeof decoded !== 'string' && 'iss' in decoded) {
      50 |             console.error('Token issuer received:', decoded.iss);

      at src/utils/auth0.ts:47:19
      at Object.<anonymous>.module.exports [as verify] (node_modules/jsonwebtoken/verify.js:70:12)
      at src/utils/auth0.ts:41:9
      at verifyAuth0Token (src/utils/auth0.ts:28:10)
      at login (src/controllers/auth/authController.ts:152:39)
      at Layer.handle [as handle_request] (node_modules/express/lib/router/layer.js:95:5)
      at next (node_modules/express/lib/router/route.js:149:13)
      at src/middleware/validation.ts:33:12
      at Layer.handle [as handle_request] (node_modules/express/lib/router/layer.js:95:5)
      at next (node_modules/express/lib/router/route.js:149:13)
      at node_modules/express-rate-limit/dist/index.cjs:807:7
      at node_modules/express-rate-limit/dist/index.cjs:691:5

    console.error
      Token issuer expected: https://test-auth0-domain.auth0.com/

      46 |         if (err) {
      47 |           console.error('JWT verification error:', err.message);
    > 48 |           console.error('Token issuer expected:', config.auth0.issuer);
         |                   ^
      49 |           if (decoded && typeof decoded !== 'string' && 'iss' in decoded) {
      50 |             console.error('Token issuer received:', decoded.iss);
      51 |             if ('aud' in decoded) {

      at src/utils/auth0.ts:48:19
      at Object.<anonymous>.module.exports [as verify] (node_modules/jsonwebtoken/verify.js:70:12)
      at src/utils/auth0.ts:41:9
      at verifyAuth0Token (src/utils/auth0.ts:28:10)
      at login (src/controllers/auth/authController.ts:152:39)
      at Layer.handle [as handle_request] (node_modules/express/lib/router/layer.js:95:5)
      at next (node_modules/express/lib/router/route.js:149:13)
      at src/middleware/validation.ts:33:12
      at Layer.handle [as handle_request] (node_modules/express/lib/router/layer.js:95:5)
      at next (node_modules/express/lib/router/route.js:149:13)
      at node_modules/express-rate-limit/dist/index.cjs:807:7
      at node_modules/express-rate-limit/dist/index.cjs:691:5

    console.error
      Auth0 token validation error: JsonWebTokenError {
        name: 'JsonWebTokenError',
        message: 'jwt malformed'
      }

      155 |       console.log('Decoded token audience:', decoded.aud);
      156 |     } catch (error) {
    > 157 |       console.error('Auth0 token validation error:', error);
          |               ^
      158 |       if (error instanceof Error) {
      159 |         console.error('Error message:', error.message);
      160 |         console.error('Error stack:', error.stack);

      at login (src/controllers/auth/authController.ts:157:15)

    console.error
      Error message: jwt malformed

      157 |       console.error('Auth0 token validation error:', error);
      158 |       if (error instanceof Error) {
    > 159 |         console.error('Error message:', error.message);
          |                 ^
      160 |         console.error('Error stack:', error.stack);
      161 |       }
      162 |       sendError(res, `Token do Auth0 inv√°lido ou expirado: ${error instanceof Error ? error.message : 'Erro desconhecido'}`, 401);

      at login (src/controllers/auth/authController.ts:159:17)

    console.error
      Error stack: JsonWebTokenError: jwt malformed
          at Object.<anonymous>.module.exports [as verify] (/Users/weber/Projetos/likeme/likeme-back-end/node_modules/jsonwebtoken/verify.js:70:17)
          at /Users/weber/Projetos/likeme/likeme-back-end/src/utils/auth0.ts:41:9
          at new Promise (<anonymous>)
          at verifyAuth0Token (/Users/weber/Projetos/likeme/likeme-back-end/src/utils/auth0.ts:28:10)
          at login (/Users/weber/Projetos/likeme/likeme-back-end/src/controllers/auth/authController.ts:152:39)
          at Layer.handle [as handle_request] (/Users/weber/Projetos/likeme/likeme-back-end/node_modules/express/lib/router/layer.js:95:5)
          at next (/Users/weber/Projetos/likeme/likeme-back-end/node_modules/express/lib/router/route.js:149:13)
          at /Users/weber/Projetos/likeme/likeme-back-end/src/middleware/validation.ts:33:12
          at Layer.handle [as handle_request] (/Users/weber/Projetos/likeme/likeme-back-end/node_modules/express/lib/router/layer.js:95:5)
          at next (/Users/weber/Projetos/likeme/likeme-back-end/node_modules/express/lib/router/route.js:149:13)
          at /Users/weber/Projetos/likeme/likeme-back-end/node_modules/express-rate-limit/dist/index.cjs:807:7
          at processTicksAndRejections (node:internal/process/task_queues:105:5)
          at /Users/weber/Projetos/likeme/likeme-back-end/node_modules/express-rate-limit/dist/index.cjs:691:5

      158 |       if (error instanceof Error) {
      159 |         console.error('Error message:', error.message);
    > 160 |         console.error('Error stack:', error.stack);
          |                 ^
      161 |       }
      162 |       sendError(res, `Token do Auth0 inv√°lido ou expirado: ${error instanceof Error ? error.message : 'Erro desconhecido'}`, 401);
      163 |       return;

      at login (src/controllers/auth/authController.ts:160:17)

    console.log
      üßπ Limpando 0 IDs de teste...

      at safeTestCleanup (src/utils/test-helpers.ts:139:15)

    console.log
      ‚úÖ Limpeza de dados de teste conclu√≠da

      at safeTestCleanup (src/utils/test-helpers.ts:333:15)

::ffff:127.0.0.1 - - [15/Jan/2026:19:12:46 +0000] "POST /api/auth/register HTTP/1.1" 409 50 "-" "-"
::ffff:127.0.0.1 - - [15/Jan/2026:19:12:46 +0000] "POST /api/auth/register HTTP/1.1" 400 458 "-" "-"
::ffff:127.0.0.1 - - [15/Jan/2026:19:12:46 +0000] "POST /api/auth/login HTTP/1.1" 401 81 "-" "-"
::ffff:127.0.0.1 - - [15/Jan/2026:19:12:46 +0000] "POST /api/auth/login HTTP/1.1" 429 76 "-" "-"
PASS src/controllers/ad/adController.integration.test.ts (96.566 s)
  ‚óè Console

    console.log
      [Config] Social.plus config: {
        hasApiKey: true,
        apiKeyLength: 48,
        hasServerKey: true,
        serverKeyLength: 122,
        region: 'EU',
        baseUrl: 'https://apix.eu.amity.co/api'
      }

      at src/config/index.ts:80:15

    console.log
      [SocialPlus] Client initialized: {
        baseUrl: 'https://apix.eu.amity.co/api',
        region: 'EU',
        hasApiKey: true,
        apiKeyLength: 48,
        hasServerKey: true,
        serverKeyLength: 122,
        tokenTtlMs: 300000
      }

      at new SocialPlusClient (src/clients/socialPlus/socialPlusClient.ts:50:13)

    console.info
      Not all input has been taken into account at your final specification.

      at build (node_modules/swagger-jsdoc/src/specification.js:309:15)

    console.error
      Here's the report: 
      
      
       Error in /Users/weber/Projetos/likeme/likeme-back-end/src/controllers/anamnesis/anamnesisController.ts :
      YAMLSemanticError: Nested mappings are not allowed in compact mappings at line 54, column 22:
      
              description: Prefixo opcional para filtrar perguntas por key (ex: mind_‚Ä¶
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^‚Ä¶
      ,Error in /Users/weber/Projetos/likeme/likeme-back-end/src/controllers/auth/authController.docs.ts :
      YAMLSemanticError: Nested mappings are not allowed in compact mappings at line 4, column 18:
      
          description: Retorna o token JWT do backend para o usu√°rio autenticado. √öti‚Ä¶
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^‚Ä¶
      ,Error in /Users/weber/Projetos/likeme/likeme-back-end/src/controllers/auth/authController.docs.ts :
      YAMLSemanticError: Nested mappings are not allowed in compact mappings at line 4, column 18:
      
          description: Retorna o token JWT do backend para o usu√°rio autenticado. √öti‚Ä¶
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^‚Ä¶
      ,Error in /Users/weber/Projetos/likeme/likeme-back-end/src/controllers/auth/authController.docs.ts :
      YAMLSemanticError: Nested mappings are not allowed in compact mappings at line 4, column 18:
      
          description: Retorna o token JWT do backend para o usu√°rio autenticado. √öti‚Ä¶
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^‚Ä¶
      ,Error in /Users/weber/Projetos/likeme/likeme-back-end/src/controllers/auth/authController.docs.ts :
      YAMLSemanticError: Nested mappings are not allowed in compact mappings at line 4, column 18:
      
          description: Retorna o token JWT do backend para o usu√°rio autenticado. √öti‚Ä¶
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^‚Ä¶

      104 |   }
      105 |
    > 106 |   return swaggerJsdoc(swaggerOptions);
          |                      ^
      107 | };
      108 |
      109 | const swaggerSpec = getSwaggerSpec();

      at build (node_modules/swagger-jsdoc/src/specification.js:313:15)
      at Object.<anonymous>.module.exports (node_modules/swagger-jsdoc/src/lib.js:32:10)
      at getSwaggerSpec (src/server.ts:106:22)
      at Object.<anonymous> (src/server.ts:109:21)
      at Object.<anonymous> (src/controllers/ad/adController.integration.test.ts:2:1)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: 989086a1-527f-491f-a28e-1fedf891d085 na tabela person

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/controllers/ad/adController.integration.test.ts:113:21)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: d4a68da6-79e7-4f1d-913a-9d974abecfc2 na tabela user

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/controllers/ad/adController.integration.test.ts:124:21)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: 7f6aecc7-a7e6-4b03-b035-630b2d533ea6 na tabela advertiser

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/controllers/ad/adController.integration.test.ts:133:21)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: 6ab42474-a4f0-45b5-90aa-0ebb0e6c73d7 na tabela product

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/controllers/ad/adController.integration.test.ts:144:21)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: a3a2727a-efae-4aa1-adda-c6f3bcf2a018 na tabela product

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/controllers/ad/adController.integration.test.ts:164:23)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: 2e1501c8-6514-4b47-8f5d-e89af08b4739 na tabela ad

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/controllers/ad/adController.integration.test.ts:174:23)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: 5b057525-7fdc-4456-9584-375f2761f750 na tabela ad

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/controllers/ad/adController.integration.test.ts:223:23)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: 8a45b575-9ca7-4fa4-88ac-ac8bff114027 na tabela ad

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/controllers/ad/adController.integration.test.ts:247:23)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: fffd33c7-16db-41b2-91fc-9114122c5928 na tabela product

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/controllers/ad/adController.integration.test.ts:273:23)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: b2aa74e1-bad1-4f91-8e20-7e65f8776890 na tabela ad

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/controllers/ad/adController.integration.test.ts:282:23)

    console.error
      Error extracting Amazon product data: Error: Network error
          at Object.<anonymous> (/Users/weber/Projetos/likeme/likeme-back-end/src/controllers/ad/adController.integration.test.ts:285:57)

      168 |     };
      169 |   } catch (error: any) {
    > 170 |     console.error('Error extracting Amazon product data:', error);
          |             ^
      171 |     throw new Error(`Failed to extract product data: ${error.message}`);
      172 |   }
      173 | };

      at extractAmazonProductData (src/utils/amazonScraper.ts:170:13)
      at AdService.enrichProductWithAmazonData (src/services/ad/adService.ts:246:26)
      at AdService.findByIdWithAmazonData (src/services/ad/adService.ts:307:24)
      at getAdById (src/controllers/ad/adController.ts:30:16)

    console.error
      Error fetching external product data: Error: Failed to extract product data: Network error
          at extractAmazonProductData (/Users/weber/Projetos/likeme/likeme-back-end/src/utils/amazonScraper.ts:171:11)
          at AdService.enrichProductWithAmazonData (/Users/weber/Projetos/likeme/likeme-back-end/src/services/ad/adService.ts:246:26)
          at AdService.findByIdWithAmazonData (/Users/weber/Projetos/likeme/likeme-back-end/src/services/ad/adService.ts:307:24)
          at getAdById (/Users/weber/Projetos/likeme/likeme-back-end/src/controllers/ad/adController.ts:30:16)

      257 |       return amazonData;
      258 |     } catch (error: any) {
    > 259 |       console.error('Error fetching external product data:', error);
          |               ^
      260 |       return null;
      261 |     }
      262 |   }

      at AdService.enrichProductWithAmazonData (src/services/ad/adService.ts:259:15)
      at AdService.findByIdWithAmazonData (src/services/ad/adService.ts:307:24)
      at getAdById (src/controllers/ad/adController.ts:30:16)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: 3b7c2b63-1683-4b3c-84b2-5097453538f0 na tabela product

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/controllers/ad/adController.integration.test.ts:315:23)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: 452ebf2f-9a78-421b-b281-3d760dd9b0d2 na tabela ad

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/controllers/ad/adController.integration.test.ts:324:23)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: 05cea8a4-e9a7-45cd-af73-91868b95c43b na tabela product

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/controllers/ad/adController.integration.test.ts:347:23)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: 6a225809-264a-4b88-a68c-3e642f862cc7 na tabela product

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/controllers/ad/adController.integration.test.ts:357:23)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: fe9d02c0-5de2-4dbb-ae93-73ddff3afd85 na tabela product

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/controllers/ad/adController.integration.test.ts:367:23)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: 2d0716f3-ea83-491e-81d1-8f3d6cf27240 na tabela ad

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/controllers/ad/adController.integration.test.ts:377:23)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: bf089204-7f52-4308-a78e-255406139751 na tabela ad

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/controllers/ad/adController.integration.test.ts:386:23)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ed18b61a-ac45-45e2-9b95-13ef63a22c2d na tabela ad

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/controllers/ad/adController.integration.test.ts:395:23)

    console.error
      Error extracting Amazon product data: TypeError: Cannot read properties of undefined (reading 'ok')
          at extractAmazonProductData (/Users/weber/Projetos/likeme/likeme-back-end/src/utils/amazonScraper.ts:19:19)
          at AdService.enrichProductWithAmazonData (/Users/weber/Projetos/likeme/likeme-back-end/src/services/ad/adService.ts:246:26)
          at /Users/weber/Projetos/likeme/likeme-back-end/src/services/ad/adService.ts:334:28
          at async Promise.allSettled (index 6)
          at AdService.enrichAdsWithAmazonData (/Users/weber/Projetos/likeme/likeme-back-end/src/services/ad/adService.ts:328:29)
          at AdService.findAll (/Users/weber/Projetos/likeme/likeme-back-end/src/services/ad/adService.ts:195:25)
          at getAllAds (/Users/weber/Projetos/likeme/likeme-back-end/src/controllers/ad/adController.ts:64:28)

      168 |     };
      169 |   } catch (error: any) {
    > 170 |     console.error('Error extracting Amazon product data:', error);
          |             ^
      171 |     throw new Error(`Failed to extract product data: ${error.message}`);
      172 |   }
      173 | };

      at extractAmazonProductData (src/utils/amazonScraper.ts:170:13)
      at AdService.enrichProductWithAmazonData (src/services/ad/adService.ts:246:26)
      at src/services/ad/adService.ts:334:28
          at async Promise.allSettled (index 6)
      at AdService.enrichAdsWithAmazonData (src/services/ad/adService.ts:328:29)
      at AdService.findAll (src/services/ad/adService.ts:195:25)
      at getAllAds (src/controllers/ad/adController.ts:64:28)

    console.error
      Error fetching external product data: Error: Failed to extract product data: Cannot read properties of undefined (reading 'ok')
          at extractAmazonProductData (/Users/weber/Projetos/likeme/likeme-back-end/src/utils/amazonScraper.ts:171:11)
          at AdService.enrichProductWithAmazonData (/Users/weber/Projetos/likeme/likeme-back-end/src/services/ad/adService.ts:246:26)
          at /Users/weber/Projetos/likeme/likeme-back-end/src/services/ad/adService.ts:334:28
          at async Promise.allSettled (index 6)
          at AdService.enrichAdsWithAmazonData (/Users/weber/Projetos/likeme/likeme-back-end/src/services/ad/adService.ts:328:29)
          at AdService.findAll (/Users/weber/Projetos/likeme/likeme-back-end/src/services/ad/adService.ts:195:25)
          at getAllAds (/Users/weber/Projetos/likeme/likeme-back-end/src/controllers/ad/adController.ts:64:28)

      257 |       return amazonData;
      258 |     } catch (error: any) {
    > 259 |       console.error('Error fetching external product data:', error);
          |               ^
      260 |       return null;
      261 |     }
      262 |   }

      at AdService.enrichProductWithAmazonData (src/services/ad/adService.ts:259:15)
      at src/services/ad/adService.ts:334:28
          at async Promise.allSettled (index 6)
      at AdService.enrichAdsWithAmazonData (src/services/ad/adService.ts:328:29)
      at AdService.findAll (src/services/ad/adService.ts:195:25)
      at getAllAds (src/controllers/ad/adController.ts:64:28)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: 791be28b-3894-4bf9-999e-34ba35435a10 na tabela product

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/controllers/ad/adController.integration.test.ts:426:23)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: 2a0bf159-0a86-4c4a-b824-795d5452a78b na tabela ad

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/controllers/ad/adController.integration.test.ts:435:23)

    console.error
      Error extracting Amazon product data: TypeError: Cannot read properties of undefined (reading 'ok')
          at extractAmazonProductData (/Users/weber/Projetos/likeme/likeme-back-end/src/utils/amazonScraper.ts:19:19)
          at AdService.enrichProductWithAmazonData (/Users/weber/Projetos/likeme/likeme-back-end/src/services/ad/adService.ts:246:26)
          at /Users/weber/Projetos/likeme/likeme-back-end/src/services/ad/adService.ts:334:28
          at async Promise.allSettled (index 1)
          at AdService.enrichAdsWithAmazonData (/Users/weber/Projetos/likeme/likeme-back-end/src/services/ad/adService.ts:328:29)
          at AdService.findAll (/Users/weber/Projetos/likeme/likeme-back-end/src/services/ad/adService.ts:195:25)
          at getAllAds (/Users/weber/Projetos/likeme/likeme-back-end/src/controllers/ad/adController.ts:64:28)

      168 |     };
      169 |   } catch (error: any) {
    > 170 |     console.error('Error extracting Amazon product data:', error);
          |             ^
      171 |     throw new Error(`Failed to extract product data: ${error.message}`);
      172 |   }
      173 | };

      at extractAmazonProductData (src/utils/amazonScraper.ts:170:13)
      at AdService.enrichProductWithAmazonData (src/services/ad/adService.ts:246:26)
      at src/services/ad/adService.ts:334:28
          at async Promise.allSettled (index 1)
      at AdService.enrichAdsWithAmazonData (src/services/ad/adService.ts:328:29)
      at AdService.findAll (src/services/ad/adService.ts:195:25)
      at getAllAds (src/controllers/ad/adController.ts:64:28)

    console.error
      Error extracting Amazon product data: TypeError: Cannot read properties of undefined (reading 'ok')
          at extractAmazonProductData (/Users/weber/Projetos/likeme/likeme-back-end/src/utils/amazonScraper.ts:19:19)
          at AdService.enrichProductWithAmazonData (/Users/weber/Projetos/likeme/likeme-back-end/src/services/ad/adService.ts:246:26)
          at /Users/weber/Projetos/likeme/likeme-back-end/src/services/ad/adService.ts:334:28
          at async Promise.allSettled (index 2)
          at AdService.enrichAdsWithAmazonData (/Users/weber/Projetos/likeme/likeme-back-end/src/services/ad/adService.ts:328:29)
          at AdService.findAll (/Users/weber/Projetos/likeme/likeme-back-end/src/services/ad/adService.ts:195:25)
          at getAllAds (/Users/weber/Projetos/likeme/likeme-back-end/src/controllers/ad/adController.ts:64:28)

      168 |     };
      169 |   } catch (error: any) {
    > 170 |     console.error('Error extracting Amazon product data:', error);
          |             ^
      171 |     throw new Error(`Failed to extract product data: ${error.message}`);
      172 |   }
      173 | };

      at extractAmazonProductData (src/utils/amazonScraper.ts:170:13)
      at AdService.enrichProductWithAmazonData (src/services/ad/adService.ts:246:26)
      at src/services/ad/adService.ts:334:28
          at async Promise.allSettled (index 2)
      at AdService.enrichAdsWithAmazonData (src/services/ad/adService.ts:328:29)
      at AdService.findAll (src/services/ad/adService.ts:195:25)
      at getAllAds (src/controllers/ad/adController.ts:64:28)

    console.error
      Error extracting Amazon product data: TypeError: Cannot read properties of undefined (reading 'ok')
          at extractAmazonProductData (/Users/weber/Projetos/likeme/likeme-back-end/src/utils/amazonScraper.ts:19:19)
          at AdService.enrichProductWithAmazonData (/Users/weber/Projetos/likeme/likeme-back-end/src/services/ad/adService.ts:246:26)
          at /Users/weber/Projetos/likeme/likeme-back-end/src/services/ad/adService.ts:334:28
          at async Promise.allSettled (index 3)
          at AdService.enrichAdsWithAmazonData (/Users/weber/Projetos/likeme/likeme-back-end/src/services/ad/adService.ts:328:29)
          at AdService.findAll (/Users/weber/Projetos/likeme/likeme-back-end/src/services/ad/adService.ts:195:25)
          at getAllAds (/Users/weber/Projetos/likeme/likeme-back-end/src/controllers/ad/adController.ts:64:28)

      168 |     };
      169 |   } catch (error: any) {
    > 170 |     console.error('Error extracting Amazon product data:', error);
          |             ^
      171 |     throw new Error(`Failed to extract product data: ${error.message}`);
      172 |   }
      173 | };

      at extractAmazonProductData (src/utils/amazonScraper.ts:170:13)
      at AdService.enrichProductWithAmazonData (src/services/ad/adService.ts:246:26)
      at src/services/ad/adService.ts:334:28
          at async Promise.allSettled (index 3)
      at AdService.enrichAdsWithAmazonData (src/services/ad/adService.ts:328:29)
      at AdService.findAll (src/services/ad/adService.ts:195:25)
      at getAllAds (src/controllers/ad/adController.ts:64:28)

    console.error
      Error extracting Amazon product data: TypeError: Cannot read properties of undefined (reading 'ok')
          at extractAmazonProductData (/Users/weber/Projetos/likeme/likeme-back-end/src/utils/amazonScraper.ts:19:19)
          at AdService.enrichProductWithAmazonData (/Users/weber/Projetos/likeme/likeme-back-end/src/services/ad/adService.ts:246:26)
          at /Users/weber/Projetos/likeme/likeme-back-end/src/services/ad/adService.ts:334:28
          at async Promise.allSettled (index 4)
          at AdService.enrichAdsWithAmazonData (/Users/weber/Projetos/likeme/likeme-back-end/src/services/ad/adService.ts:328:29)
          at AdService.findAll (/Users/weber/Projetos/likeme/likeme-back-end/src/services/ad/adService.ts:195:25)
          at getAllAds (/Users/weber/Projetos/likeme/likeme-back-end/src/controllers/ad/adController.ts:64:28)

      168 |     };
      169 |   } catch (error: any) {
    > 170 |     console.error('Error extracting Amazon product data:', error);
          |             ^
      171 |     throw new Error(`Failed to extract product data: ${error.message}`);
      172 |   }
      173 | };

      at extractAmazonProductData (src/utils/amazonScraper.ts:170:13)
      at AdService.enrichProductWithAmazonData (src/services/ad/adService.ts:246:26)
      at src/services/ad/adService.ts:334:28
          at async Promise.allSettled (index 4)
      at AdService.enrichAdsWithAmazonData (src/services/ad/adService.ts:328:29)
      at AdService.findAll (src/services/ad/adService.ts:195:25)
      at getAllAds (src/controllers/ad/adController.ts:64:28)

    console.error
      Error extracting Amazon product data: TypeError: Cannot read properties of undefined (reading 'ok')
          at extractAmazonProductData (/Users/weber/Projetos/likeme/likeme-back-end/src/utils/amazonScraper.ts:19:19)
          at AdService.enrichProductWithAmazonData (/Users/weber/Projetos/likeme/likeme-back-end/src/services/ad/adService.ts:246:26)
          at /Users/weber/Projetos/likeme/likeme-back-end/src/services/ad/adService.ts:334:28
          at async Promise.allSettled (index 5)
          at AdService.enrichAdsWithAmazonData (/Users/weber/Projetos/likeme/likeme-back-end/src/services/ad/adService.ts:328:29)
          at AdService.findAll (/Users/weber/Projetos/likeme/likeme-back-end/src/services/ad/adService.ts:195:25)
          at getAllAds (/Users/weber/Projetos/likeme/likeme-back-end/src/controllers/ad/adController.ts:64:28)

      168 |     };
      169 |   } catch (error: any) {
    > 170 |     console.error('Error extracting Amazon product data:', error);
          |             ^
      171 |     throw new Error(`Failed to extract product data: ${error.message}`);
      172 |   }
      173 | };

      at extractAmazonProductData (src/utils/amazonScraper.ts:170:13)
      at AdService.enrichProductWithAmazonData (src/services/ad/adService.ts:246:26)
      at src/services/ad/adService.ts:334:28
          at async Promise.allSettled (index 5)
      at AdService.enrichAdsWithAmazonData (src/services/ad/adService.ts:328:29)
      at AdService.findAll (src/services/ad/adService.ts:195:25)
      at getAllAds (src/controllers/ad/adController.ts:64:28)

    console.error
      Error extracting Amazon product data: TypeError: Cannot read properties of undefined (reading 'ok')
          at extractAmazonProductData (/Users/weber/Projetos/likeme/likeme-back-end/src/utils/amazonScraper.ts:19:19)
          at AdService.enrichProductWithAmazonData (/Users/weber/Projetos/likeme/likeme-back-end/src/services/ad/adService.ts:246:26)
          at /Users/weber/Projetos/likeme/likeme-back-end/src/services/ad/adService.ts:334:28
          at async Promise.allSettled (index 6)
          at AdService.enrichAdsWithAmazonData (/Users/weber/Projetos/likeme/likeme-back-end/src/services/ad/adService.ts:328:29)
          at AdService.findAll (/Users/weber/Projetos/likeme/likeme-back-end/src/services/ad/adService.ts:195:25)
          at getAllAds (/Users/weber/Projetos/likeme/likeme-back-end/src/controllers/ad/adController.ts:64:28)

      168 |     };
      169 |   } catch (error: any) {
    > 170 |     console.error('Error extracting Amazon product data:', error);
          |             ^
      171 |     throw new Error(`Failed to extract product data: ${error.message}`);
      172 |   }
      173 | };

      at extractAmazonProductData (src/utils/amazonScraper.ts:170:13)
      at AdService.enrichProductWithAmazonData (src/services/ad/adService.ts:246:26)
      at src/services/ad/adService.ts:334:28
          at async Promise.allSettled (index 6)
      at AdService.enrichAdsWithAmazonData (src/services/ad/adService.ts:328:29)
      at AdService.findAll (src/services/ad/adService.ts:195:25)
      at getAllAds (src/controllers/ad/adController.ts:64:28)

    console.error
      Error extracting Amazon product data: TypeError: Cannot read properties of undefined (reading 'ok')
          at extractAmazonProductData (/Users/weber/Projetos/likeme/likeme-back-end/src/utils/amazonScraper.ts:19:19)
          at AdService.enrichProductWithAmazonData (/Users/weber/Projetos/likeme/likeme-back-end/src/services/ad/adService.ts:246:26)
          at /Users/weber/Projetos/likeme/likeme-back-end/src/services/ad/adService.ts:334:28
          at async Promise.allSettled (index 8)
          at AdService.enrichAdsWithAmazonData (/Users/weber/Projetos/likeme/likeme-back-end/src/services/ad/adService.ts:328:29)
          at AdService.findAll (/Users/weber/Projetos/likeme/likeme-back-end/src/services/ad/adService.ts:195:25)
          at getAllAds (/Users/weber/Projetos/likeme/likeme-back-end/src/controllers/ad/adController.ts:64:28)

      168 |     };
      169 |   } catch (error: any) {
    > 170 |     console.error('Error extracting Amazon product data:', error);
          |             ^
      171 |     throw new Error(`Failed to extract product data: ${error.message}`);
      172 |   }
      173 | };

      at extractAmazonProductData (src/utils/amazonScraper.ts:170:13)
      at AdService.enrichProductWithAmazonData (src/services/ad/adService.ts:246:26)
      at src/services/ad/adService.ts:334:28
          at async Promise.allSettled (index 8)
      at AdService.enrichAdsWithAmazonData (src/services/ad/adService.ts:328:29)
      at AdService.findAll (src/services/ad/adService.ts:195:25)
      at getAllAds (src/controllers/ad/adController.ts:64:28)

    console.error
      Error extracting Amazon product data: TypeError: Cannot read properties of undefined (reading 'ok')
          at extractAmazonProductData (/Users/weber/Projetos/likeme/likeme-back-end/src/utils/amazonScraper.ts:19:19)
          at AdService.enrichProductWithAmazonData (/Users/weber/Projetos/likeme/likeme-back-end/src/services/ad/adService.ts:246:26)
          at /Users/weber/Projetos/likeme/likeme-back-end/src/services/ad/adService.ts:334:28
          at async Promise.allSettled (index 9)
          at AdService.enrichAdsWithAmazonData (/Users/weber/Projetos/likeme/likeme-back-end/src/services/ad/adService.ts:328:29)
          at AdService.findAll (/Users/weber/Projetos/likeme/likeme-back-end/src/services/ad/adService.ts:195:25)
          at getAllAds (/Users/weber/Projetos/likeme/likeme-back-end/src/controllers/ad/adController.ts:64:28)

      168 |     };
      169 |   } catch (error: any) {
    > 170 |     console.error('Error extracting Amazon product data:', error);
          |             ^
      171 |     throw new Error(`Failed to extract product data: ${error.message}`);
      172 |   }
      173 | };

      at extractAmazonProductData (src/utils/amazonScraper.ts:170:13)
      at AdService.enrichProductWithAmazonData (src/services/ad/adService.ts:246:26)
      at src/services/ad/adService.ts:334:28
          at async Promise.allSettled (index 9)
      at AdService.enrichAdsWithAmazonData (src/services/ad/adService.ts:328:29)
      at AdService.findAll (src/services/ad/adService.ts:195:25)
      at getAllAds (src/controllers/ad/adController.ts:64:28)

    console.error
      Error fetching external product data: Error: Failed to extract product data: Cannot read properties of undefined (reading 'ok')
          at extractAmazonProductData (/Users/weber/Projetos/likeme/likeme-back-end/src/utils/amazonScraper.ts:171:11)
          at AdService.enrichProductWithAmazonData (/Users/weber/Projetos/likeme/likeme-back-end/src/services/ad/adService.ts:246:26)
          at /Users/weber/Projetos/likeme/likeme-back-end/src/services/ad/adService.ts:334:28
          at async Promise.allSettled (index 1)
          at AdService.enrichAdsWithAmazonData (/Users/weber/Projetos/likeme/likeme-back-end/src/services/ad/adService.ts:328:29)
          at AdService.findAll (/Users/weber/Projetos/likeme/likeme-back-end/src/services/ad/adService.ts:195:25)
          at getAllAds (/Users/weber/Projetos/likeme/likeme-back-end/src/controllers/ad/adController.ts:64:28)

      257 |       return amazonData;
      258 |     } catch (error: any) {
    > 259 |       console.error('Error fetching external product data:', error);
          |               ^
      260 |       return null;
      261 |     }
      262 |   }

      at AdService.enrichProductWithAmazonData (src/services/ad/adService.ts:259:15)
      at src/services/ad/adService.ts:334:28
          at async Promise.allSettled (index 1)
      at AdService.enrichAdsWithAmazonData (src/services/ad/adService.ts:328:29)
      at AdService.findAll (src/services/ad/adService.ts:195:25)
      at getAllAds (src/controllers/ad/adController.ts:64:28)

    console.error
      Error fetching external product data: Error: Failed to extract product data: Cannot read properties of undefined (reading 'ok')
          at extractAmazonProductData (/Users/weber/Projetos/likeme/likeme-back-end/src/utils/amazonScraper.ts:171:11)
          at AdService.enrichProductWithAmazonData (/Users/weber/Projetos/likeme/likeme-back-end/src/services/ad/adService.ts:246:26)
          at /Users/weber/Projetos/likeme/likeme-back-end/src/services/ad/adService.ts:334:28
          at async Promise.allSettled (index 2)
          at AdService.enrichAdsWithAmazonData (/Users/weber/Projetos/likeme/likeme-back-end/src/services/ad/adService.ts:328:29)
          at AdService.findAll (/Users/weber/Projetos/likeme/likeme-back-end/src/services/ad/adService.ts:195:25)
          at getAllAds (/Users/weber/Projetos/likeme/likeme-back-end/src/controllers/ad/adController.ts:64:28)

      257 |       return amazonData;
      258 |     } catch (error: any) {
    > 259 |       console.error('Error fetching external product data:', error);
          |               ^
      260 |       return null;
      261 |     }
      262 |   }

      at AdService.enrichProductWithAmazonData (src/services/ad/adService.ts:259:15)
      at src/services/ad/adService.ts:334:28
          at async Promise.allSettled (index 2)
      at AdService.enrichAdsWithAmazonData (src/services/ad/adService.ts:328:29)
      at AdService.findAll (src/services/ad/adService.ts:195:25)
      at getAllAds (src/controllers/ad/adController.ts:64:28)

    console.error
      Error fetching external product data: Error: Failed to extract product data: Cannot read properties of undefined (reading 'ok')
          at extractAmazonProductData (/Users/weber/Projetos/likeme/likeme-back-end/src/utils/amazonScraper.ts:171:11)
          at AdService.enrichProductWithAmazonData (/Users/weber/Projetos/likeme/likeme-back-end/src/services/ad/adService.ts:246:26)
          at /Users/weber/Projetos/likeme/likeme-back-end/src/services/ad/adService.ts:334:28
          at async Promise.allSettled (index 3)
          at AdService.enrichAdsWithAmazonData (/Users/weber/Projetos/likeme/likeme-back-end/src/services/ad/adService.ts:328:29)
          at AdService.findAll (/Users/weber/Projetos/likeme/likeme-back-end/src/services/ad/adService.ts:195:25)
          at getAllAds (/Users/weber/Projetos/likeme/likeme-back-end/src/controllers/ad/adController.ts:64:28)

      257 |       return amazonData;
      258 |     } catch (error: any) {
    > 259 |       console.error('Error fetching external product data:', error);
          |               ^
      260 |       return null;
      261 |     }
      262 |   }

      at AdService.enrichProductWithAmazonData (src/services/ad/adService.ts:259:15)
      at src/services/ad/adService.ts:334:28
          at async Promise.allSettled (index 3)
      at AdService.enrichAdsWithAmazonData (src/services/ad/adService.ts:328:29)
      at AdService.findAll (src/services/ad/adService.ts:195:25)
      at getAllAds (src/controllers/ad/adController.ts:64:28)

    console.error
      Error fetching external product data: Error: Failed to extract product data: Cannot read properties of undefined (reading 'ok')
          at extractAmazonProductData (/Users/weber/Projetos/likeme/likeme-back-end/src/utils/amazonScraper.ts:171:11)
          at AdService.enrichProductWithAmazonData (/Users/weber/Projetos/likeme/likeme-back-end/src/services/ad/adService.ts:246:26)
          at /Users/weber/Projetos/likeme/likeme-back-end/src/services/ad/adService.ts:334:28
          at async Promise.allSettled (index 4)
          at AdService.enrichAdsWithAmazonData (/Users/weber/Projetos/likeme/likeme-back-end/src/services/ad/adService.ts:328:29)
          at AdService.findAll (/Users/weber/Projetos/likeme/likeme-back-end/src/services/ad/adService.ts:195:25)
          at getAllAds (/Users/weber/Projetos/likeme/likeme-back-end/src/controllers/ad/adController.ts:64:28)

      257 |       return amazonData;
      258 |     } catch (error: any) {
    > 259 |       console.error('Error fetching external product data:', error);
          |               ^
      260 |       return null;
      261 |     }
      262 |   }

      at AdService.enrichProductWithAmazonData (src/services/ad/adService.ts:259:15)
      at src/services/ad/adService.ts:334:28
          at async Promise.allSettled (index 4)
      at AdService.enrichAdsWithAmazonData (src/services/ad/adService.ts:328:29)
      at AdService.findAll (src/services/ad/adService.ts:195:25)
      at getAllAds (src/controllers/ad/adController.ts:64:28)

    console.error
      Error fetching external product data: Error: Failed to extract product data: Cannot read properties of undefined (reading 'ok')
          at extractAmazonProductData (/Users/weber/Projetos/likeme/likeme-back-end/src/utils/amazonScraper.ts:171:11)
          at AdService.enrichProductWithAmazonData (/Users/weber/Projetos/likeme/likeme-back-end/src/services/ad/adService.ts:246:26)
          at /Users/weber/Projetos/likeme/likeme-back-end/src/services/ad/adService.ts:334:28
          at async Promise.allSettled (index 5)
          at AdService.enrichAdsWithAmazonData (/Users/weber/Projetos/likeme/likeme-back-end/src/services/ad/adService.ts:328:29)
          at AdService.findAll (/Users/weber/Projetos/likeme/likeme-back-end/src/services/ad/adService.ts:195:25)
          at getAllAds (/Users/weber/Projetos/likeme/likeme-back-end/src/controllers/ad/adController.ts:64:28)

      257 |       return amazonData;
      258 |     } catch (error: any) {
    > 259 |       console.error('Error fetching external product data:', error);
          |               ^
      260 |       return null;
      261 |     }
      262 |   }

      at AdService.enrichProductWithAmazonData (src/services/ad/adService.ts:259:15)
      at src/services/ad/adService.ts:334:28
          at async Promise.allSettled (index 5)
      at AdService.enrichAdsWithAmazonData (src/services/ad/adService.ts:328:29)
      at AdService.findAll (src/services/ad/adService.ts:195:25)
      at getAllAds (src/controllers/ad/adController.ts:64:28)

    console.error
      Error fetching external product data: Error: Failed to extract product data: Cannot read properties of undefined (reading 'ok')
          at extractAmazonProductData (/Users/weber/Projetos/likeme/likeme-back-end/src/utils/amazonScraper.ts:171:11)
          at AdService.enrichProductWithAmazonData (/Users/weber/Projetos/likeme/likeme-back-end/src/services/ad/adService.ts:246:26)
          at /Users/weber/Projetos/likeme/likeme-back-end/src/services/ad/adService.ts:334:28
          at async Promise.allSettled (index 6)
          at AdService.enrichAdsWithAmazonData (/Users/weber/Projetos/likeme/likeme-back-end/src/services/ad/adService.ts:328:29)
          at AdService.findAll (/Users/weber/Projetos/likeme/likeme-back-end/src/services/ad/adService.ts:195:25)
          at getAllAds (/Users/weber/Projetos/likeme/likeme-back-end/src/controllers/ad/adController.ts:64:28)

      257 |       return amazonData;
      258 |     } catch (error: any) {
    > 259 |       console.error('Error fetching external product data:', error);
          |               ^
      260 |       return null;
      261 |     }
      262 |   }

      at AdService.enrichProductWithAmazonData (src/services/ad/adService.ts:259:15)
      at src/services/ad/adService.ts:334:28
          at async Promise.allSettled (index 6)
      at AdService.enrichAdsWithAmazonData (src/services/ad/adService.ts:328:29)
      at AdService.findAll (src/services/ad/adService.ts:195:25)
      at getAllAds (src/controllers/ad/adController.ts:64:28)

    console.error
      Error fetching external product data: Error: Failed to extract product data: Cannot read properties of undefined (reading 'ok')
          at extractAmazonProductData (/Users/weber/Projetos/likeme/likeme-back-end/src/utils/amazonScraper.ts:171:11)
          at AdService.enrichProductWithAmazonData (/Users/weber/Projetos/likeme/likeme-back-end/src/services/ad/adService.ts:246:26)
          at /Users/weber/Projetos/likeme/likeme-back-end/src/services/ad/adService.ts:334:28
          at async Promise.allSettled (index 8)
          at AdService.enrichAdsWithAmazonData (/Users/weber/Projetos/likeme/likeme-back-end/src/services/ad/adService.ts:328:29)
          at AdService.findAll (/Users/weber/Projetos/likeme/likeme-back-end/src/services/ad/adService.ts:195:25)
          at getAllAds (/Users/weber/Projetos/likeme/likeme-back-end/src/controllers/ad/adController.ts:64:28)

      257 |       return amazonData;
      258 |     } catch (error: any) {
    > 259 |       console.error('Error fetching external product data:', error);
          |               ^
      260 |       return null;
      261 |     }
      262 |   }

      at AdService.enrichProductWithAmazonData (src/services/ad/adService.ts:259:15)
      at src/services/ad/adService.ts:334:28
          at async Promise.allSettled (index 8)
      at AdService.enrichAdsWithAmazonData (src/services/ad/adService.ts:328:29)
      at AdService.findAll (src/services/ad/adService.ts:195:25)
      at getAllAds (src/controllers/ad/adController.ts:64:28)

    console.error
      Error fetching external product data: Error: Failed to extract product data: Cannot read properties of undefined (reading 'ok')
          at extractAmazonProductData (/Users/weber/Projetos/likeme/likeme-back-end/src/utils/amazonScraper.ts:171:11)
          at AdService.enrichProductWithAmazonData (/Users/weber/Projetos/likeme/likeme-back-end/src/services/ad/adService.ts:246:26)
          at /Users/weber/Projetos/likeme/likeme-back-end/src/services/ad/adService.ts:334:28
          at async Promise.allSettled (index 9)
          at AdService.enrichAdsWithAmazonData (/Users/weber/Projetos/likeme/likeme-back-end/src/services/ad/adService.ts:328:29)
          at AdService.findAll (/Users/weber/Projetos/likeme/likeme-back-end/src/services/ad/adService.ts:195:25)
          at getAllAds (/Users/weber/Projetos/likeme/likeme-back-end/src/controllers/ad/adController.ts:64:28)

      257 |       return amazonData;
      258 |     } catch (error: any) {
    > 259 |       console.error('Error fetching external product data:', error);
          |               ^
      260 |       return null;
      261 |     }
      262 |   }

      at AdService.enrichProductWithAmazonData (src/services/ad/adService.ts:259:15)
      at src/services/ad/adService.ts:334:28
          at async Promise.allSettled (index 9)
      at AdService.enrichAdsWithAmazonData (src/services/ad/adService.ts:328:29)
      at AdService.findAll (src/services/ad/adService.ts:195:25)
      at getAllAds (src/controllers/ad/adController.ts:64:28)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: 5a5e268d-d196-45cb-88d1-3a5a2caeb2c3 na tabela ad

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/controllers/ad/adController.integration.test.ts:482:25)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: 24603c00-cf26-4106-9ad5-70ecdfbe2eb9 na tabela product

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/controllers/ad/adController.integration.test.ts:485:25)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: 55d29e13-2905-43b9-9258-7dc784fef866 na tabela ad

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/controllers/ad/adController.integration.test.ts:509:25)

    console.error
      Validation error: [
        {
          message: '"value" must contain at least one of [productId, product]',
          path: [],
          type: 'object.missing',
          context: {
            peers: [Array],
            peersWithLabels: [Array],
            label: 'value',
            value: [Object]
          }
        }
      ]

      10 |     
      11 |     if (error) {
    > 12 |       console.error('Validation error:', error.details);
         |               ^
      13 |       console.error('Request body:', JSON.stringify(req.body, null, 2));
      14 |       
      15 |       const errorMessages = error.details.map(detail => detail.message);

      at src/middleware/validation.ts:12:15
      at Layer.handle [as handle_request] (node_modules/express/lib/router/layer.js:95:5)
      at next (node_modules/express/lib/router/route.js:149:13)
      at node_modules/express-rate-limit/dist/index.cjs:807:7
      at node_modules/express-rate-limit/dist/index.cjs:691:5

    console.error
      Request body: {
        "advertiserId": "7f6aecc7-a7e6-4b03-b035-630b2d533ea6"
      }

      11 |     if (error) {
      12 |       console.error('Validation error:', error.details);
    > 13 |       console.error('Request body:', JSON.stringify(req.body, null, 2));
         |               ^
      14 |       
      15 |       const errorMessages = error.details.map(detail => detail.message);
      16 |       const errorMessage = errorMessages.length === 1

      at src/middleware/validation.ts:13:15
      at Layer.handle [as handle_request] (node_modules/express/lib/router/layer.js:95:5)
      at next (node_modules/express/lib/router/route.js:149:13)
      at node_modules/express-rate-limit/dist/index.cjs:807:7
      at node_modules/express-rate-limit/dist/index.cjs:691:5

    console.log
      üßπ Limpando 2 IDs de teste...

      at safeTestCleanup (src/utils/test-helpers.ts:139:15)

    console.log
      ‚úÖ Limpeza de dados de teste conclu√≠da

      at safeTestCleanup (src/utils/test-helpers.ts:333:15)

::ffff:127.0.0.1 - - [15/Jan/2026:19:12:51 +0000] "GET /api/activities/f76ad537-c42d-4c89-9542-e5bcf7a32664-system-test HTTP/1.1" 200 - "-" "-"
PASS src/controllers/anamnesis/anamnesisController.integration.test.ts (102.585 s)
  ‚óè Console

    console.log
      [Config] Social.plus config: {
        hasApiKey: true,
        apiKeyLength: 48,
        hasServerKey: true,
        serverKeyLength: 122,
        region: 'EU',
        baseUrl: 'https://apix.eu.amity.co/api'
      }

      at src/config/index.ts:80:15

    console.log
      [SocialPlus] Client initialized: {
        baseUrl: 'https://apix.eu.amity.co/api',
        region: 'EU',
        hasApiKey: true,
        apiKeyLength: 48,
        hasServerKey: true,
        serverKeyLength: 122,
        tokenTtlMs: 300000
      }

      at new SocialPlusClient (src/clients/socialPlus/socialPlusClient.ts:50:13)

    console.info
      Not all input has been taken into account at your final specification.

      at build (node_modules/swagger-jsdoc/src/specification.js:309:15)

    console.error
      Here's the report: 
      
      
       Error in /Users/weber/Projetos/likeme/likeme-back-end/src/controllers/anamnesis/anamnesisController.ts :
      YAMLSemanticError: Nested mappings are not allowed in compact mappings at line 54, column 22:
      
              description: Prefixo opcional para filtrar perguntas por key (ex: mind_‚Ä¶
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^‚Ä¶
      ,Error in /Users/weber/Projetos/likeme/likeme-back-end/src/controllers/auth/authController.docs.ts :
      YAMLSemanticError: Nested mappings are not allowed in compact mappings at line 4, column 18:
      
          description: Retorna o token JWT do backend para o usu√°rio autenticado. √öti‚Ä¶
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^‚Ä¶
      ,Error in /Users/weber/Projetos/likeme/likeme-back-end/src/controllers/auth/authController.docs.ts :
      YAMLSemanticError: Nested mappings are not allowed in compact mappings at line 4, column 18:
      
          description: Retorna o token JWT do backend para o usu√°rio autenticado. √öti‚Ä¶
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^‚Ä¶
      ,Error in /Users/weber/Projetos/likeme/likeme-back-end/src/controllers/auth/authController.docs.ts :
      YAMLSemanticError: Nested mappings are not allowed in compact mappings at line 4, column 18:
      
          description: Retorna o token JWT do backend para o usu√°rio autenticado. √öti‚Ä¶
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^‚Ä¶
      ,Error in /Users/weber/Projetos/likeme/likeme-back-end/src/controllers/auth/authController.docs.ts :
      YAMLSemanticError: Nested mappings are not allowed in compact mappings at line 4, column 18:
      
          description: Retorna o token JWT do backend para o usu√°rio autenticado. √öti‚Ä¶
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^‚Ä¶

      104 |   }
      105 |
    > 106 |   return swaggerJsdoc(swaggerOptions);
          |                      ^
      107 | };
      108 |
      109 | const swaggerSpec = getSwaggerSpec();

      at build (node_modules/swagger-jsdoc/src/specification.js:313:15)
      at Object.<anonymous>.module.exports (node_modules/swagger-jsdoc/src/lib.js:32:10)
      at getSwaggerSpec (src/server.ts:106:22)
      at Object.<anonymous> (src/server.ts:109:21)
      at Object.<anonymous> (src/controllers/anamnesis/anamnesisController.integration.test.ts:2:1)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: d5b06606-1ea0-40b5-ad00-f623a5ebfc70 na tabela anamnesisUserAnswer

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/controllers/anamnesis/anamnesisController.integration.test.ts:322:25)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: f5c1c715-39b6-4614-9814-e98aea85b455 na tabela anamnesisUserAnswer

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/controllers/anamnesis/anamnesisController.integration.test.ts:367:25)

    console.log
      üßπ Limpando 39 IDs de teste...

      at safeTestCleanup (src/utils/test-helpers.ts:139:15)

    console.log
      ‚úÖ Limpeza de dados de teste conclu√≠da

      at safeTestCleanup (src/utils/test-helpers.ts:333:15)

::ffff:127.0.0.1 - - [15/Jan/2026:19:12:53 +0000] "GET /api/activities/non-existent-id HTTP/1.1" 404 48 "-" "-"
::ffff:127.0.0.1 - - [15/Jan/2026:19:13:01 +0000] "GET /api/activities/bdf1afa6-05cc-47ed-9f56-6a2fee7b14f9-system-test HTTP/1.1" 403 66 "-" "-"
PASS src/services/order/orderService.split.test.ts (122.203 s)
  ‚óè Console

    console.log
      [Config] Social.plus config: {
        hasApiKey: true,
        apiKeyLength: 48,
        hasServerKey: true,
        serverKeyLength: 122,
        region: 'EU',
        baseUrl: 'https://apix.eu.amity.co/api'
      }

      at src/config/index.ts:80:15

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: 4cb95805-a721-4b8b-9518-5ae13f9670a2 na tabela person

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/services/order/orderService.split.test.ts:47:21)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: d1fcbf08-70b9-4b0f-8dad-5ef4eec72993 na tabela user

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/services/order/orderService.split.test.ts:57:21)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: 7ed36e57-507a-4961-985b-d4cdb7bd8b03 na tabela product

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/services/order/orderService.split.test.ts:87:21)

    console.log
      [OrderService] ‚úÖ CPF do cardData ser√° usado: 111***35

      at OrderService.processPaymentForOrder (src/services/order/orderService.ts:284:17)

    console.log
      [OrderService] ‚úÖ Telefone do cardData ser√° usado: 11****9999

      at OrderService.processPaymentForOrder (src/services/order/orderService.ts:317:17)

    console.log
      [OrderService] Status recebido da Pagarme: captured

      at OrderService.processPaymentForOrder (src/services/order/orderService.ts:393:13)

    console.log
      [OrderService] ‚úÖ Pagamento aprovado, status: paid (transa√ß√£o: captured )

      at OrderService.processPaymentForOrder (src/services/order/orderService.ts:400:15)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: a2b89320-146b-4c59-ba58-6161415e14f6 na tabela order

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/services/order/orderService.split.test.ts:149:23)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: d177e19f-8fd4-4b0f-86b1-06122952b33d na tabela person

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/services/order/orderService.split.test.ts:47:21)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: b364e7b6-906f-4707-bfd0-6bd62e2302c0 na tabela user

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/services/order/orderService.split.test.ts:57:21)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: 7827ac98-0b9b-4f54-b36c-841aff2be793 na tabela product

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/services/order/orderService.split.test.ts:87:21)

    console.log
      [OrderService] ‚úÖ CPF do cardData ser√° usado: 111***35

      at OrderService.processPaymentForOrder (src/services/order/orderService.ts:284:17)

    console.log
      [OrderService] ‚úÖ Telefone do cardData ser√° usado: 11****9999

      at OrderService.processPaymentForOrder (src/services/order/orderService.ts:317:17)

    console.log
      [OrderService] Status recebido da Pagarme: captured

      at OrderService.processPaymentForOrder (src/services/order/orderService.ts:393:13)

    console.log
      [OrderService] ‚úÖ Pagamento aprovado, status: paid (transa√ß√£o: captured )

      at OrderService.processPaymentForOrder (src/services/order/orderService.ts:400:15)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: 03830623-add6-4f06-98be-364cddedfa34 na tabela order

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/services/order/orderService.split.test.ts:226:23)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: 45adc18f-be94-4812-9b95-9d1ffaa9e3a4 na tabela person

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/services/order/orderService.split.test.ts:47:21)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: da7bf24e-1aac-4511-ae72-e1b8a346c70d na tabela user

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/services/order/orderService.split.test.ts:57:21)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: c7249d7d-9629-4328-b040-e33ae305f48a na tabela product

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/services/order/orderService.split.test.ts:87:21)

    console.log
      [OrderService] ‚úÖ CPF do cardData ser√° usado: 111***35

      at OrderService.processPaymentForOrder (src/services/order/orderService.ts:284:17)

    console.log
      [OrderService] ‚úÖ Telefone do cardData ser√° usado: 11****9999

      at OrderService.processPaymentForOrder (src/services/order/orderService.ts:317:17)

    console.log
      [OrderService] Status recebido da Pagarme: captured

      at OrderService.processPaymentForOrder (src/services/order/orderService.ts:393:13)

    console.log
      [OrderService] ‚úÖ Pagamento aprovado, status: paid (transa√ß√£o: captured )

      at OrderService.processPaymentForOrder (src/services/order/orderService.ts:400:15)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: 84489d80-5eae-4653-b836-16d778faec8d na tabela person

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/services/order/orderService.split.test.ts:47:21)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: f16f9ca4-f8dd-4064-bf08-36043a187dcc na tabela user

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/services/order/orderService.split.test.ts:57:21)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: 564baf03-915f-4227-b6f2-d8100b875355 na tabela product

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/services/order/orderService.split.test.ts:87:21)

    console.log
      [OrderService] ‚úÖ CPF do cardData ser√° usado: 111***35

      at OrderService.processPaymentForOrder (src/services/order/orderService.ts:284:17)

    console.log
      [OrderService] ‚úÖ Telefone do cardData ser√° usado: 11****9999

      at OrderService.processPaymentForOrder (src/services/order/orderService.ts:317:17)

    console.log
      [OrderService] Status recebido da Pagarme: captured

      at OrderService.processPaymentForOrder (src/services/order/orderService.ts:393:13)

    console.log
      [OrderService] ‚úÖ Pagamento aprovado, status: paid (transa√ß√£o: captured )

      at OrderService.processPaymentForOrder (src/services/order/orderService.ts:400:15)

    console.log
      üßπ Limpando 0 IDs de teste...

      at safeTestCleanup (src/utils/test-helpers.ts:139:15)

    console.log
      ‚úÖ Limpeza de dados de teste conclu√≠da

      at safeTestCleanup (src/utils/test-helpers.ts:333:15)

::ffff:127.0.0.1 - - [15/Jan/2026:19:13:18 +0000] "PUT /api/activities/52539ba9-50d3-46e2-922d-bc6e5027a9c5-system-test HTTP/1.1" 200 - "-" "-"
PASS src/services/anamnesis/__tests__/anamnesisService.test.ts (130.507 s)
  ‚óè Console

    console.log
      [Config] Social.plus config: {
        hasApiKey: true,
        apiKeyLength: 48,
        hasServerKey: true,
        serverKeyLength: 122,
        region: 'EU',
        baseUrl: 'https://apix.eu.amity.co/api'
      }

      at src/config/index.ts:80:15

    console.log
      üßπ Limpando 28 IDs de teste...

      at safeTestCleanup (src/utils/test-helpers.ts:139:15)

    console.log
      ‚úÖ Limpeza de dados de teste conclu√≠da

      at safeTestCleanup (src/utils/test-helpers.ts:333:15)

::ffff:127.0.0.1 - - [15/Jan/2026:19:13:22 +0000] "PUT /api/activities/non-existent-id HTTP/1.1" 404 48 "-" "-"
::ffff:127.0.0.1 - - [15/Jan/2026:19:13:42 +0000] "DELETE /api/activities/b9c4cd18-ba0f-4a79-b0d1-5f30f8d481b7-system-test HTTP/1.1" 200 70 "-" "-"
::ffff:127.0.0.1 - - [15/Jan/2026:19:13:45 +0000] "DELETE /api/activities/non-existent-id HTTP/1.1" 404 48 "-" "-"
PASS src/controllers/activity/activityController.test.ts (85.53 s)
  ‚óè Console

    console.log
      [Config] Social.plus config: {
        hasApiKey: true,
        apiKeyLength: 48,
        hasServerKey: true,
        serverKeyLength: 122,
        region: 'EU',
        baseUrl: 'https://apix.eu.amity.co/api'
      }

      at src/config/index.ts:80:15

    console.log
      [SocialPlus] Client initialized: {
        baseUrl: 'https://apix.eu.amity.co/api',
        region: 'EU',
        hasApiKey: true,
        apiKeyLength: 48,
        hasServerKey: true,
        serverKeyLength: 122,
        tokenTtlMs: 300000
      }

      at new SocialPlusClient (src/clients/socialPlus/socialPlusClient.ts:50:13)

    console.info
      Not all input has been taken into account at your final specification.

      at build (node_modules/swagger-jsdoc/src/specification.js:309:15)

    console.error
      Here's the report: 
      
      
       Error in /Users/weber/Projetos/likeme/likeme-back-end/src/controllers/anamnesis/anamnesisController.ts :
      YAMLSemanticError: Nested mappings are not allowed in compact mappings at line 54, column 22:
      
              description: Prefixo opcional para filtrar perguntas por key (ex: mind_‚Ä¶
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^‚Ä¶
      ,Error in /Users/weber/Projetos/likeme/likeme-back-end/src/controllers/auth/authController.docs.ts :
      YAMLSemanticError: Nested mappings are not allowed in compact mappings at line 4, column 18:
      
          description: Retorna o token JWT do backend para o usu√°rio autenticado. √öti‚Ä¶
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^‚Ä¶
      ,Error in /Users/weber/Projetos/likeme/likeme-back-end/src/controllers/auth/authController.docs.ts :
      YAMLSemanticError: Nested mappings are not allowed in compact mappings at line 4, column 18:
      
          description: Retorna o token JWT do backend para o usu√°rio autenticado. √öti‚Ä¶
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^‚Ä¶
      ,Error in /Users/weber/Projetos/likeme/likeme-back-end/src/controllers/auth/authController.docs.ts :
      YAMLSemanticError: Nested mappings are not allowed in compact mappings at line 4, column 18:
      
          description: Retorna o token JWT do backend para o usu√°rio autenticado. √öti‚Ä¶
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^‚Ä¶
      ,Error in /Users/weber/Projetos/likeme/likeme-back-end/src/controllers/auth/authController.docs.ts :
      YAMLSemanticError: Nested mappings are not allowed in compact mappings at line 4, column 18:
      
          description: Retorna o token JWT do backend para o usu√°rio autenticado. √öti‚Ä¶
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^‚Ä¶

      104 |   }
      105 |
    > 106 |   return swaggerJsdoc(swaggerOptions);
          |                      ^
      107 | };
      108 |
      109 | const swaggerSpec = getSwaggerSpec();

      at build (node_modules/swagger-jsdoc/src/specification.js:313:15)
      at Object.<anonymous>.module.exports (node_modules/swagger-jsdoc/src/lib.js:32:10)
      at getSwaggerSpec (src/server.ts:106:22)
      at Object.<anonymous> (src/server.ts:109:21)
      at Object.<anonymous> (src/controllers/activity/activityController.test.ts:2:1)

    console.error
      Validation error: [
        {
          message: '"type" is required',
          path: [ 'type' ],
          type: 'any.required',
          context: { label: 'type', key: 'type' }
        },
        {
          message: '"startDate" is required',
          path: [ 'startDate' ],
          type: 'any.required',
          context: { label: 'startDate', key: 'startDate' }
        }
      ]

      10 |     
      11 |     if (error) {
    > 12 |       console.error('Validation error:', error.details);
         |               ^
      13 |       console.error('Request body:', JSON.stringify(req.body, null, 2));
      14 |       
      15 |       const errorMessages = error.details.map(detail => detail.message);

      at src/middleware/validation.ts:12:15
      at Layer.handle [as handle_request] (node_modules/express/lib/router/layer.js:95:5)
      at next (node_modules/express/lib/router/route.js:149:13)
      at node_modules/express-rate-limit/dist/index.cjs:807:7
      at node_modules/express-rate-limit/dist/index.cjs:691:5

    console.error
      Request body: {}

      11 |     if (error) {
      12 |       console.error('Validation error:', error.details);
    > 13 |       console.error('Request body:', JSON.stringify(req.body, null, 2));
         |               ^
      14 |       
      15 |       const errorMessages = error.details.map(detail => detail.message);
      16 |       const errorMessage = errorMessages.length === 1

      at src/middleware/validation.ts:13:15
      at Layer.handle [as handle_request] (node_modules/express/lib/router/layer.js:95:5)
      at next (node_modules/express/lib/router/route.js:149:13)
      at node_modules/express-rate-limit/dist/index.cjs:807:7
      at node_modules/express-rate-limit/dist/index.cjs:691:5

    console.log
      üßπ Limpando 12 IDs de teste...

      at safeTestCleanup (src/utils/test-helpers.ts:139:15)

    console.log
      ‚úÖ Limpeza de dados de teste conclu√≠da

      at safeTestCleanup (src/utils/test-helpers.ts:333:15)

PASS src/services/ad/adService.test.ts (170.711 s)
  ‚óè Console

    console.log
      [Config] Social.plus config: {
        hasApiKey: true,
        apiKeyLength: 48,
        hasServerKey: true,
        serverKeyLength: 122,
        region: 'EU',
        baseUrl: 'https://apix.eu.amity.co/api'
      }

      at src/config/index.ts:80:15

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: c5ee7bac-babc-4d11-add8-5f18ec48e8c8 na tabela person

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/services/ad/adService.test.ts:28:21)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: e982acd9-19d0-4256-bc54-7c72330eb619 na tabela user

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/services/ad/adService.test.ts:38:21)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: 4426f4f9-00df-42c0-af92-3e5784ff5345 na tabela advertiser

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/services/ad/adService.test.ts:43:21)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: 9345db01-d78f-4b97-a6f8-54cb0f4781ea na tabela product

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/services/ad/adService.test.ts:54:21)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: fc860a0a-cd9b-42d7-a4b9-e2c5b4d0b47a na tabela ad

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/services/ad/adService.test.ts:63:21)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: 046ffe5f-12bb-4f2d-8a01-37db27e4f7fb na tabela ad

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/services/ad/adService.test.ts:81:25)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: 89b08756-6be6-4048-9a02-7e2de482c7ba na tabela person

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/services/ad/adService.test.ts:28:21)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: cdf73ccd-4f18-4e9c-b5d7-fdfcd0c69e37 na tabela user

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/services/ad/adService.test.ts:38:21)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: 0288d815-c6ce-4243-ae22-769b7153ddc5 na tabela advertiser

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/services/ad/adService.test.ts:43:21)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: 76da6b6e-6fc8-46ef-9167-2e2d2763232a na tabela product

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/services/ad/adService.test.ts:54:21)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: f4995713-21cb-4c5b-bea9-ccb52bfbb305 na tabela ad

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/services/ad/adService.test.ts:63:21)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: 285c6bbe-9fcb-4270-8b01-2abeef0eedaa na tabela ad

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/services/ad/adService.test.ts:105:25)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: f16a1ae0-dc63-4960-8845-c340a6d686fa na tabela product

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/services/ad/adService.test.ts:108:25)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: c8898a77-4498-40d7-8a53-0bde786a0edd na tabela person

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/services/ad/adService.test.ts:28:21)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: e270ba75-aa95-49db-b235-96dd66c93fe3 na tabela user

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/services/ad/adService.test.ts:38:21)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: bbbbcd83-bad3-4b01-bd79-31091c5305ef na tabela advertiser

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/services/ad/adService.test.ts:43:21)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: 865c8019-d1a9-4762-b445-db0d6178e290 na tabela product

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/services/ad/adService.test.ts:54:21)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: b143a14e-e7c6-4668-b930-3f004c1fe8b3 na tabela ad

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/services/ad/adService.test.ts:63:21)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: d74170de-ca2c-4fc3-ae25-80d423345346 na tabela person

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/services/ad/adService.test.ts:28:21)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: 40d24a7a-9420-46f5-91e7-554dd5dda010 na tabela user

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/services/ad/adService.test.ts:38:21)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: 08c739a5-b689-4d14-9fd3-9aabfe483e75 na tabela advertiser

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/services/ad/adService.test.ts:43:21)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: c0dc63eb-28a4-42d4-9e90-e5e820852654 na tabela product

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/services/ad/adService.test.ts:54:21)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: 6e883961-912b-40d8-ae26-cc86e9cfcbab na tabela ad

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/services/ad/adService.test.ts:63:21)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: 44f8a031-6b3b-49f6-87d7-b1475b818c5e na tabela person

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/services/ad/adService.test.ts:28:21)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: b924a601-23a9-4b0d-9441-6118a1cf796a na tabela user

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/services/ad/adService.test.ts:38:21)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: 05077933-4a3c-47a7-8fdb-7afe6ecfba3c na tabela advertiser

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/services/ad/adService.test.ts:43:21)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: b75c3faa-58ef-4dba-a40a-4594aae847a9 na tabela product

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/services/ad/adService.test.ts:54:21)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: b106bd02-0b43-44f8-ad81-a4762efc90c7 na tabela ad

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/services/ad/adService.test.ts:63:21)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: 2b99508e-0d25-4072-8d24-61cebce4147c na tabela person

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/services/ad/adService.test.ts:28:21)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: 72d23805-a958-45da-9bea-adf7cc0f266a na tabela user

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/services/ad/adService.test.ts:38:21)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: da9ec481-ceca-48cd-9e40-a0dd92a34b5b na tabela advertiser

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/services/ad/adService.test.ts:43:21)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: 79bdb0bc-961b-402c-9c8e-df2434051844 na tabela product

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/services/ad/adService.test.ts:54:21)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: af6d6c70-5837-46eb-819c-1f8db18d2c90 na tabela ad

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/services/ad/adService.test.ts:63:21)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: d49a99c1-b644-445b-a53e-c58c016fdfba na tabela person

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/services/ad/adService.test.ts:28:21)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: 1f19b855-465f-4d0a-8b6c-c316cd4e10ab na tabela user

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/services/ad/adService.test.ts:38:21)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: 798cead6-bbc9-459a-b191-3739cdfd8aaf na tabela advertiser

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/services/ad/adService.test.ts:43:21)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: 79e1aa15-2002-4edf-9eb0-83121307c2a5 na tabela product

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/services/ad/adService.test.ts:54:21)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: eeda6446-595d-4d09-a8c8-c863d7f03df7 na tabela ad

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/services/ad/adService.test.ts:63:21)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: 96e9a27e-d21c-451c-8415-e1501add6f02 na tabela person

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/services/ad/adService.test.ts:28:21)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: 67d8f3ea-96d0-4f31-8a1e-a8d197edefc6 na tabela user

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/services/ad/adService.test.ts:38:21)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: f85875ef-ec22-41a4-ae6a-4ae2eca14290 na tabela advertiser

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/services/ad/adService.test.ts:43:21)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: 53596382-a505-49cb-a94f-cd270a15b68b na tabela product

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/services/ad/adService.test.ts:54:21)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: 69d26c7b-a3c8-4061-a1d2-f04a2272478e na tabela ad

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/services/ad/adService.test.ts:63:21)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: 55ac027d-e249-4fe9-8580-0cab7fce13f9 na tabela product

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/services/ad/adService.test.ts:163:23)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: 9ad883d6-6772-4dbc-b7a7-777ba3a2ff8d na tabela ad

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/services/ad/adService.test.ts:172:23)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: e00e443b-814f-4521-8bc2-f04dbe9aeb83 na tabela person

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/services/ad/adService.test.ts:28:21)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: d36535c7-591b-4c5c-8f47-cbb2f5ad673b na tabela user

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/services/ad/adService.test.ts:38:21)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: 8c2e1b2f-4f8d-44fe-9e2e-2ec415c1841c na tabela advertiser

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/services/ad/adService.test.ts:43:21)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: 9b6b6bb9-5d20-4193-9af9-728213e03324 na tabela product

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/services/ad/adService.test.ts:54:21)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: 011bb8ba-bc11-4412-af86-9693f1c43fdd na tabela ad

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/services/ad/adService.test.ts:63:21)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: 716e06a7-fe43-449c-9ae9-9a0b26c8c902 na tabela person

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/services/ad/adService.test.ts:28:21)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: 7aa73d92-420b-4489-863c-4b65429004f6 na tabela user

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/services/ad/adService.test.ts:38:21)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: 664f7f9f-2914-4abd-9dc1-2a8333932f6f na tabela advertiser

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/services/ad/adService.test.ts:43:21)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: 84ac5c05-27c3-47c3-ac5d-0bbc418739ee na tabela product

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/services/ad/adService.test.ts:54:21)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ef8082e6-4875-4326-98b7-777166de1784 na tabela ad

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/services/ad/adService.test.ts:63:21)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: 48110363-5fe4-49fa-8686-b81a1bdccb72 na tabela person

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/services/ad/adService.test.ts:28:21)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: 511dfbe5-e7f1-4701-ae28-afddc1531292 na tabela user

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/services/ad/adService.test.ts:38:21)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ced0dd92-d947-4341-87dd-f444d0f599dc na tabela advertiser

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/services/ad/adService.test.ts:43:21)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: 3032839b-b3cf-42e3-96e0-a8a8fdec8813 na tabela product

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/services/ad/adService.test.ts:54:21)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: 73e3f170-c4e0-4cf8-bf26-ae1a2289acef na tabela ad

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/services/ad/adService.test.ts:63:21)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: eb163e9f-26e1-467d-a536-7b491a9fddd5 na tabela person

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/services/ad/adService.test.ts:28:21)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: 71436ebc-e19c-49b9-ac70-bfd8dabe73fd na tabela user

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/services/ad/adService.test.ts:38:21)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: 85a7d5a9-7872-4857-864e-df095373ba3c na tabela advertiser

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/services/ad/adService.test.ts:43:21)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: b8cf3fdd-b11e-4644-8df0-35e089a6bcc0 na tabela product

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/services/ad/adService.test.ts:54:21)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: 40b00445-6459-4823-9ee9-ca15d71ceae2 na tabela ad

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/services/ad/adService.test.ts:63:21)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: 40b7e5fb-5fd3-4071-9d91-685e9b6a0c34 na tabela person

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/services/ad/adService.test.ts:28:21)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: 1be40b39-21dd-409f-95e8-0bdb4fcd951b na tabela user

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/services/ad/adService.test.ts:38:21)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: 842f3b01-0c54-4259-b080-32fae8ed6280 na tabela advertiser

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/services/ad/adService.test.ts:43:21)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: 4301ce35-1a67-4c60-bcdf-d835c84035e5 na tabela product

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/services/ad/adService.test.ts:54:21)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: bb0574e5-ec7f-4c1d-910e-f3449c5fc5df na tabela ad

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/services/ad/adService.test.ts:63:21)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: eb30d4db-33f5-42a5-ae92-49e2a9fead93 na tabela person

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/services/ad/adService.test.ts:28:21)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: 997c9938-88d0-4e8f-8ca0-8ea3fac8761c na tabela user

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/services/ad/adService.test.ts:38:21)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: fe6a9e62-7e72-4157-835f-67ee35ba1a00 na tabela advertiser

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/services/ad/adService.test.ts:43:21)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: b9a50fa8-18a6-49fb-8e2a-692323d6a843 na tabela product

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/services/ad/adService.test.ts:54:21)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: f52ccb79-6518-43fe-bcd4-b04a50c3c78f na tabela ad

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/services/ad/adService.test.ts:63:21)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: 537c0052-8feb-4c31-b5df-90106f6465ab na tabela person

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/services/ad/adService.test.ts:28:21)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: c76cf160-0ef0-40df-8272-ec172d14bc27 na tabela user

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/services/ad/adService.test.ts:38:21)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: b252ca02-24d2-4080-a709-c81a1bd043ac na tabela advertiser

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/services/ad/adService.test.ts:43:21)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: 47851d03-c0cb-48fd-8710-d2e12fd79627 na tabela product

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/services/ad/adService.test.ts:54:21)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: 6a4a2884-3ca2-49ee-8b5f-75bef092fdf2 na tabela ad

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/services/ad/adService.test.ts:63:21)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: 2ab42307-6257-491b-9a64-d106da1e79bf na tabela person

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/services/ad/adService.test.ts:28:21)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: 50af9cbd-926b-4802-9215-5edb069ac32d na tabela user

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/services/ad/adService.test.ts:38:21)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: 37258055-5bfe-4c73-9949-07f768249cdb na tabela advertiser

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/services/ad/adService.test.ts:43:21)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: f2ca74bb-c358-4f16-a0f4-edb23c5de8b1 na tabela product

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/services/ad/adService.test.ts:54:21)

    console.warn
      ‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: 11230a91-f5d3-40eb-b1b6-8d350eaed033 na tabela ad

      83 |     // Para outras tabelas, apenas rastrear IDs que s√£o de teste
      84 |     if (!isTestId(id)) {
    > 85 |       console.warn(`‚ö†Ô∏è  Tentativa de rastrear ID n√£o-test: ${id} na tabela ${table}`);
         |               ^
      86 |       return;
      87 |     }
      88 |     if (!this.ids.has(table)) {

      at TestDataTracker.add (src/utils/test-helpers.ts:85:15)
      at Object.<anonymous> (src/services/ad/adService.test.ts:63:21)

    console.log
      üßπ Limpando 0 IDs de teste...

      at safeTestCleanup (src/utils/test-helpers.ts:139:15)

    console.log
      ‚úÖ Limpeza de dados de teste conclu√≠da

      at safeTestCleanup (src/utils/test-helpers.ts:333:15)


Summary of all failing tests
FAIL src/services/user/__tests__/userService.test.ts
  ‚óè Test suite failed to run

    [96msrc/services/user/__tests__/userService.test.ts[0m:[93m47[0m:[93m7[0m - [91merror[0m[90m TS2353: [0mObject literal may only specify known properties, and 'displayName' does not exist in type 'SocialPlusUser'.

    [7m47[0m       displayName: 'Test User',
    [7m  [0m [91m      ~~~~~~~~~~~[0m
    [96msrc/services/user/__tests__/userService.test.ts[0m:[93m116[0m:[93m7[0m - [91merror[0m[90m TS2353: [0mObject literal may only specify known properties, and 'displayName' does not exist in type 'SocialPlusUser'.

    [7m116[0m       displayName: 'Test User',
    [7m   [0m [91m      ~~~~~~~~~~~[0m
    [96msrc/services/user/__tests__/userService.test.ts[0m:[93m194[0m:[93m7[0m - [91merror[0m[90m TS2353: [0mObject literal may only specify known properties, and 'displayName' does not exist in type 'SocialPlusUser'.

    [7m194[0m       displayName: 'Test User',
    [7m   [0m [91m      ~~~~~~~~~~~[0m
    [96msrc/services/user/__tests__/userService.test.ts[0m:[93m407[0m:[93m9[0m - [91merror[0m[90m TS2353: [0mObject literal may only specify known properties, and 'displayName' does not exist in type 'SocialPlusUser'.

    [7m407[0m         displayName: 'New User',
    [7m   [0m [91m        ~~~~~~~~~~~[0m
    [96msrc/services/user/__tests__/userService.test.ts[0m:[93m444[0m:[93m9[0m - [91merror[0m[90m TS2353: [0mObject literal may only specify known properties, and 'displayName' does not exist in type 'SocialPlusUser'.

    [7m444[0m         displayName: 'Retry User',
    [7m   [0m [91m        ~~~~~~~~~~~[0m
    [96msrc/services/user/__tests__/userService.test.ts[0m:[93m501[0m:[93m9[0m - [91merror[0m[90m TS2353: [0mObject literal may only specify known properties, and 'displayName' does not exist in type 'SocialPlusUser'.

    [7m501[0m         displayName: 'Jos√© Mar√≠a √ëo√±o',
    [7m   [0m [91m        ~~~~~~~~~~~[0m

FAIL src/middleware/__tests__/auth.test.ts
  ‚óè Authentication Middleware ‚Ä∫ authenticateToken ‚Ä∫ ÔøΩÔøΩ Edge Cases - Seguran√ßa ‚Ä∫ should handle database connection errors gracefully

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: 500
    Received: 401

    Number of calls: 1

      337 |         await authenticateToken(req as AuthenticatedRequest, res as Response, next);
      338 |
    > 339 |         expect(statusMock).toHaveBeenCalledWith(500);
          |                            ^
      340 |         expect(jsonMock).toHaveBeenCalledWith({
      341 |           success: false,
      342 |           message: 'Erro interno do servidor',

      at Object.<anonymous> (src/middleware/__tests__/auth.test.ts:339:28)

FAIL src/controllers/order/orderController.integration.test.ts
  ‚óè Test suite failed to run

    [96msrc/controllers/order/orderController.integration.test.ts[0m:[93m5[0m:[93m77[0m - [91merror[0m[90m TS2307: [0mCannot find module '@/tests/fixtures/testFixtures' or its corresponding type declarations.

    [7m5[0m import { createValidProduct, createValidCardData, createValidAddress } from '@/tests/fixtures/testFixtures';
    [7m [0m [91m                                                                            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m

FAIL src/utils/__tests__/auth0.test.ts
  ‚óè Test suite failed to run

    [96msrc/utils/__tests__/auth0.test.ts[0m:[93m207[0m:[93m10[0m - [91merror[0m[90m TS2352: [0mConversion of type 'typeof JwksRsa' to type 'Mock<any, any, any>' may be a mistake because neither type sufficiently overlaps with the other. If this was intentional, convert the expression to 'unknown' first.
      Type 'typeof JwksRsa' is missing the following properties from type 'Mock<any, any, any>': getMockName, mock, mockClear, mockReset, and 13 more.

    [7m207[0m         (jwksClient as jest.Mock).mockReturnValue(mockClient);
    [7m   [0m [91m         ~~~~~~~~~~~~~~~~~~~~~~~[0m
    [96msrc/utils/__tests__/auth0.test.ts[0m:[93m287[0m:[93m10[0m - [91merror[0m[90m TS2352: [0mConversion of type 'typeof JwksRsa' to type 'Mock<any, any, any>' may be a mistake because neither type sufficiently overlaps with the other. If this was intentional, convert the expression to 'unknown' first.
      Type 'typeof JwksRsa' is missing the following properties from type 'Mock<any, any, any>': getMockName, mock, mockClear, mockReset, and 13 more.

    [7m287[0m         (jwksClient as jest.Mock).mockReturnValue(mockClient);
    [7m   [0m [91m         ~~~~~~~~~~~~~~~~~~~~~~~[0m
    [96msrc/utils/__tests__/auth0.test.ts[0m:[93m293[0m:[93m44[0m - [91merror[0m[90m TS7006: [0mParameter 'err' implicitly has an 'any' type.

    [7m293[0m               getKey({} as jwt.JwtHeader, (err, key) => {
    [7m   [0m [91m                                           ~~~[0m
    [96msrc/utils/__tests__/auth0.test.ts[0m:[93m293[0m:[93m49[0m - [91merror[0m[90m TS7006: [0mParameter 'key' implicitly has an 'any' type.

    [7m293[0m               getKey({} as jwt.JwtHeader, (err, key) => {
    [7m   [0m [91m                                                ~~~[0m
    [96msrc/utils/__tests__/auth0.test.ts[0m:[93m311[0m:[93m10[0m - [91merror[0m[90m TS2352: [0mConversion of type 'typeof JwksRsa' to type 'Mock<any, any, any>' may be a mistake because neither type sufficiently overlaps with the other. If this was intentional, convert the expression to 'unknown' first.
      Type 'typeof JwksRsa' is missing the following properties from type 'Mock<any, any, any>': getMockName, mock, mockClear, mockReset, and 13 more.

    [7m311[0m         (jwksClient as jest.Mock).mockReturnValue(mockClient);
    [7m   [0m [91m         ~~~~~~~~~~~~~~~~~~~~~~~[0m
    [96msrc/utils/__tests__/auth0.test.ts[0m:[93m332[0m:[93m10[0m - [91merror[0m[90m TS2352: [0mConversion of type 'typeof JwksRsa' to type 'Mock<any, any, any>' may be a mistake because neither type sufficiently overlaps with the other. If this was intentional, convert the expression to 'unknown' first.
      Type 'typeof JwksRsa' is missing the following properties from type 'Mock<any, any, any>': getMockName, mock, mockClear, mockReset, and 13 more.

    [7m332[0m         (jwksClient as jest.Mock).mockReturnValue(mockClient);
    [7m   [0m [91m         ~~~~~~~~~~~~~~~~~~~~~~~[0m

FAIL src/services/order/__tests__/orderService.create.test.ts
  ‚óè Test suite failed to run

    [96msrc/services/order/__tests__/orderService.create.test.ts[0m:[93m4[0m:[93m77[0m - [91merror[0m[90m TS2307: [0mCannot find module '@/tests/fixtures/testFixtures' or its corresponding type declarations.

    [7m4[0m import { createValidProduct, createValidCardData, createValidAddress } from '@/tests/fixtures/testFixtures';
    [7m [0m [91m                                                                            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m

FAIL src/services/order/__tests__/orderService.payment.test.ts
  ‚óè Test suite failed to run

    [96msrc/services/order/__tests__/orderService.payment.test.ts[0m:[93m4[0m:[93m77[0m - [91merror[0m[90m TS2307: [0mCannot find module '@/tests/fixtures/testFixtures' or its corresponding type declarations.

    [7m4[0m import { createValidProduct, createValidCardData, createValidAddress } from '@/tests/fixtures/testFixtures';
    [7m [0m [91m                                                                            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m

FAIL src/services/order/__tests__/orderService.validation.test.ts
  ‚óè Test suite failed to run

    [96msrc/services/order/__tests__/orderService.validation.test.ts[0m:[93m4[0m:[93m36[0m - [91merror[0m[90m TS2307: [0mCannot find module '@/tests/fixtures/testFixtures' or its corresponding type declarations.

    [7m4[0m import { createValidProduct } from '@/tests/fixtures/testFixtures';
    [7m [0m [91m                                   ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m

FAIL src/services/order/__tests__/orderService.crud.test.ts
  ‚óè Test suite failed to run

    [96msrc/services/order/__tests__/orderService.crud.test.ts[0m:[93m4[0m:[93m36[0m - [91merror[0m[90m TS2307: [0mCannot find module '@/tests/fixtures/testFixtures' or its corresponding type declarations.

    [7m4[0m import { createValidProduct } from '@/tests/fixtures/testFixtures';
    [7m [0m [91m                                   ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
    [96msrc/services/order/__tests__/orderService.crud.test.ts[0m:[93m104[0m:[93m41[0m - [91merror[0m[90m TS2554: [0mExpected 3-4 arguments, but got 1.

    [7m104[0m       const orders = await orderService.findAll(testUser.id);
    [7m   [0m [91m                                        ~~~~~~~[0m

      [96msrc/services/order/orderService.ts[0m:[93m473[0m:[93m5[0m
        [7m473[0m     limit: number,
        [7m   [0m [96m    ~~~~~~~~~~~~~[0m
        An argument for 'limit' was not provided.
    [96msrc/services/order/__tests__/orderService.crud.test.ts[0m:[93m105[0m:[93m21[0m - [91merror[0m[90m TS2339: [0mProperty 'length' does not exist on type '{ orders: { id: string; createdAt: Date; updatedAt: Date; deletedAt: Date | null; userId: string; status: string; total: Decimal; subtotal: Decimal; shippingCost: Decimal; ... 7 more ...; trackingNumber: string | null; }[]; total: number; }'.

    [7m105[0m       expect(orders.length).toBeGreaterThan(0);
    [7m   [0m [91m                    ~~~~~~[0m
    [96msrc/services/order/__tests__/orderService.crud.test.ts[0m:[93m106[0m:[93m14[0m - [91merror[0m[90m TS7053: [0mElement implicitly has an 'any' type because expression of type '0' can't be used to index type '{ orders: { id: string; createdAt: Date; updatedAt: Date; deletedAt: Date | null; userId: string; status: string; total: Decimal; subtotal: Decimal; shippingCost: Decimal; ... 7 more ...; trackingNumber: string | null; }[]; total: number; }'.
      Property '0' does not exist on type '{ orders: { id: string; createdAt: Date; updatedAt: Date; deletedAt: Date | null; userId: string; status: string; total: Decimal; subtotal: Decimal; shippingCost: Decimal; ... 7 more ...; trackingNumber: string | null; }[]; total: number; }'.

    [7m106[0m       expect(orders[0].userId).toBe(testUser.id);
    [7m   [0m [91m             ~~~~~~~~~[0m
    [96msrc/services/order/__tests__/orderService.crud.test.ts[0m:[93m110[0m:[93m41[0m - [91merror[0m[90m TS2554: [0mExpected 3-4 arguments, but got 2.

    [7m110[0m       const orders = await orderService.findAll(testUser.id, 'pending');
    [7m   [0m [91m                                        ~~~~~~~[0m

      [96msrc/services/order/orderService.ts[0m:[93m474[0m:[93m5[0m
        [7m474[0m     filters: OrderQueryFilters,
        [7m   [0m [96m    ~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
        An argument for 'filters' was not provided.
    [96msrc/services/order/__tests__/orderService.crud.test.ts[0m:[93m111[0m:[93m21[0m - [91merror[0m[90m TS2339: [0mProperty 'length' does not exist on type '{ orders: { id: string; createdAt: Date; updatedAt: Date; deletedAt: Date | null; userId: string; status: string; total: Decimal; subtotal: Decimal; shippingCost: Decimal; ... 7 more ...; trackingNumber: string | null; }[]; total: number; }'.

    [7m111[0m       expect(orders.length).toBeGreaterThan(0);
    [7m   [0m [91m                    ~~~~~~[0m
    [96msrc/services/order/__tests__/orderService.crud.test.ts[0m:[93m112[0m:[93m14[0m - [91merror[0m[90m TS2339: [0mProperty 'forEach' does not exist on type '{ orders: { id: string; createdAt: Date; updatedAt: Date; deletedAt: Date | null; userId: string; status: string; total: Decimal; subtotal: Decimal; shippingCost: Decimal; ... 7 more ...; trackingNumber: string | null; }[]; total: number; }'.

    [7m112[0m       orders.forEach(order => expect(order.status).toBe('pending'));
    [7m   [0m [91m             ~~~~~~~[0m
    [96msrc/services/order/__tests__/orderService.crud.test.ts[0m:[93m112[0m:[93m22[0m - [91merror[0m[90m TS7006: [0mParameter 'order' implicitly has an 'any' type.

    [7m112[0m       orders.forEach(order => expect(order.status).toBe('pending'));
    [7m   [0m [91m                     ~~~~~[0m
    [96msrc/services/order/__tests__/orderService.crud.test.ts[0m:[93m118[0m:[93m76[0m - [91merror[0m[90m TS2345: [0mArgument of type '{ status: string; }' is not assignable to parameter of type 'string'.

    [7m118[0m       const updated = await orderService.update(testOrder.id, testUser.id, {
    [7m   [0m [91m                                                                           ~[0m
    [7m119[0m         status: 'completed',
    [7m   [0m [91m~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
    [7m120[0m       });
    [7m   [0m [91m~~~~~~~[0m
    [96msrc/services/order/__tests__/orderService.crud.test.ts[0m:[93m126[0m:[93m61[0m - [91merror[0m[90m TS2345: [0mArgument of type '{ status: string; }' is not assignable to parameter of type 'string'.

    [7m126[0m         orderService.update('non-existent-id', testUser.id, { status: 'completed' })
    [7m   [0m [91m                                                            ~~~~~~~~~~~~~~~~~~~~~~~[0m

FAIL src/utils/__tests__/auth.test.ts
  ‚óè Auth Utils ‚Ä∫ generateToken ‚Ä∫ should generate different tokens for same user at different times

    expect(received).not.toBe(expected) // Object.is equality

    Expected: not "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOiJ1c2VyLXNhbWUiLCJpYXQiOjE3Njg1MDQyNzksImV4cCI6MTc2ODUwNzg3OX0.HTzrfONfbjC2ObafcbO_pilvQNiaf4uFYQyY8R0VVyc"

      59 |
      60 |       // Tokens devem ser diferentes porque iat (issued at) √© diferente
    > 61 |       expect(token1).not.toBe(token2);
         |                          ^
      62 |     });
      63 |
      64 |     it('should create token that can be decoded', () => {

      at Object.<anonymous> (src/utils/__tests__/auth.test.ts:61:26)

FAIL src/services/product/productService.test.ts
  ‚óè Test suite failed to run

    [96msrc/services/product/productService.test.ts[0m:[93m5[0m:[93m59[0m - [91merror[0m[90m TS2307: [0mCannot find module '@/tests/fixtures/testFixtures' or its corresponding type declarations.

    [7m5[0m import { createValidProduct, createExternalProduct } from '@/tests/fixtures/testFixtures';
    [7m [0m [91m                                                          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m

FAIL src/controllers/payment/paymentController.integration.test.ts (92.707 s)
  ‚óè Payment Endpoints ‚Ä∫ POST /api/payment/process ‚Ä∫ should process payment successfully

    expect(received).toBe(expected) // Object.is equality

    Expected: 200
    Received: 400

      151 |         .set('Authorization', `Bearer ${authToken}`);
      152 |
    > 153 |       expect(response.status).toBe(200);
          |                               ^
      154 |       expect(response.body.success).toBe(true);
      155 |       expect(response.body.data.order).toBeDefined();
      156 |       expect(response.body.data.transaction).toBeDefined();

      at Object.<anonymous> (src/controllers/payment/paymentController.integration.test.ts:153:31)

  ‚óè Payment Endpoints ‚Ä∫ POST /api/payment/process ‚Ä∫ should handle Pagarme transaction error

    expect(received).toBe(expected) // Object.is equality

    Expected: "failed"
    Received: "pending"

      317 |         where: { id: testOrder.id },
      318 |       });
    > 319 |       expect(updatedOrder?.paymentStatus).toBe('failed');
          |                                           ^
      320 |     });
      321 |
      322 |     it('should validate required fields', async () => {

      at Object.<anonymous> (src/controllers/payment/paymentController.integration.test.ts:319:43)

  ‚óè Payment Endpoints ‚Ä∫ CPF handling ‚Ä∫ should use CPF from cardData when provided

    expect(received).toBe(expected) // Object.is equality

    Expected: 200
    Received: 400

      585 |         });
      586 |
    > 587 |       expect(response.status).toBe(200);
          |                               ^
      588 |       expect(createCreditCardTransaction).toHaveBeenCalled();
      589 |       const callArgs = createCreditCardTransaction.mock.calls[0][0];
      590 |       expect(callArgs.customer.documents).toBeDefined();

      at Object.<anonymous> (src/controllers/payment/paymentController.integration.test.ts:587:31)

  ‚óè Payment Endpoints ‚Ä∫ CPF handling ‚Ä∫ should fallback to nationalRegistration when CPF not in cardData

    expect(received).toBe(expected) // Object.is equality

    Expected: 200
    Received: 400

      667 |         });
      668 |
    > 669 |       expect(response.status).toBe(200);
          |                               ^
      670 |       expect(createCreditCardTransaction).toHaveBeenCalled();
      671 |       const callArgs = createCreditCardTransaction.mock.calls[0][0];
      672 |       expect(callArgs.customer.documents).toBeDefined();

      at Object.<anonymous> (src/controllers/payment/paymentController.integration.test.ts:669:31)

  ‚óè Payment Endpoints ‚Ä∫ CPF handling ‚Ä∫ should return error when CPF is not available in nationalRegistration or cardData

    expect(received).toContain(expected) // indexOf

    Expected substring: "CPF do cliente √© obrigat√≥rio"
    Received string:    "User email not found"

      744 |       expect(response.status).toBe(400);
      745 |       expect(response.body.success).toBe(false);
    > 746 |       expect(response.body.message).toContain('CPF do cliente √© obrigat√≥rio');
          |                                     ^
      747 |     });
      748 |   });
      749 | });

      at Object.<anonymous> (src/controllers/payment/paymentController.integration.test.ts:746:37)


Test Suites: 11 failed, 18 passed, 29 total
Tests:       7 failed, 267 passed, 274 total
Snapshots:   0 total
Time:        179.915 s
Ran all test suites.
